{
    "generated_code": [
        "import pandas as pd\nimport numpy as np\nimport ast\nfrom datetime import datetime\n\n# (Release Year)\n# Usefulness: The release year of a movie can significantly influence its box office revenue due to changing market conditions, inflation, and audience preferences over time.\n# Input samples: 'release_date': ['10/15/99', '4/20/17', '2/5/15']\ndf['release_date'] = pd.to_datetime(df['release_date'], format='%m/%d/%y')\ndf['release_year'] = df['release_date'].dt.year\n\n# (Release Month)\n# Usefulness: The release month can be a strong indicator of revenue, as certain months (e.g., summer, holiday seasons) are known for higher movie attendance.\ndf['release_month'] = df['release_date'].dt.month\n\n# (Release Day)\n# Usefulness: The specific day of release might capture patterns, such as movies released on Fridays often having higher opening weekends.\ndf['release_day'] = df['release_date'].dt.day\n\n# (Release Day of Week)\n# Usefulness: The day of the week a movie is released can impact its initial box office performance, with weekend releases typically performing better.\ndf['release_dayofweek'] = df['release_date'].dt.dayofweek\n\n# (Release Day of Year)\n# Usefulness: The day of the year can capture seasonal trends beyond just the month.\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\n\n# (Elapsed time since release)\ndf['days_since_release'] = (datetime.now() - df['release_date']).dt.days\n\n# (Number of Cast Members)\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if pd.notna(x) else 0)\n\n# (Number of Crew Members)\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if pd.notna(x) else 0)\n\n# (Has Tagline)\ndf['has_tagline'] = df['tagline'].notna().astype(int)\n\n# (Length of Tagline in Words)\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\n\n# (Has Overview)\ndf['has_overview'] = df['overview'].notna().astype(int)\n\n# (Length of Overview in Words)\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\n\n# Helper function to extract specific crew members\ndef get_crew_member(crew_list_str, job_title):\n    if pd.isna(crew_list_str):\n        return np.nan\n    try:\n        crew_list = ast.literal_eval(crew_list_str)\n        for member in crew_list:\n            if member.get('job') == job_title:\n                return member.get('name')\n        return np.nan\n    except:\n        return np.nan\n\n# (Director)\ndf['director'] = df['crew'].apply(lambda x: get_crew_member(x, 'Director'))\n\n# (Screenplay Writer)\ndf['screenplay_writer'] = df['crew'].apply(lambda x: get_crew_member(x, 'Screenplay'))\n\n# (Director of Photography)\ndf['director_of_photography'] = df['crew'].apply(lambda x: get_crew_member(x, 'Director of Photography'))\n\n# (Original Music Composer)\ndf['original_music_composer'] = df['crew'].apply(lambda x: get_crew_member(x, 'Original Music Composer'))\n\n# (Art Director)\ndf['art_director'] = df['crew'].apply(lambda x: get_crew_member(x, 'Art Direction'))\n\n# Helper functions for lists\ndef safe_len_eval(x):\n    if pd.isna(x):\n        return 0\n    try:\n        return len(ast.literal_eval(x))\n    except (ValueError, SyntaxError):\n        return 0\n\ndef get_first_item_name(x):\n    if pd.isna(x):\n        return np.nan\n    try:\n        items = ast.literal_eval(x)\n        if items:\n            return items[0].get('name')\n        return np.nan\n    except (ValueError, SyntaxError):\n        return np.nan\n\n# (Has Collection)\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if pd.notna(x) and x != '[]' else 0)\n\n# (Collection Name)\ndf['collection_name'] = df['belongs_to_collection'].apply(get_first_item_name)\n\n# (Number of Genres)\ndf['num_genres'] = df['genres'].apply(safe_len_eval)\n\n# (Main Genre)\ndf['main_genre'] = df['genres'].apply(get_first_item_name)\n\n# (Number of Production Companies)\ndf['num_production_companies'] = df['production_companies'].apply(safe_len_eval)\n\n# (Main Production Company)\ndf['main_production_company'] = df['production_companies'].apply(get_first_item_name)\n\n# (Number of Production Countries)\ndf['num_production_countries'] = df['production_countries'].apply(safe_len_eval)\n\n# (Main Production Country)\ndf['main_production_country'] = df['production_countries'].apply(get_first_item_name)\n\n# (Number of Spoken Languages)\ndf['num_spoken_languages'] = df['spoken_languages'].apply(safe_len_eval)\n\n# (Main Spoken Language)\ndf['main_spoken_language'] = df['spoken_languages'].apply(get_first_item_name)\n\n# (Has Homepage)\ndf['has_homepage'] = df['homepage'].notna().astype(int)\n\n# (Has Poster)\ndf['has_poster'] = df['poster_path'].notna().astype(int)\n\n# (Is Released)\ndf['is_released'] = (df['status'] == 'Released').astype(int)\n\n# (Number of Keywords)\ndf['num_keywords'] = df['Keywords'].apply(safe_len_eval)\n\n# (Main Keyword)\ndf['main_keyword'] = df['Keywords'].apply(get_first_item_name)\n\n# (Is Original Language English)\ndf['is_english_original_language'] = (df['original_language'] == 'en').astype(int)\n\n# (Budget per Runtime)\ndf['budget_per_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\n\n# (Popularity per Runtime)\ndf['popularity_per_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\n\ndef get_unique_cast_genders(cast_list_str):\n    if pd.isna(cast_list_str):\n        return 0\n    try:\n        cast_list = ast.literal_eval(cast_list_str)\n        genders = {member.get('gender') for member in cast_list if member.get('gender') is not None}\n        return len(genders)\n    except (ValueError, SyntaxError):\n        return 0\ndf['num_unique_cast_genders'] = df['cast'].apply(get_unique_cast_genders)\n\ndef get_unique_crew_departments(crew_list_str):\n    if pd.isna(crew_list_str):\n        return 0\n    try:\n        crew_list = ast.literal_eval(crew_list_str)\n        departments = {member.get('department') for member in crew_list if member.get('department') is not None}\n        return len(departments)\n    except (ValueError, SyntaxError):\n        return 0\ndf['num_unique_crew_departments'] = df['crew'].apply(get_unique_crew_departments)\n\n# (Has Budget)\ndf['has_budget'] = (df['budget'] > 0).astype(int)\n\n# (Has Runtime)\ndf['has_runtime'] = (df['runtime'] > 0).astype(int)\n\n# (Has Popularity)\ndf['has_popularity'] = (df['popularity'] > 0).astype(int)"
      ]
}
