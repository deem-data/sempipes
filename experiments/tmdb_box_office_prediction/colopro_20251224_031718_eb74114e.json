"{\"sempipes_config\": {\"llm_for_code_generation\": {\"name\": \"gemini/gemini-2.5-flash\", \"parameters\": {\"temperature\": 2.0}}, \"llm_for_batch_processing\": {\"name\": \"ollama/gpt-oss:120b\", \"parameters\": {\"api_base\": \"http://localhost:11434\", \"temperature\": 0.0}}, \"batch_size_for_batch_processing\": 20}, \"optimizer_args\": {\"operator_name\": \"additional_movie_features\", \"num_trials\": 24, \"scoring\": \"neg_root_mean_squared_error\", \"cv\": \"10\", \"num_hpo_iterations_per_trial\": 10}, \"outcomes\": [{\"search_node\": {\"trial\": 0, \"parent_trial\": null, \"memory\": [], \"predefined_state\": {\"generated_code\": []}, \"parent_score\": null, \"inspirations\": []}, \"state\": {\"generated_code\": []}, \"score\": -2.19964814861273, \"memory_update\": \"\"}, {\"search_node\": {\"trial\": 1, \"parent_trial\": 0, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}], \"predefined_state\": null, \"parent_score\": -2.19964814861273, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\"]}, \"score\": -2.194834450371649, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\"}, {\"search_node\": {\"trial\": 2, \"parent_trial\": 1, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}], \"predefined_state\": null, \"parent_score\": -2.194834450371649, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Helper function for safe JSON parsing - redefined for robustness across blocks)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 0 else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: title_length - Length of the movie title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: original_title_length - Length of the original movie title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: is_title_same_as_original - Binary indicator if title and original title are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_same_as_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: log_budget - Log transformation of budget (add 1 to handle zero budgets))\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = df['budget'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: log_popularity - Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['log_popularity'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: log_runtime - Log transformation of runtime (add 1 to handle zero runtimes))\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime (add 1 to runtime to avoid division by zero))\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / (row['runtime'] + 1) if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_budget_ratio - Ratio of popularity to budget (add 1 to budget to avoid division by zero))\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\ndf['popularity_budget_ratio'] = df.apply(lambda row: row['popularity'] / (row['budget'] + 1), axis=1)\\n\\n# (Feature: international_co_production - Binary indicator for movies with more than one production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['international_co_production'] = df['parsed_production_countries'].apply(lambda x: 1 if len(x) > 1 else 0)\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_languages_cat - Categorical representation of num_spoken_languages, binned)\\n# Input samples: 'num_spoken_languages': [1, 1, 1] (Assuming num_spoken_languages created in prior block)\\ndf['num_spoken_languages_cat'] = df['num_spoken_languages'].apply(lambda x: '0' if x == 0 else ('1' if x == 1 else '2+'))\\n\\n# (Feature: month_release_is_q4 - Binary indicator for Q4 release (Oct, Nov, Dec))\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_release_is_q4'] = df['release_month'].apply(lambda x: 1 if x in [10, 11, 12] else 0)\\n\\n# (Feature: original_language_is_en - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_is_en'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: year_since_release - Number of years since release, assuming a reference year e.g. 2020 to capture age effect)\\n# (Adjust the reference year as appropriate if later data is available, for Kaggle typical choice is contest end year or common release year.)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\nREF_YEAR = 2020 # A reasonable reference year post latest movie release in dataset.\\ndf['year_since_release'] = REF_YEAR - df['release_year']\\n\\n# (Feature: homepage_length - Length of the homepage URL)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_length'] = df['homepage'].apply(lambda x: len(str(x)) if isinstance(x, str) else 0)\"]}, \"score\": -2.2217392239110048, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Helper function for safe JSON parsing - redefined for robustness across blocks)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 0 else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: title_length - Length of the movie title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: original_title_length - Length of the original movie title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: is_title_same_as_original - Binary indicator if title and original title are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_same_as_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: log_budget - Log transformation of budget (add 1 to handle zero budgets))\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = df['budget'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: log_popularity - Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['log_popularity'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: log_runtime - Log transformation of runtime (add 1 to handle zero runtimes))\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime (add 1 to runtime to avoid division by zero))\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / (row['runtime'] + 1) if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_budget_ratio - Ratio of popularity to budget (add 1 to budget to avoid division by zero))\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\ndf['popularity_budget_ratio'] = df.apply(lambda row: row['popularity'] / (row['budget'] + 1), axis=1)\\n\\n# (Feature: international_co_production - Binary indicator for movies with more than one production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['international_co_production'] = df['parsed_production_countries'].apply(lambda x: 1 if len(x) > 1 else 0)\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_languages_cat - Categorical representation of num_spoken_languages, binned)\\n# Input samples: 'num_spoken_languages': [1, 1, 1] (Assuming num_spoken_languages created in prior block)\\ndf['num_spoken_languages_cat'] = df['num_spoken_languages'].apply(lambda x: '0' if x == 0 else ('1' if x == 1 else '2+'))\\n\\n# (Feature: month_release_is_q4 - Binary indicator for Q4 release (Oct, Nov, Dec))\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_release_is_q4'] = df['release_month'].apply(lambda x: 1 if x in [10, 11, 12] else 0)\\n\\n# (Feature: original_language_is_en - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_is_en'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: year_since_release - Number of years since release, assuming a reference year e.g. 2020 to capture age effect)\\n# (Adjust the reference year as appropriate if later data is available, for Kaggle typical choice is contest end year or common release year.)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\nREF_YEAR = 2020 # A reasonable reference year post latest movie release in dataset.\\ndf['year_since_release'] = REF_YEAR - df['release_year']\\n\\n# (Feature: homepage_length - Length of the homepage URL)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_length'] = df['homepage'].apply(lambda x: len(str(x)) if isinstance(x, str) else 0)\"}, {\"search_node\": {\"trial\": 3, \"parent_trial\": 0, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}], \"predefined_state\": null, \"parent_score\": -2.19964814861273, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import pandas as pd\\nimport numpy as np\\nimport ast\\n\\n# Helper function to safely parse JSON strings and handle potential issues\\ndef safe_json_parse(text):\\n    if pd.isna(text):\\n        return np.nan\\n    # Ensure text is a string before attempting literal_eval\\n    if not isinstance(text, str):\\n        # If it's not a string and not NaN, attempt to convert to string if it looks like a JSON string.\\n        # Otherwise, treat as invalid. This step aims to catch more malformed inputs.\\n        try:\\n            temp_text = str(text)\\n            if not (temp_text.startswith('[') and temp_text.endswith(']')): # Only try to eval if it looks like a list\\n                 return np.nan\\n            text = temp_text\\n        except:\\n            return np.nan # Unable to convert to string or does not look like JSON\\n    try:\\n        obj = ast.literal_eval(text)\\n        # If it's an empty list after parsing, treat it as NaN for consistency\\n        if isinstance(obj, list) and len(obj) == 0:\\n            return np.nan\\n        return obj\\n    except (ValueError, SyntaxError, TypeError): # Catch various parsing errors\\n        return np.nan\\n\\n# (has_collection: Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_json_parse)\\n# Extract collection name, defaulting to 'no_collection' if parsing failed or it's NaN\\ndf['collection_name'] = df['parsed_collection'].apply(\\n    lambda x: x[0]['name'] if x is not np.nan and isinstance(x, list) and len(x) > 0 and 'name' in x[0] else 'no_collection'\\n)\\ndf['has_collection'] = (df['collection_name'] != 'no_collection').astype(int)\\n\\n# (num_genres: Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_json_parse)\\ndf['num_genres'] = df['parsed_genres'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (genre_Drama: Binary indicator for 'Drama' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Drama'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Drama' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Comedy: Binary indicator for 'Comedy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Comedy' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Thriller: Binary indicator for 'Thriller' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Thriller' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Action: Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Action'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Action' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Adventure: Binary indicator for 'Adventure' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Adventure' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_production_companies: Number of production companies involved)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", nan]\\ndf['parsed_prod_companies'] = df['production_companies'].apply(safe_json_parse)\\ndf['num_production_companies'] = df['parsed_prod_companies'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (prod_company_US: Binary indicator for \\\"United States of America\\\" as production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", nan]\\ndf['parsed_prod_countries'] = df['production_countries'].apply(safe_json_parse)\\ndf['prod_country_US'] = df['parsed_prod_countries'].apply(lambda x: 1 if x is not np.nan and any(d.get('iso_3166_1') == 'US' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_production_countries: Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", nan]\\ndf['num_production_countries'] = df['parsed_prod_countries'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (num_spoken_languages: Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", nan]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_json_parse)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (english_spoken: Binary indicator if English is one of the spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", nan]\\ndf['english_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if x is not np.nan and any(d.get('iso_639_1') == 'en' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_keywords: Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}]\\\", nan]\\ndf['parsed_keywords'] = df['Keywords'].apply(safe_json_parse)\\ndf['num_keywords'] = df['parsed_keywords'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (num_cast: Total number of cast members)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', ...}]', '[]', nan]\\ndf['parsed_cast'] = df['cast'].apply(safe_json_parse)\\ndf['num_cast'] = df['parsed_cast'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (male_lead_actor: Binary indicator if the lead actor (order=0) is male (gender=2))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['male_lead_actor'] = df['parsed_cast'].apply(lambda x: 1 if x is not np.nan and any(d.get('order') == 0 and d.get('gender') == 2 for d in x if isinstance(d, dict)) else 0)\\n\\n# (female_lead_actor: Binary indicator if the lead actor (order=0) is female (gender=1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 1, \\\\'character\\\\': \\\\'Julia Banks\\\\', \\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]']\\ndf['female_lead_actor'] = df['parsed_cast'].apply(lambda x: 1 if x is not np.nan and any(d.get('order') == 0 and d.get('gender') == 1 for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_crew: Total number of crew members)\\n# Input samples: 'crew': ['[{\\\\'credit_id\\\\': \\\\'55731b8192514111610027d7\\\\', \\\\'department\\\\': \\\\'Production\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 376, \\\\'job\\\\': \\\\'Executive Producer\\\\', \\\\'name\\\\': \\\\'Arnon Milchan\\\\'}]']\\ndf['parsed_crew'] = df['crew'].apply(safe_json_parse)\\ndf['num_crew'] = df['parsed_crew'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (director_gender: Gender of the director (1=female, 2=male, 0=unknown or not found))\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Director\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'David Fincher\\\\'}]']\\ndf['director_gender'] = df['parsed_crew'].apply(lambda x: next((d['gender'] for d in x if isinstance(d, dict) and d.get('job') == 'Director' and 'gender' in d), 0) if x is not np.nan else 0)\\n\\n# (num_producers: Number of producers in the crew)\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Producer\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'Art Linson\\\\'}]']\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: sum(1 for d in x if isinstance(d, dict) and d.get('job') == 'Producer') if x is not np.nan else 0)\\n\\n# (num_executive_producers: Number of executive producers in the crew)\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Executive Producer\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'Arnon Milchan\\\\'}]']\\ndf['num_executive_producers'] = df['parsed_crew'].apply(lambda x: sum(1 for d in x if isinstance(d, dict) and d.get('job') == 'Executive Producer') if x is not np.nan else 0)\\n\\n# (has_homepage: Binary indicator if a homepage exists)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan]\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (is_budget_0: Binary indicator if budget is 0)\\n# Input samples: 'budget': [63000000, 12000000, 0, 6500000]\\ndf['is_budget_0'] = (df['budget'] == 0).astype(int)\\n\\n# (has_tagline: Binary indicator if a tagline exists)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (original_title_word_count: Number of words in original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if x is not np.nan else 0)\\n\\n# (overview_word_count: Number of words in overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac...', 'Julia moves in with her fianc\\u00a9, David...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if x is not np.nan else 0)\\n\\n# (is_original_language_en: Binary indicator if original_language is 'en')\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (budget_per_runtime: Ratio of budget to runtime, with smoothing for zero runtime)\\n# Input samples: 'budget': [63000000, 12000000], 'runtime': [139, 100]\\n# Add a small epsilon to runtime to avoid division by zero. Use fillna(0) for runtime values (no NaNs as per description)\\ndf['budget_per_runtime'] = df.apply(lambda row: row['budget'] / (row['runtime'] + 1e-6) if row['runtime'] > 0 else 0, axis=1)\\n\\n# Clean up temporary parsed columns\\ndf = df.drop(columns=['parsed_collection', 'collection_name', 'parsed_genres', 'parsed_prod_companies', 'parsed_prod_countries', \\n                      'parsed_spoken_languages', 'parsed_keywords', 'parsed_cast', 'parsed_crew'])\"]}, \"score\": -2.2306143591961503, \"memory_update\": \"import pandas as pd\\nimport numpy as np\\nimport ast\\n\\n# Helper function to safely parse JSON strings and handle potential issues\\ndef safe_json_parse(text):\\n    if pd.isna(text):\\n        return np.nan\\n    # Ensure text is a string before attempting literal_eval\\n    if not isinstance(text, str):\\n        # If it's not a string and not NaN, attempt to convert to string if it looks like a JSON string.\\n        # Otherwise, treat as invalid. This step aims to catch more malformed inputs.\\n        try:\\n            temp_text = str(text)\\n            if not (temp_text.startswith('[') and temp_text.endswith(']')): # Only try to eval if it looks like a list\\n                 return np.nan\\n            text = temp_text\\n        except:\\n            return np.nan # Unable to convert to string or does not look like JSON\\n    try:\\n        obj = ast.literal_eval(text)\\n        # If it's an empty list after parsing, treat it as NaN for consistency\\n        if isinstance(obj, list) and len(obj) == 0:\\n            return np.nan\\n        return obj\\n    except (ValueError, SyntaxError, TypeError): # Catch various parsing errors\\n        return np.nan\\n\\n# (has_collection: Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_json_parse)\\n# Extract collection name, defaulting to 'no_collection' if parsing failed or it's NaN\\ndf['collection_name'] = df['parsed_collection'].apply(\\n    lambda x: x[0]['name'] if x is not np.nan and isinstance(x, list) and len(x) > 0 and 'name' in x[0] else 'no_collection'\\n)\\ndf['has_collection'] = (df['collection_name'] != 'no_collection').astype(int)\\n\\n# (num_genres: Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_json_parse)\\ndf['num_genres'] = df['parsed_genres'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (genre_Drama: Binary indicator for 'Drama' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Drama'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Drama' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Comedy: Binary indicator for 'Comedy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Comedy' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Thriller: Binary indicator for 'Thriller' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Thriller' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Action: Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Action'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Action' for d in x if isinstance(d, dict)) else 0)\\n\\n# (genre_Adventure: Binary indicator for 'Adventure' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if x is not np.nan and any(d.get('name') == 'Adventure' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_production_companies: Number of production companies involved)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", nan]\\ndf['parsed_prod_companies'] = df['production_companies'].apply(safe_json_parse)\\ndf['num_production_companies'] = df['parsed_prod_companies'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (prod_company_US: Binary indicator for \\\"United States of America\\\" as production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", nan]\\ndf['parsed_prod_countries'] = df['production_countries'].apply(safe_json_parse)\\ndf['prod_country_US'] = df['parsed_prod_countries'].apply(lambda x: 1 if x is not np.nan and any(d.get('iso_3166_1') == 'US' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_production_countries: Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", nan]\\ndf['num_production_countries'] = df['parsed_prod_countries'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (num_spoken_languages: Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", nan]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_json_parse)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (english_spoken: Binary indicator if English is one of the spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", nan]\\ndf['english_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if x is not np.nan and any(d.get('iso_639_1') == 'en' for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_keywords: Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}]\\\", nan]\\ndf['parsed_keywords'] = df['Keywords'].apply(safe_json_parse)\\ndf['num_keywords'] = df['parsed_keywords'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (num_cast: Total number of cast members)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', ...}]', '[]', nan]\\ndf['parsed_cast'] = df['cast'].apply(safe_json_parse)\\ndf['num_cast'] = df['parsed_cast'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (male_lead_actor: Binary indicator if the lead actor (order=0) is male (gender=2))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['male_lead_actor'] = df['parsed_cast'].apply(lambda x: 1 if x is not np.nan and any(d.get('order') == 0 and d.get('gender') == 2 for d in x if isinstance(d, dict)) else 0)\\n\\n# (female_lead_actor: Binary indicator if the lead actor (order=0) is female (gender=1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 1, \\\\'character\\\\': \\\\'Julia Banks\\\\', \\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]']\\ndf['female_lead_actor'] = df['parsed_cast'].apply(lambda x: 1 if x is not np.nan and any(d.get('order') == 0 and d.get('gender') == 1 for d in x if isinstance(d, dict)) else 0)\\n\\n# (num_crew: Total number of crew members)\\n# Input samples: 'crew': ['[{\\\\'credit_id\\\\': \\\\'55731b8192514111610027d7\\\\', \\\\'department\\\\': \\\\'Production\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 376, \\\\'job\\\\': \\\\'Executive Producer\\\\', \\\\'name\\\\': \\\\'Arnon Milchan\\\\'}]']\\ndf['parsed_crew'] = df['crew'].apply(safe_json_parse)\\ndf['num_crew'] = df['parsed_crew'].apply(lambda x: len(x) if x is not np.nan else 0)\\n\\n# (director_gender: Gender of the director (1=female, 2=male, 0=unknown or not found))\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Director\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'David Fincher\\\\'}]']\\ndf['director_gender'] = df['parsed_crew'].apply(lambda x: next((d['gender'] for d in x if isinstance(d, dict) and d.get('job') == 'Director' and 'gender' in d), 0) if x is not np.nan else 0)\\n\\n# (num_producers: Number of producers in the crew)\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Producer\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'Art Linson\\\\'}]']\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: sum(1 for d in x if isinstance(d, dict) and d.get('job') == 'Producer') if x is not np.nan else 0)\\n\\n# (num_executive_producers: Number of executive producers in the crew)\\n# Input samples: 'crew': ['[{\\\\'job\\\\': \\\\'Executive Producer\\\\', \\\\'gender\\\\': 2, \\\\'name\\\\': \\\\'Arnon Milchan\\\\'}]']\\ndf['num_executive_producers'] = df['parsed_crew'].apply(lambda x: sum(1 for d in x if isinstance(d, dict) and d.get('job') == 'Executive Producer') if x is not np.nan else 0)\\n\\n# (has_homepage: Binary indicator if a homepage exists)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan]\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (is_budget_0: Binary indicator if budget is 0)\\n# Input samples: 'budget': [63000000, 12000000, 0, 6500000]\\ndf['is_budget_0'] = (df['budget'] == 0).astype(int)\\n\\n# (has_tagline: Binary indicator if a tagline exists)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (original_title_word_count: Number of words in original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if x is not np.nan else 0)\\n\\n# (overview_word_count: Number of words in overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac...', 'Julia moves in with her fianc\\u00a9, David...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if x is not np.nan else 0)\\n\\n# (is_original_language_en: Binary indicator if original_language is 'en')\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (budget_per_runtime: Ratio of budget to runtime, with smoothing for zero runtime)\\n# Input samples: 'budget': [63000000, 12000000], 'runtime': [139, 100]\\n# Add a small epsilon to runtime to avoid division by zero. Use fillna(0) for runtime values (no NaNs as per description)\\ndf['budget_per_runtime'] = df.apply(lambda row: row['budget'] / (row['runtime'] + 1e-6) if row['runtime'] > 0 else 0, axis=1)\\n\\n# Clean up temporary parsed columns\\ndf = df.drop(columns=['parsed_collection', 'collection_name', 'parsed_genres', 'parsed_prod_companies', 'parsed_prod_countries', \\n                      'parsed_spoken_languages', 'parsed_keywords', 'parsed_cast', 'parsed_crew'])\"}, {\"search_node\": {\"trial\": 4, \"parent_trial\": 0, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}], \"predefined_state\": null, \"parent_score\": -2.19964814861273, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\"]}, \"score\": -2.1980300706973246, \"memory_update\": \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\"}, {\"search_node\": {\"trial\": 5, \"parent_trial\": 4, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\", \"score\": -2.1980300706973246}], \"predefined_state\": null, \"parent_score\": -2.1980300706973246, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\", \"import pandas as pd\\nimport numpy as np\\nimport ast\\n\\n# Helper function for safe JSON parsing\\ndef safe_literal_eval(x):\\n    try:\\n        if pd.isna(x):\\n            return []\\n        return ast.literal_eval(x)\\n    except (ValueError, SyntaxError):\\n        return []\\n\\n# Feature: genre_Science_Fiction (Binary: 1 if 'Science Fiction' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}, {'id': 10749, 'name': 'Romance'}, {'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Science_Fiction'] = df['genres'].apply(lambda x: 1 if 'Science Fiction' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Family (Binary: 1 if 'Family' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Family'] = df['genres'].apply(lambda x: 1 if 'Family' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Animation (Binary: 1 if 'Animation' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Animation'] = df['genres'].apply(lambda x: 1 if 'Animation' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Fantasy (Binary: 1 if 'Fantasy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Fantasy'] = df['genres'].apply(lambda x: 1 if 'Fantasy' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_male_cast (Number of male actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_male_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 2) if isinstance(x, str) else 0)\\n\\n# Feature: num_female_cast (Number of female actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_female_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 1) if isinstance(x, str) else 0)\\n\\n# Feature: num_unknown_gender_cast (Number of cast members with unknown gender)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 0, \\\\'id\\\\': 7470, \\\\'name\\\\': \\\\'Meat Loaf\\\\'}]\\\", \\\"nan\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}]\\\"]\\ndf['num_unknown_gender_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 0) if isinstance(x, str) else 0)\\n\\n# Feature: has_producer (Binary: 1 if at least one 'Producer' is listed in crew, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi'}]\\\", \\\"nan\\\"]\\ndf['has_producer'] = df['crew'].apply(lambda x: 1 if 'Producer' in [d.get('job') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_producers (Number of producers listed in the crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Producer', 'name': 'Alison Greenspan'}, {'job': 'Producer', 'name': 'Ravi D. Mehta'}]\\\", \\\"nan\\\"]\\ndf['num_producers'] = df['crew'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('job') == 'Producer') if isinstance(x, str) else 0)\\n\\n# Feature: has_female_director (Binary: 1 if any female director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_female_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 1 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_male_director (Binary: 1 if any male director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_male_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 2 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_screenwriter (Binary: 1 if any screenwriter is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Screenplay', 'name': 'Jim Uhls'}]\\\", \\\"[{'job': 'Writer', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['has_screenwriter'] = df['crew'].apply(lambda x: 1 if any(d.get('job') in ['Screenplay', 'Writer'] for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_music_composer (Binary: 1 if an original music composer is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer', 'name': 'John King'}]\\\", \\\"[{'job': 'Music', 'name': 'Hans Zimmer'}]\\\", \\\"nan\\\"]\\ndf['has_music_composer'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Original Music Composer' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: num_crew_departments (Number of unique departments listed in the crew)\\n# Input samples: 'crew': [\\\"[{'department': 'Production'}, {'department': 'Art'}]\\\", \\\"[{'department': 'Directing'}, {'department': 'Sound'}]\\\", \\\"nan\\\"]\\ndf['num_crew_departments'] = df['crew'].apply(lambda x: len(set(d.get('department') for d in safe_literal_eval(x) if 'department' in d)) if isinstance(x, str) else 0)\\n\\n# Feature: production_countries_contains_DE (Binary: 1 if Germany is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_DE'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'DE' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_FR (Binary: 1 if France is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_FR'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'FR' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_GB (Binary: 1 if UK is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_GB'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'GB' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_large_company (Binary: 1 if any of the top global production companies are involved, 0 otherwise)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Warner Bros.', 'id': 174}]\\\", \\\"[{'name': 'Small Indie', 'id': 99999}]\\\"]\\nlarge_companies = ['Warner Bros.', 'Universal Pictures', 'Walt Disney Pictures', 'Columbia Pictures', 'Paramount Pictures', '20th Century Fox', 'DreamWorks Pictures', 'New Line Cinema']\\ndf['has_large_company'] = df['production_companies'].apply(lambda x: 1 if any(any(c_name in company['name'] for c_name in large_companies) for company in safe_literal_eval(x)) else 0)\"]}, \"score\": -2.2368881056147365, \"memory_update\": \"import pandas as pd\\nimport numpy as np\\nimport ast\\n\\n# Helper function for safe JSON parsing\\ndef safe_literal_eval(x):\\n    try:\\n        if pd.isna(x):\\n            return []\\n        return ast.literal_eval(x)\\n    except (ValueError, SyntaxError):\\n        return []\\n\\n# Feature: genre_Science_Fiction (Binary: 1 if 'Science Fiction' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}, {'id': 10749, 'name': 'Romance'}, {'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Science_Fiction'] = df['genres'].apply(lambda x: 1 if 'Science Fiction' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Family (Binary: 1 if 'Family' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Family'] = df['genres'].apply(lambda x: 1 if 'Family' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Animation (Binary: 1 if 'Animation' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Animation'] = df['genres'].apply(lambda x: 1 if 'Animation' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Fantasy (Binary: 1 if 'Fantasy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Fantasy'] = df['genres'].apply(lambda x: 1 if 'Fantasy' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_male_cast (Number of male actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_male_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 2) if isinstance(x, str) else 0)\\n\\n# Feature: num_female_cast (Number of female actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_female_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 1) if isinstance(x, str) else 0)\\n\\n# Feature: num_unknown_gender_cast (Number of cast members with unknown gender)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 0, \\\\'id\\\\': 7470, \\\\'name\\\\': \\\\'Meat Loaf\\\\'}]\\\", \\\"nan\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}]\\\"]\\ndf['num_unknown_gender_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 0) if isinstance(x, str) else 0)\\n\\n# Feature: has_producer (Binary: 1 if at least one 'Producer' is listed in crew, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi'}]\\\", \\\"nan\\\"]\\ndf['has_producer'] = df['crew'].apply(lambda x: 1 if 'Producer' in [d.get('job') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_producers (Number of producers listed in the crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Producer', 'name': 'Alison Greenspan'}, {'job': 'Producer', 'name': 'Ravi D. Mehta'}]\\\", \\\"nan\\\"]\\ndf['num_producers'] = df['crew'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('job') == 'Producer') if isinstance(x, str) else 0)\\n\\n# Feature: has_female_director (Binary: 1 if any female director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_female_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 1 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_male_director (Binary: 1 if any male director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_male_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 2 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_screenwriter (Binary: 1 if any screenwriter is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Screenplay', 'name': 'Jim Uhls'}]\\\", \\\"[{'job': 'Writer', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['has_screenwriter'] = df['crew'].apply(lambda x: 1 if any(d.get('job') in ['Screenplay', 'Writer'] for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_music_composer (Binary: 1 if an original music composer is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer', 'name': 'John King'}]\\\", \\\"[{'job': 'Music', 'name': 'Hans Zimmer'}]\\\", \\\"nan\\\"]\\ndf['has_music_composer'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Original Music Composer' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: num_crew_departments (Number of unique departments listed in the crew)\\n# Input samples: 'crew': [\\\"[{'department': 'Production'}, {'department': 'Art'}]\\\", \\\"[{'department': 'Directing'}, {'department': 'Sound'}]\\\", \\\"nan\\\"]\\ndf['num_crew_departments'] = df['crew'].apply(lambda x: len(set(d.get('department') for d in safe_literal_eval(x) if 'department' in d)) if isinstance(x, str) else 0)\\n\\n# Feature: production_countries_contains_DE (Binary: 1 if Germany is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_DE'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'DE' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_FR (Binary: 1 if France is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_FR'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'FR' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_GB (Binary: 1 if UK is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_GB'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'GB' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_large_company (Binary: 1 if any of the top global production companies are involved, 0 otherwise)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Warner Bros.', 'id': 174}]\\\", \\\"[{'name': 'Small Indie', 'id': 99999}]\\\"]\\nlarge_companies = ['Warner Bros.', 'Universal Pictures', 'Walt Disney Pictures', 'Columbia Pictures', 'Paramount Pictures', '20th Century Fox', 'DreamWorks Pictures', 'New Line Cinema']\\ndf['has_large_company'] = df['production_companies'].apply(lambda x: 1 if any(any(c_name in company['name'] for c_name in large_companies) for company in safe_literal_eval(x)) else 0)\"}, {\"search_node\": {\"trial\": 6, \"parent_trial\": 5, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\", \"score\": -2.1980300706973246}, {\"update\": \"import pandas as pd\\nimport numpy as np\\nimport ast\\n\\n# Helper function for safe JSON parsing\\ndef safe_literal_eval(x):\\n    try:\\n        if pd.isna(x):\\n            return []\\n        return ast.literal_eval(x)\\n    except (ValueError, SyntaxError):\\n        return []\\n\\n# Feature: genre_Science_Fiction (Binary: 1 if 'Science Fiction' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}, {'id': 10749, 'name': 'Romance'}, {'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Science_Fiction'] = df['genres'].apply(lambda x: 1 if 'Science Fiction' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Family (Binary: 1 if 'Family' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Family'] = df['genres'].apply(lambda x: 1 if 'Family' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Animation (Binary: 1 if 'Animation' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Animation'] = df['genres'].apply(lambda x: 1 if 'Animation' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: genre_Fantasy (Binary: 1 if 'Fantasy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Fantasy'] = df['genres'].apply(lambda x: 1 if 'Fantasy' in [d.get('name') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_male_cast (Number of male actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_male_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 2) if isinstance(x, str) else 0)\\n\\n# Feature: num_female_cast (Number of female actors in the cast)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 1, \\\\'id\\\\': 1283, \\\\'name\\\\': \\\\'Helena Bonham Carter\\\\'}]\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}, {\\\\'gender\\\\': 2, \\\\'id\\\\': 22128, \\\\'name\\\\': \\\\'Geoff Stults\\\\'}]\\\", \\\"nan\\\"]\\ndf['num_female_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 1) if isinstance(x, str) else 0)\\n\\n# Feature: num_unknown_gender_cast (Number of cast members with unknown gender)\\n# Input samples: 'cast': [\\\"[{\\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\'}, {\\\\'gender\\\\': 0, \\\\'id\\\\': 7470, \\\\'name\\\\': \\\\'Meat Loaf\\\\'}]\\\", \\\"nan\\\", \\\"[{\\\\'gender\\\\': 1, \\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\'}]\\\"]\\ndf['num_unknown_gender_cast'] = df['cast'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('gender') == 0) if isinstance(x, str) else 0)\\n\\n# Feature: has_producer (Binary: 1 if at least one 'Producer' is listed in crew, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi'}]\\\", \\\"nan\\\"]\\ndf['has_producer'] = df['crew'].apply(lambda x: 1 if 'Producer' in [d.get('job') for d in safe_literal_eval(x)] else 0)\\n\\n# Feature: num_producers (Number of producers listed in the crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Executive Producer', 'name': 'Arnon Milchan'}, {'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'job': 'Producer', 'name': 'Alison Greenspan'}, {'job': 'Producer', 'name': 'Ravi D. Mehta'}]\\\", \\\"nan\\\"]\\ndf['num_producers'] = df['crew'].apply(lambda x: sum(1 for d in safe_literal_eval(x) if d.get('job') == 'Producer') if isinstance(x, str) else 0)\\n\\n# Feature: has_female_director (Binary: 1 if any female director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_female_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 1 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_male_director (Binary: 1 if any male director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'name': 'Denise Di Novi', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['has_male_director'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Director' and d.get('gender') == 2 for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_screenwriter (Binary: 1 if any screenwriter is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Screenplay', 'name': 'Jim Uhls'}]\\\", \\\"[{'job': 'Writer', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['has_screenwriter'] = df['crew'].apply(lambda x: 1 if any(d.get('job') in ['Screenplay', 'Writer'] for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_music_composer (Binary: 1 if an original music composer is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer', 'name': 'John King'}]\\\", \\\"[{'job': 'Music', 'name': 'Hans Zimmer'}]\\\", \\\"nan\\\"]\\ndf['has_music_composer'] = df['crew'].apply(lambda x: 1 if any(d.get('job') == 'Original Music Composer' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: num_crew_departments (Number of unique departments listed in the crew)\\n# Input samples: 'crew': [\\\"[{'department': 'Production'}, {'department': 'Art'}]\\\", \\\"[{'department': 'Directing'}, {'department': 'Sound'}]\\\", \\\"nan\\\"]\\ndf['num_crew_departments'] = df['crew'].apply(lambda x: len(set(d.get('department') for d in safe_literal_eval(x) if 'department' in d)) if isinstance(x, str) else 0)\\n\\n# Feature: production_countries_contains_DE (Binary: 1 if Germany is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_DE'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'DE' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_FR (Binary: 1 if France is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_FR'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'FR' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: production_countries_contains_GB (Binary: 1 if UK is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['production_countries_contains_GB'] = df['production_countries'].apply(lambda x: 1 if any(d.get('iso_3166_1') == 'GB' for d in safe_literal_eval(x)) else 0)\\n\\n# Feature: has_large_company (Binary: 1 if any of the top global production companies are involved, 0 otherwise)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Warner Bros.', 'id': 174}]\\\", \\\"[{'name': 'Small Indie', 'id': 99999}]\\\"]\\nlarge_companies = ['Warner Bros.', 'Universal Pictures', 'Walt Disney Pictures', 'Columbia Pictures', 'Paramount Pictures', '20th Century Fox', 'DreamWorks Pictures', 'New Line Cinema']\\ndf['has_large_company'] = df['production_companies'].apply(lambda x: 1 if any(any(c_name in company['name'] for c_name in large_companies) for company in safe_literal_eval(x)) else 0)\", \"score\": -2.2368881056147365}], \"predefined_state\": null, \"parent_score\": -2.2368881056147365, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"# Feature: has_collection (Binary: 1 if movie belongs to a collection, 0 otherwise)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\nimport ast\\nimport numpy as np\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: collection_name_length (Length of the collection name if available)\\n# Input samples: 'belongs_to_collection': [nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['collection_name_length'] = df['belongs_to_collection'].apply(\\n    lambda x: len(ast.literal_eval(x)[0]['name']) if isinstance(x, str) and str(x) != 'nan' and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_genres (Number of genres a movie belongs to)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: genre_Drama (Binary: 1 if 'Drama' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Drama'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Drama' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Comedy (Binary: 1 if 'Comedy' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_Comedy'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Comedy' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Action (Binary: 1 if 'Action' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\"]\\ndf['genre_Action'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Action' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Thriller (Binary: 1 if 'Thriller' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\"]\\ndf['genre_Thriller'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Thriller' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: genre_Adventure (Binary: 1 if 'Adventure' is among the genres, 0 otherwise)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_Adventure'] = df['genres'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('name') == 'Adventure' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_production_companies (Number of production companies listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"nan\\\"]\\ndf['num_production_companies'] = df['production_companies'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_usa_production_company (Binary: 1 if a USA-based company is listed)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\", \\\"[{'name': 'Haut et Court', 'id': 726}]\\\"]\\nus_companies = ['Twentieth Century Fox', 'Universal Pictures', 'Columbia Pictures', 'Warner Bros.', 'Paramount Pictures', 'Walt Disney', 'DreamWorks', 'Metro-Goldwyn-Mayer', 'Lionsgate', 'Miramax', 'Legendary Pictures', 'Marvel Studios', 'Lightstorm Entertainment', 'Regency Enterprises', 'Fox 2000 Pictures', 'DiNovi Pictures', 'Imagine Entertainment', 'Spyglass Entertainment', 'Wild West Picture Show Productions']\\ndf['has_usa_production_company'] = df['production_companies'].apply(lambda x: 1 if isinstance(x, str) and any(comp['name'].startswith(tuple(us_companies)) for comp in ast.literal_eval(x)) else 0)\\n\\n\\n# Feature: num_production_countries (Number of production countries listed)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['num_production_countries'] = df['production_countries'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_usa_production (Binary: 1 if USA is a production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}]\\\"]\\ndf['is_usa_production'] = df['production_countries'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_3166_1') == 'US' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: is_multilingual (Binary: 1 if movie has more than one spoken language, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\"]\\ndf['is_multilingual'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and len(ast.literal_eval(x)) > 1 else 0)\\n\\n# Feature: has_english_spoken (Binary: 1 if English is among spoken languages, 0 otherwise)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['has_english_spoken'] = df['spoken_languages'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('iso_639_1') == 'en' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: num_spoken_languages (Number of spoken languages listed)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_keywords (Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}]\\\"]\\ndf['num_keywords'] = df['Keywords'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: num_cast (Total number of cast members listed)\\n# Input samples: 'cast': [\\\"[{'cast_id': 4, 'character': 'The Narrator', 'credit_id': '52fe4250c3a36847f80149f3'}]\\\", \\\"[{'cast_id': 1, 'character': 'Julia Banks', 'credit_id': '57eb86c79251410db40034b4'}]\\\", \\\"nan\\\"]\\ndf['num_cast'] = df['cast'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: top_cast_popularity (Popularity of the first listed cast member, often lead)\\n# Input samples: 'cast': [\\\"[{\\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]\\\", \\\"[{\\\\'id\\\\': 5916, \\\\'name\\\\': \\\\'Rosario Dawson\\\\', \\\\'order\\\\': 0}]\\\", \\\"nan\\\"]\\ndf['top_cast_id'] = df['cast'].apply(\\n    lambda x: ast.literal_eval(x)[0]['id'] if isinstance(x, str) and ast.literal_eval(x) else 0\\n)\\n\\n# Feature: num_crew (Total number of crew members listed)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'job': 'Executive Producer'}]\\\", \\\"nan\\\", \\\"[{'credit_id': '55e46eb8c3a368418e003da6', 'department': 'Production', 'job': 'Producer'}]\\\"]\\ndf['num_crew'] = df['crew'].apply(lambda x: len(ast.literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: has_director (Binary: 1 if a director is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer'}]\\\"]\\ndf['has_director'] = df['crew'].apply(lambda x: 1 if isinstance(x, str) and any(d.get('job') == 'Director' for d in ast.literal_eval(x)) else 0)\\n\\n# Feature: director_name_count (Number of directors listed for the movie)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Mark Burton'}, {'job': 'Director', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['director_name_count'] = df['crew'].apply(lambda x: sum(1 for d in ast.literal_eval(x) if d.get('job') == 'Director') if isinstance(x, str) else 0)\\n\\n# Feature: has_homepage (Binary: 1 if a homepage URL is provided, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: has_tagline (Binary: 1 if a tagline is provided, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: original_title_length (Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# Feature: overview_word_count (Number of words in the overview/plot summary)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife...', 'When Shaun decides to take the day off and have some fun...']\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# Feature: budget_transformed (Log transformation of budget, handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_transformed'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: runtime_transformed (Log transformation of runtime, handle zero/missing runtimes)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_transformed'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# Feature: popularity_transformed (Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_transformed'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# Feature: title_equals_original_title (Binary: 1 if title is same as original_title)\\n# Input samples: 'title': ['Fight Club', 'Illegal', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Ill\\u00e9gal', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Feature: weekend_release (Binary: 1 if movie released on a Friday (dayofweek 4))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x == 4.0 else 0)\\n\\n# Feature: month_quarter (Map month to quarter: 1, 2, 3, 4)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['month_quarter'] = df['release_month'].apply(lambda x: int((x-1)//3) + 1 if not pd.isna(x) else 0)\\n\\n# Feature: year_month (Combination of release year and month, as continuous for seasonality)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'release_month': [10.0, 4.0, 2.0]\\ndf['year_month'] = df.apply(lambda row: (row['release_year'] * 12 + row['release_month']) if not pd.isna(row['release_year']) and not pd.isna(row['release_month']) else 0, axis=1)\\n\\n# Feature: runtime_to_budget_ratio\\n# Input samples: 'runtime': [139, 100, 85], 'budget': [63000000, 12000000, 0]\\ndf['runtime_to_budget_ratio'] = df.apply(lambda row: row['runtime_transformed'] / (row['budget_transformed'] + 1e-6) if row['runtime_transformed'] > 0 and row['budget_transformed'] > 0 else 0, axis=1)\\n\", \"import ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# Helper function for safe JSON parsing\\ndef safe_literal_eval(x):\\n    try:\\n        if pd.isna(x):\\n            return []\\n        return ast.literal_eval(x)\\n    except (ValueError, SyntaxError):\\n        return []\\n\\n# Feature: homepage_present (Binary: 1 if movie has a homepage, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: tagline_present (Binary: 1 if movie has a tagline, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: director_gender (Gender of the first listed director, -1 for no director or unknown gender)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['director_gender'] = df['crew'].apply(\\n    lambda x: next((d.get('gender', 0) for d in safe_literal_eval(x) if d.get('job') == 'Director'), 0)\\n)\\n\\n# Feature: screenwriter_present (Binary: 1 if a screenwriter is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Screenplay', 'name': 'Jim Uhls'}]\\\", \\\"[{'job': 'Writer', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['screenwriter_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') in ['Screenplay', 'Writer'] for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: editor_present (Binary: 1 if an editor is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Editor', 'name': 'James Haygood'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer', 'name': 'Paul Kewley'}]\\\"]\\ndf['editor_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') == 'Editor' for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: cinematographer_present (Binary: 1 if a director of photography is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director of Photography', 'name': 'Jeff Cronenweth'}]\\\", \\\"nan\\\", \\\"[{'job': 'Camera Operator', 'name': 'Chris Schwiebert'}]\\\"]\\ndf['cinematographer_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') == 'Director of Photography' for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: budget_popularity_ratio (Ratio of transformed budget to transformed popularity, scaled)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_popularity_ratio'] = df.apply(\\n    lambda row: np.log1p(row['budget']) / np.log1p(row['popularity']) if row['budget'] > 0 and row['popularity'] > 0 else 0,\\n    axis=1\\n)\\n\\n# Feature: has_keywords (Binary: 1 if keywords are provided, 0 otherwise)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}]\\\"]\\ndf['has_keywords'] = df['Keywords'].apply(lambda x: 1 if isinstance(x, str) and x != 'nan' and safe_literal_eval(x) else 0)\\n\\n# Feature: spoken_language_count (Number of spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['spoken_language_count'] = df['spoken_languages'].apply(lambda x: len(safe_literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_english_original_language (Binary: 1 if original language is English, 0 otherwise)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['is_english_original_language'] = (df['original_language'] == 'en').astype(int)\\n\\n# Feature: top_3_cast_gender_balance (Sum of genders for top 3 cast: male=2, female=1, unknown=0)\\n# Input samples: 'cast': [\\\"[{\\\\'order\\\\':0, \\\\'gender\\\\':2}, {\\\\'order\\\\':1, \\\\'gender\\\\':1}, {\\\\'order\\\\':2, \\\\'gender\\\\':2}, {\\\\'order\\\\':3, \\\\'gender\\\\':0}]\\\", \\\"[{\\\\'order\\\\':0, \\\\'gender\\\\':1}, {\\\\'order\\\\':1, \\\\'gender\\\\':2}]\\\", \\\"nan\\\"]\\ndef get_top_n_cast_gender_sum(cast_str, n=3):\\n    cast_list = safe_literal_eval(cast_str)\\n    sorted_cast = sorted([c for c in cast_list if 'order' in c and 'gender' in c], key=lambda x: x['order'])\\n    top_n_genders = [c['gender'] for c in sorted_cast[:n]]\\n    return sum(top_n_genders) if top_n_genders else 0\\n\\ndf['top_3_cast_gender_sum'] = df['cast'].apply(get_top_n_cast_gender_sum)\\n\\n# Feature: production_companies_unique_count (Number of unique production companies)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}]\\\", \\\"nan\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_companies_unique_count'] = df['production_companies'].apply(lambda x: len(set(d['name'] for d in safe_literal_eval(x))) if isinstance(x, str) else 0)\\n\\n# Feature: overview_length_per_runtime (Ratio of overview word count to runtime, for well-described vs long)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David...'], 'runtime': [139, 100]\\ndf['overview_word_count_normalized'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\ndf['overview_length_per_runtime'] = df.apply(\\n    lambda row: row['overview_word_count_normalized'] / (row['runtime'] + 1e-6) if row['runtime'] > 0 else 0,\\n    axis=1\\n)\\n\\n# Feature: production_countries_is_single (Binary: 1 if only one production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['production_countries_is_single'] = df['production_countries'].apply(\\n    lambda x: 1 if isinstance(x, str) and len(safe_literal_eval(x)) == 1 else 0\\n)\\n\\n# Feature: genre_score_major (A simple weighted sum based on typical box office impact of certain genres)\\n# Weights can be empirically derived; here, higher weights for generally more commercially successful genres.\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ngenre_weights = {\\n    'Action': 1.2, 'Adventure': 1.1, 'Science Fiction': 1.1, 'Fantasy': 1.1,\\n    'Family': 1.0, 'Animation': 1.0, 'Comedy': 0.9, 'Thriller': 0.8,\\n    'Drama': 0.7, 'Romance': 0.7, 'Crime': 0.8, 'Mystery': 0.8, 'Horror': 0.7,\\n    'Western': 0.6, 'Music': 0.6, 'Documentary': 0.5, 'History': 0.5, 'War': 0.6\\n}\\ndf['genre_score_major'] = df['genres'].apply(\\n    lambda x: sum(genre_weights.get(g['name'], 0.5) for g in safe_literal_eval(x))\\n    if isinstance(x, str) else 0\\n)\\n\\n# Feature: production_company_has_id (Binary: 1 if at least one production company has an ID, implying valid entry, 0 otherwise)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"nan\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\"]\\ndf['production_company_has_id'] = df['production_companies'].apply(\\n    lambda x: 1 if isinstance(x, str) and any(d.get('id') for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: keywords_short_tagline_length_ratio (ratio of keywords count to tagline length, for short taglines, indicate movie mystery/minimal info for hype?)\\n# Input samples: 'Keywords': [\\\"[{}, {}]\\\", \\\"[{}]\\\"], 'tagline': [\\\"Long Tagline Example\\\", \\\"Short tag.\\\", nan]\\ndf['keywords_short_tagline_length_ratio'] = df.apply(\\n    lambda row: len(safe_literal_eval(row['Keywords'])) / (len(str(row['tagline'])) + 1e-6)\\n    if isinstance(row['Keywords'], str) and not pd.isna(row['tagline']) and len(str(row['tagline'])) > 0 else 0,\\n    axis=1\\n)\"]}, \"score\": -2.1972550053333983, \"memory_update\": \"import ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# Helper function for safe JSON parsing\\ndef safe_literal_eval(x):\\n    try:\\n        if pd.isna(x):\\n            return []\\n        return ast.literal_eval(x)\\n    except (ValueError, SyntaxError):\\n        return []\\n\\n# Feature: homepage_present (Binary: 1 if movie has a homepage, 0 otherwise)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: tagline_present (Binary: 1 if movie has a tagline, 0 otherwise)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and str(x) != 'nan' else 0)\\n\\n# Feature: director_gender (Gender of the first listed director, -1 for no director or unknown gender)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'gender': 2}]\\\", \\\"[{'job': 'Director', 'gender': 1}]\\\", \\\"nan\\\"]\\ndf['director_gender'] = df['crew'].apply(\\n    lambda x: next((d.get('gender', 0) for d in safe_literal_eval(x) if d.get('job') == 'Director'), 0)\\n)\\n\\n# Feature: screenwriter_present (Binary: 1 if a screenwriter is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Screenplay', 'name': 'Jim Uhls'}]\\\", \\\"[{'job': 'Writer', 'name': 'Richard Starzack'}]\\\", \\\"nan\\\"]\\ndf['screenwriter_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') in ['Screenplay', 'Writer'] for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: editor_present (Binary: 1 if an editor is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Editor', 'name': 'James Haygood'}]\\\", \\\"nan\\\", \\\"[{'job': 'Producer', 'name': 'Paul Kewley'}]\\\"]\\ndf['editor_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') == 'Editor' for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: cinematographer_present (Binary: 1 if a director of photography is listed, 0 otherwise)\\n# Input samples: 'crew': [\\\"[{'job': 'Director of Photography', 'name': 'Jeff Cronenweth'}]\\\", \\\"nan\\\", \\\"[{'job': 'Camera Operator', 'name': 'Chris Schwiebert'}]\\\"]\\ndf['cinematographer_present'] = df['crew'].apply(\\n    lambda x: 1 if any(d.get('job') == 'Director of Photography' for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: budget_popularity_ratio (Ratio of transformed budget to transformed popularity, scaled)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_popularity_ratio'] = df.apply(\\n    lambda row: np.log1p(row['budget']) / np.log1p(row['popularity']) if row['budget'] > 0 and row['popularity'] > 0 else 0,\\n    axis=1\\n)\\n\\n# Feature: has_keywords (Binary: 1 if keywords are provided, 0 otherwise)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}]\\\", \\\"nan\\\", \\\"[{'id': 548, 'name': 'countryside'}]\\\"]\\ndf['has_keywords'] = df['Keywords'].apply(lambda x: 1 if isinstance(x, str) and x != 'nan' and safe_literal_eval(x) else 0)\\n\\n# Feature: spoken_language_count (Number of spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"nan\\\"]\\ndf['spoken_language_count'] = df['spoken_languages'].apply(lambda x: len(safe_literal_eval(x)) if isinstance(x, str) else 0)\\n\\n# Feature: is_english_original_language (Binary: 1 if original language is English, 0 otherwise)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['is_english_original_language'] = (df['original_language'] == 'en').astype(int)\\n\\n# Feature: top_3_cast_gender_balance (Sum of genders for top 3 cast: male=2, female=1, unknown=0)\\n# Input samples: 'cast': [\\\"[{\\\\'order\\\\':0, \\\\'gender\\\\':2}, {\\\\'order\\\\':1, \\\\'gender\\\\':1}, {\\\\'order\\\\':2, \\\\'gender\\\\':2}, {\\\\'order\\\\':3, \\\\'gender\\\\':0}]\\\", \\\"[{\\\\'order\\\\':0, \\\\'gender\\\\':1}, {\\\\'order\\\\':1, \\\\'gender\\\\':2}]\\\", \\\"nan\\\"]\\ndef get_top_n_cast_gender_sum(cast_str, n=3):\\n    cast_list = safe_literal_eval(cast_str)\\n    sorted_cast = sorted([c for c in cast_list if 'order' in c and 'gender' in c], key=lambda x: x['order'])\\n    top_n_genders = [c['gender'] for c in sorted_cast[:n]]\\n    return sum(top_n_genders) if top_n_genders else 0\\n\\ndf['top_3_cast_gender_sum'] = df['cast'].apply(get_top_n_cast_gender_sum)\\n\\n# Feature: production_companies_unique_count (Number of unique production companies)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}]\\\", \\\"nan\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_companies_unique_count'] = df['production_companies'].apply(lambda x: len(set(d['name'] for d in safe_literal_eval(x))) if isinstance(x, str) else 0)\\n\\n# Feature: overview_length_per_runtime (Ratio of overview word count to runtime, for well-described vs long)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', 'Julia moves in with her fianc\\u221a\\u00a9, David...'], 'runtime': [139, 100]\\ndf['overview_word_count_normalized'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\ndf['overview_length_per_runtime'] = df.apply(\\n    lambda row: row['overview_word_count_normalized'] / (row['runtime'] + 1e-6) if row['runtime'] > 0 else 0,\\n    axis=1\\n)\\n\\n# Feature: production_countries_is_single (Binary: 1 if only one production country, 0 otherwise)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"nan\\\"]\\ndf['production_countries_is_single'] = df['production_countries'].apply(\\n    lambda x: 1 if isinstance(x, str) and len(safe_literal_eval(x)) == 1 else 0\\n)\\n\\n# Feature: genre_score_major (A simple weighted sum based on typical box office impact of certain genres)\\n# Weights can be empirically derived; here, higher weights for generally more commercially successful genres.\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ngenre_weights = {\\n    'Action': 1.2, 'Adventure': 1.1, 'Science Fiction': 1.1, 'Fantasy': 1.1,\\n    'Family': 1.0, 'Animation': 1.0, 'Comedy': 0.9, 'Thriller': 0.8,\\n    'Drama': 0.7, 'Romance': 0.7, 'Crime': 0.8, 'Mystery': 0.8, 'Horror': 0.7,\\n    'Western': 0.6, 'Music': 0.6, 'Documentary': 0.5, 'History': 0.5, 'War': 0.6\\n}\\ndf['genre_score_major'] = df['genres'].apply(\\n    lambda x: sum(genre_weights.get(g['name'], 0.5) for g in safe_literal_eval(x))\\n    if isinstance(x, str) else 0\\n)\\n\\n# Feature: production_company_has_id (Binary: 1 if at least one production company has an ID, implying valid entry, 0 otherwise)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"nan\\\", \\\"[{'name': 'TNT', 'id': 21928}]\\\"]\\ndf['production_company_has_id'] = df['production_companies'].apply(\\n    lambda x: 1 if isinstance(x, str) and any(d.get('id') for d in safe_literal_eval(x)) else 0\\n)\\n\\n# Feature: keywords_short_tagline_length_ratio (ratio of keywords count to tagline length, for short taglines, indicate movie mystery/minimal info for hype?)\\n# Input samples: 'Keywords': [\\\"[{}, {}]\\\", \\\"[{}]\\\"], 'tagline': [\\\"Long Tagline Example\\\", \\\"Short tag.\\\", nan]\\ndf['keywords_short_tagline_length_ratio'] = df.apply(\\n    lambda row: len(safe_literal_eval(row['Keywords'])) / (len(str(row['tagline'])) + 1e-6)\\n    if isinstance(row['Keywords'], str) and not pd.isna(row['tagline']) and len(str(row['tagline'])) > 0 else 0,\\n    axis=1\\n)\"}, {\"search_node\": {\"trial\": 7, \"parent_trial\": 1, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}], \"predefined_state\": null, \"parent_score\": -2.194834450371649, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\"]}, \"score\": -2.1807121926184094, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\"}, {\"search_node\": {\"trial\": 8, \"parent_trial\": 1, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}], \"predefined_state\": null, \"parent_score\": -2.194834450371649, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\"]}, \"score\": -2.1878916554583694, \"memory_update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\"}, {\"search_node\": {\"trial\": 9, \"parent_trial\": 0, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}], \"predefined_state\": null, \"parent_score\": -2.19964814861273, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"# (Feature: has_collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Feature: homepage_present)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: tagline_present)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: overview_word_count)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy. Their concept catches on, with underground \\\"fight clubs\\\" forming in every town, until an eccentric gets in the way and ignites an out-of-control spiral toward oblivion.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for. A mix up with the Farmer, a caravan and a very steep hill lead them all to the Big City and it's up to Shaun and the flock to return everyone safely to the green grass of home.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: is_english)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: title_vs_original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_vs_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# JSON parsing for 'genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew'\\n# Safely evaluate string literal for list of dicts.\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError):\\n        return []\\n\\ndf['genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\ndf['production_countries_parsed'] = df['production_countries'].apply(safe_literal_eval)\\ndf['spoken_languages_parsed'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['Keywords_parsed'] = df['Keywords'].apply(safe_literal_eval)\\ndf['cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['crew_parsed'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: num_genres)\\n# Input samples: 'genres': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres_parsed'].apply(len)\\n\\n# (Feature: num_production_companies)\\n# Input samples: 'production_companies': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_companies'] = df['production_companies_parsed'].apply(len)\\n\\n# (Feature: num_production_countries)\\n# Input samples: 'production_countries': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_countries'] = df['production_countries_parsed'].apply(len)\\n\\n# (Feature: num_spoken_languages)\\n# Input samples: 'spoken_languages': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages_parsed'].apply(len)\\n\\n# (Feature: num_Keywords)\\n# Input samples: 'Keywords': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_Keywords'] = df['Keywords_parsed'].apply(len)\\n\\n# (Feature: num_cast)\\n# Input samples: 'cast': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_cast'] = df['cast_parsed'].apply(len)\\n\\n# (Feature: num_crew)\\n# Input samples: 'crew': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_crew'] = df['crew_parsed'].apply(len)\\n\\n# (Feature: director_gender)\\n# Input samples: 'crew_parsed': [[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '...'}], [{'credit_id': '...', 'department': 'Directing', 'gender': 1, 'id': 1899, 'job': 'Director', 'name': 'Denise Di Novi', 'profile_path': '...'}], []]\\ndef get_director_gender(crew_list):\\n    for member in crew_list:\\n        if member.get('job') == 'Director':\\n            return member.get('gender', 0) # 1: female, 2: male, 0: unknown\\n    return 0\\ndf['director_gender'] = df['crew_parsed'].apply(get_director_gender)\\n\\n# (Feature: num_cast_gender_1 - female)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_1'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: num_cast_gender_2 - male)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_2'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\n\\n# (Feature: ratio_male_cast)\\n# Input samples: 'num_cast_gender_2': [2, 1, 0], 'num_cast_gender_1': [1, 2, 0]\\ndf['ratio_male_cast'] = df.apply(lambda row: row['num_cast_gender_2'] / (row['num_cast_gender_1'] + row['num_cast_gender_2']) if (row['num_cast_gender_1'] + row['num_cast_gender_2']) > 0 else 0, axis=1)\\n\\n# (Feature: genre_encoded_Drama)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Drama'}, {'name': 'Thriller'}], [{'name': 'Family'}, {'name': 'Animation'}, {'name': 'Comedy'}, {'name': 'Adventure'}]]\\ndef has_genre(genre_list, genre_name):\\n    return 1 if any(g.get('name') == genre_name for g in genre_list) else 0\\n\\nfor genre_name in ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Horror', 'Romance']:\\n    df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: has_genre(x, genre_name))\\n\\n# (Feature: prod_country_US)\\n# Input samples: 'production_countries_parsed': [[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}], [{'iso_3166_1': 'US'}], [{'iso_3166_1': 'FR'}, {'iso_3166_1': 'GB'}]]\\ndef has_country(country_list, country_iso):\\n    return 1 if any(c.get('iso_3166_1') == country_iso for c in country_list) else 0\\n\\nfor country_iso in ['US', 'GB', 'FR', 'DE', 'RU']: # Top countries\\n    df[f'prod_country_{country_iso}'] = df['production_countries_parsed'].apply(lambda x: has_country(x, country_iso))\\n\\n# (Feature: spoke_language_en)\\n# Input samples: 'spoken_languages_parsed': [[{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}]]\\ndef has_language(lang_list, lang_iso):\\n    return 1 if any(l.get('iso_639_1') == lang_iso for l in lang_list) else 0\\n\\nfor lang_iso in ['en', 'fr', 'ru', 'de', 'es']: # Top languages\\n    df[f'spoke_language_{lang_iso}'] = df['spoken_languages_parsed'].apply(lambda x: has_language(x, lang_iso))\\n\"]}, \"score\": -2.1943666631942884, \"memory_update\": \"# (Feature: has_collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Feature: homepage_present)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: tagline_present)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: overview_word_count)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy. Their concept catches on, with underground \\\"fight clubs\\\" forming in every town, until an eccentric gets in the way and ignites an out-of-control spiral toward oblivion.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for. A mix up with the Farmer, a caravan and a very steep hill lead them all to the Big City and it's up to Shaun and the flock to return everyone safely to the green grass of home.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: is_english)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: title_vs_original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_vs_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# JSON parsing for 'genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew'\\n# Safely evaluate string literal for list of dicts.\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError):\\n        return []\\n\\ndf['genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\ndf['production_countries_parsed'] = df['production_countries'].apply(safe_literal_eval)\\ndf['spoken_languages_parsed'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['Keywords_parsed'] = df['Keywords'].apply(safe_literal_eval)\\ndf['cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['crew_parsed'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: num_genres)\\n# Input samples: 'genres': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres_parsed'].apply(len)\\n\\n# (Feature: num_production_companies)\\n# Input samples: 'production_companies': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_companies'] = df['production_companies_parsed'].apply(len)\\n\\n# (Feature: num_production_countries)\\n# Input samples: 'production_countries': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_countries'] = df['production_countries_parsed'].apply(len)\\n\\n# (Feature: num_spoken_languages)\\n# Input samples: 'spoken_languages': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages_parsed'].apply(len)\\n\\n# (Feature: num_Keywords)\\n# Input samples: 'Keywords': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_Keywords'] = df['Keywords_parsed'].apply(len)\\n\\n# (Feature: num_cast)\\n# Input samples: 'cast': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_cast'] = df['cast_parsed'].apply(len)\\n\\n# (Feature: num_crew)\\n# Input samples: 'crew': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_crew'] = df['crew_parsed'].apply(len)\\n\\n# (Feature: director_gender)\\n# Input samples: 'crew_parsed': [[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '...'}], [{'credit_id': '...', 'department': 'Directing', 'gender': 1, 'id': 1899, 'job': 'Director', 'name': 'Denise Di Novi', 'profile_path': '...'}], []]\\ndef get_director_gender(crew_list):\\n    for member in crew_list:\\n        if member.get('job') == 'Director':\\n            return member.get('gender', 0) # 1: female, 2: male, 0: unknown\\n    return 0\\ndf['director_gender'] = df['crew_parsed'].apply(get_director_gender)\\n\\n# (Feature: num_cast_gender_1 - female)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_1'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: num_cast_gender_2 - male)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_2'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\n\\n# (Feature: ratio_male_cast)\\n# Input samples: 'num_cast_gender_2': [2, 1, 0], 'num_cast_gender_1': [1, 2, 0]\\ndf['ratio_male_cast'] = df.apply(lambda row: row['num_cast_gender_2'] / (row['num_cast_gender_1'] + row['num_cast_gender_2']) if (row['num_cast_gender_1'] + row['num_cast_gender_2']) > 0 else 0, axis=1)\\n\\n# (Feature: genre_encoded_Drama)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Drama'}, {'name': 'Thriller'}], [{'name': 'Family'}, {'name': 'Animation'}, {'name': 'Comedy'}, {'name': 'Adventure'}]]\\ndef has_genre(genre_list, genre_name):\\n    return 1 if any(g.get('name') == genre_name for g in genre_list) else 0\\n\\nfor genre_name in ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Horror', 'Romance']:\\n    df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: has_genre(x, genre_name))\\n\\n# (Feature: prod_country_US)\\n# Input samples: 'production_countries_parsed': [[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}], [{'iso_3166_1': 'US'}], [{'iso_3166_1': 'FR'}, {'iso_3166_1': 'GB'}]]\\ndef has_country(country_list, country_iso):\\n    return 1 if any(c.get('iso_3166_1') == country_iso for c in country_list) else 0\\n\\nfor country_iso in ['US', 'GB', 'FR', 'DE', 'RU']: # Top countries\\n    df[f'prod_country_{country_iso}'] = df['production_countries_parsed'].apply(lambda x: has_country(x, country_iso))\\n\\n# (Feature: spoke_language_en)\\n# Input samples: 'spoken_languages_parsed': [[{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}]]\\ndef has_language(lang_list, lang_iso):\\n    return 1 if any(l.get('iso_639_1') == lang_iso for l in lang_list) else 0\\n\\nfor lang_iso in ['en', 'fr', 'ru', 'de', 'es']: # Top languages\\n    df[f'spoke_language_{lang_iso}'] = df['spoken_languages_parsed'].apply(lambda x: has_language(x, lang_iso))\\n\"}, {\"search_node\": {\"trial\": 10, \"parent_trial\": 7, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"score\": -2.1807121926184094}], \"predefined_state\": null, \"parent_score\": -2.1807121926184094, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\"]}, \"score\": -2.175872692501712, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\"}, {\"search_node\": {\"trial\": 11, \"parent_trial\": 10, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"score\": -2.1807121926184094}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"score\": -2.175872692501712}], \"predefined_state\": null, \"parent_score\": -2.175872692501712, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_zero_budget - Binary indicator if the budget is zero, often signifying missing data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n# (Feature: release_decade - The decade in which the movie was released)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: main_genre_id - The ID of the first listed genre, or a placeholder if no genres)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", nan]\\ndf['parsed_genres_for_id'] = df['genres'].apply(safe_literal_eval)\\ndf['main_genre_id'] = df['parsed_genres_for_id'].apply(lambda x: x[0]['id'] if x else -1) # Using -1 for missing genre\\ndel df['parsed_genres_for_id']\\n\\n# (Feature: main_production_company_id - The ID of the first listed production company, or a placeholder)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", nan, \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['parsed_prod_companies_for_id'] = df['production_companies'].apply(safe_literal_eval)\\ndf['main_production_company_id'] = df['parsed_prod_companies_for_id'].apply(lambda x: x[0]['id'] if x else -1) # Using -1 for missing company\\ndel df['parsed_prod_companies_for_id']\\n\\n# (Feature: director_id - The ID of the first listed director, or a placeholder)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher'}]\\\", nan, \\\"[...]\\\"]\\ndf['parsed_crew_for_director'] = df['crew'].apply(safe_literal_eval)\\ndf['director_id'] = df['parsed_crew_for_director'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Director'), -1)) # Using -1 for missing director\\n\\n# (Feature: producer_id - The ID of the first listed producer, or a placeholder)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 1254, 'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'credit_id': '...', 'department': 'Production', 'gender': 1, 'id': 1899, 'job': 'Producer', 'name': 'Denise Di Novi'}]\\\", nan]\\ndf['producer_id'] = df['parsed_crew_for_director'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Producer'), -1)) # Reusing parsed_crew_for_director for efficiency\\ndel df['parsed_crew_for_director']\\n\\n# (Feature: has_spoken_language_fr - Binary indicator if French is among spoken languages)\\n# (Feature: has_spoken_language_de - Binary indicator if German is among spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'de', 'name': 'Deutsch'}]\\\"]\\ndf['parsed_spoken_languages_for_flags'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['has_spoken_language_fr'] = df['parsed_spoken_languages_for_flags'].apply(lambda x: 1 if any(lang.get('iso_639_1') == 'fr' for lang in x) else 0)\\ndf['has_spoken_language_de'] = df['parsed_spoken_languages_for_flags'].apply(lambda x: 1 if any(lang.get('iso_639_1') == 'de' for lang in x) else 0)\\ndel df['parsed_spoken_languages_for_flags']\\n\\n# (Feature: num_top_10_cast - Count of cast members explicitly listed in the top 10 positions)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}, ...]', '[]', 'nan']\\ndf['parsed_cast_for_top_10'] = df['cast'].apply(safe_literal_eval)\\ndf['num_top_10_cast'] = df['parsed_cast_for_top_10'].apply(lambda x: sum(1 for c in x if c.get('order') is not None and c['order'] < 10))\\ndel df['parsed_cast_for_top_10']\\n\\n# (Feature: collection_id - The ID of the collection if the movie belongs to one)\\n# Input samples: 'belongs_to_collection': [nan, \\\"[{'id': 119, 'name': 'The Lord of the Rings Collection', ...}]\\\", nan]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['id'] if x else -1) # Use -1 for no collection\\ndel df['parsed_belongs_to_collection']\\n\\n# (Feature: is_original_title_exact_match - Binary indicator if original_title and title are exactly the same)\\n# Input samples: 'original_title': ['Fight Club', 'Illegal', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Illegal', 'Shaun the Sheep Movie']\\ndf['is_original_title_exact_match'] = (df['original_title'] == df['title']).astype(int)\\n\\n# (Feature: popularity_by_budget - Ratio of popularity to budget, handling zero budget to avoid infinity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\ndf['popularity_by_budget'] = df.apply(lambda row: row['popularity'] / row['budget'] if row['budget'] > 0 else 0, axis=1)\\n\\n# (Feature: revenue_predictor_feature - a conceptual feature for example - e.g. popularity * budget)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\n# Using budget_per_popularity might be another option too\\ndf['budget_x_popularity'] = df['budget'] * df['popularity']\"]}, \"score\": -2.2306033391825895, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_zero_budget - Binary indicator if the budget is zero, often signifying missing data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n# (Feature: release_decade - The decade in which the movie was released)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: main_genre_id - The ID of the first listed genre, or a placeholder if no genres)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", nan]\\ndf['parsed_genres_for_id'] = df['genres'].apply(safe_literal_eval)\\ndf['main_genre_id'] = df['parsed_genres_for_id'].apply(lambda x: x[0]['id'] if x else -1) # Using -1 for missing genre\\ndel df['parsed_genres_for_id']\\n\\n# (Feature: main_production_company_id - The ID of the first listed production company, or a placeholder)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", nan, \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['parsed_prod_companies_for_id'] = df['production_companies'].apply(safe_literal_eval)\\ndf['main_production_company_id'] = df['parsed_prod_companies_for_id'].apply(lambda x: x[0]['id'] if x else -1) # Using -1 for missing company\\ndel df['parsed_prod_companies_for_id']\\n\\n# (Feature: director_id - The ID of the first listed director, or a placeholder)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher'}]\\\", nan, \\\"[...]\\\"]\\ndf['parsed_crew_for_director'] = df['crew'].apply(safe_literal_eval)\\ndf['director_id'] = df['parsed_crew_for_director'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Director'), -1)) # Using -1 for missing director\\n\\n# (Feature: producer_id - The ID of the first listed producer, or a placeholder)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 1254, 'job': 'Producer', 'name': 'Art Linson'}]\\\", \\\"[{'credit_id': '...', 'department': 'Production', 'gender': 1, 'id': 1899, 'job': 'Producer', 'name': 'Denise Di Novi'}]\\\", nan]\\ndf['producer_id'] = df['parsed_crew_for_director'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Producer'), -1)) # Reusing parsed_crew_for_director for efficiency\\ndel df['parsed_crew_for_director']\\n\\n# (Feature: has_spoken_language_fr - Binary indicator if French is among spoken languages)\\n# (Feature: has_spoken_language_de - Binary indicator if German is among spoken languages)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\", \\\"[{'iso_639_1': 'de', 'name': 'Deutsch'}]\\\"]\\ndf['parsed_spoken_languages_for_flags'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['has_spoken_language_fr'] = df['parsed_spoken_languages_for_flags'].apply(lambda x: 1 if any(lang.get('iso_639_1') == 'fr' for lang in x) else 0)\\ndf['has_spoken_language_de'] = df['parsed_spoken_languages_for_flags'].apply(lambda x: 1 if any(lang.get('iso_639_1') == 'de' for lang in x) else 0)\\ndel df['parsed_spoken_languages_for_flags']\\n\\n# (Feature: num_top_10_cast - Count of cast members explicitly listed in the top 10 positions)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}, ...]', '[]', 'nan']\\ndf['parsed_cast_for_top_10'] = df['cast'].apply(safe_literal_eval)\\ndf['num_top_10_cast'] = df['parsed_cast_for_top_10'].apply(lambda x: sum(1 for c in x if c.get('order') is not None and c['order'] < 10))\\ndel df['parsed_cast_for_top_10']\\n\\n# (Feature: collection_id - The ID of the collection if the movie belongs to one)\\n# Input samples: 'belongs_to_collection': [nan, \\\"[{'id': 119, 'name': 'The Lord of the Rings Collection', ...}]\\\", nan]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['id'] if x else -1) # Use -1 for no collection\\ndel df['parsed_belongs_to_collection']\\n\\n# (Feature: is_original_title_exact_match - Binary indicator if original_title and title are exactly the same)\\n# Input samples: 'original_title': ['Fight Club', 'Illegal', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Illegal', 'Shaun the Sheep Movie']\\ndf['is_original_title_exact_match'] = (df['original_title'] == df['title']).astype(int)\\n\\n# (Feature: popularity_by_budget - Ratio of popularity to budget, handling zero budget to avoid infinity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\ndf['popularity_by_budget'] = df.apply(lambda row: row['popularity'] / row['budget'] if row['budget'] > 0 else 0, axis=1)\\n\\n# (Feature: revenue_predictor_feature - a conceptual feature for example - e.g. popularity * budget)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [63000000, 12000000, 0]\\n# Using budget_per_popularity might be another option too\\ndf['budget_x_popularity'] = df['budget'] * df['popularity']\"}, {\"search_node\": {\"trial\": 12, \"parent_trial\": 8, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}], \"predefined_state\": null, \"parent_score\": -2.1878916554583694, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\"]}, \"score\": -2.1611170271190994, \"memory_update\": \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\"}, {\"search_node\": {\"trial\": 13, \"parent_trial\": 1, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}], \"predefined_state\": null, \"parent_score\": -2.194834450371649, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_homepage - Binary indicator if a homepage is provided)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: tagline_length - Length of the movie's tagline, defaults to 0 if NaN)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_length'] = df['tagline'].fillna('').apply(len)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview, defaults to 0 if NaN)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].fillna('').apply(lambda x: len(x.split()))\\n\\n# (Feature: release_day - Day of the month the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: release_weekofyear - Week of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime, handles zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: avg_words_in_title - Average number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['avg_words_in_title'] = df['original_title'].apply(lambda x: len(x.split()))\\n\\n# (Feature: original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# Re-parse production companies safely to ensure no issues with prior usage.\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\n\\n# (Feature: production_has_Universal_Pictures - Binary for 'Universal Pictures')\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[{'name': 'Universal Pictures', 'id': 33}]\\\"]\\ndf['production_has_Universal_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Universal Pictures' for comp in x) else 0)\\n\\n# (Feature: production_has_Columbia_Pictures - Binary for 'Columbia Pictures')\\n# Input samples: 'production_companies': [\\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_has_Columbia_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Columbia Pictures' for comp in x) else 0)\\n\\n# (Feature: production_has_New_Line_Cinema - Binary for 'New Line Cinema')\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'New Line Cinema', 'id': 12}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_has_New_Line_Cinema'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'New Line Cinema' for comp in x) else 0)\\n\\n# (Feature: production_has_Warner_Bros_Pictures - Binary for 'Warner Bros.' or similar name)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Warner Bros. Pictures', 'id': 174}]\\\"]\\ndf['production_has_Warner_Bros_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any('Warner Bros' in comp.get('name', '') for comp in x) else 0)\\ndel df['parsed_production_companies']\\n\\n\\n# Re-parse crew safely to ensure no issues with prior usage.\\ndf['parsed_crew_current'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: director_is_Peter_Jackson - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_Peter_Jackson'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Peter Jackson' for c in x) else 0)\\n\\n# (Feature: director_is_David_Fincher - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_David_Fincher'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\\n# (Feature: director_is_Ron_Howard - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_Ron_Howard'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Ron Howard' for c in x) else 0)\\ndel df['parsed_crew_current']\\n\\n# Re-parse cast safely to ensure no issues with prior usage.\\ndf['parsed_cast_current'] = df['cast'].apply(safe_literal_eval)\\n\\n# (Feature: has_top_cast_member_brad_pitt - Binary flag if Brad Pitt is in the cast)\\n# Input samples: 'cast': ['[{\\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]', '[{\\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0}]', '[{\\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['has_top_cast_member_brad_pitt'] = df['parsed_cast_current'].apply(lambda x: 1 if any(c.get('name') == 'Brad Pitt' for c in x) else 0)\\n\\n# (Feature: has_top_cast_member_elijah_wood - Binary flag if Elijah Wood is in the cast)\\n# Input samples: 'cast': ['[{\\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]', '[{\\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0}]', '[{\\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['has_top_cast_member_elijah_wood'] = df['parsed_cast_current'].apply(lambda x: 1 if any(c.get('name') == 'Elijah Wood' for c in x) else 0)\\ndel df['parsed_cast_current']\"]}, \"score\": -2.2147996758836404, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: has_homepage - Binary indicator if a homepage is provided)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: tagline_length - Length of the movie's tagline, defaults to 0 if NaN)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_length'] = df['tagline'].fillna('').apply(len)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview, defaults to 0 if NaN)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].fillna('').apply(lambda x: len(x.split()))\\n\\n# (Feature: release_day - Day of the month the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: release_weekofyear - Week of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime, handles zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: avg_words_in_title - Average number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['avg_words_in_title'] = df['original_title'].apply(lambda x: len(x.split()))\\n\\n# (Feature: original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# Re-parse production companies safely to ensure no issues with prior usage.\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\n\\n# (Feature: production_has_Universal_Pictures - Binary for 'Universal Pictures')\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[{'name': 'Universal Pictures', 'id': 33}]\\\"]\\ndf['production_has_Universal_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Universal Pictures' for comp in x) else 0)\\n\\n# (Feature: production_has_Columbia_Pictures - Binary for 'Columbia Pictures')\\n# Input samples: 'production_companies': [\\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_has_Columbia_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Columbia Pictures' for comp in x) else 0)\\n\\n# (Feature: production_has_New_Line_Cinema - Binary for 'New Line Cinema')\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'New Line Cinema', 'id': 12}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}]\\\"]\\ndf['production_has_New_Line_Cinema'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'New Line Cinema' for comp in x) else 0)\\n\\n# (Feature: production_has_Warner_Bros_Pictures - Binary for 'Warner Bros.' or similar name)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Warner Bros. Pictures', 'id': 174}]\\\"]\\ndf['production_has_Warner_Bros_Pictures'] = df['parsed_production_companies'].apply(lambda x: 1 if any('Warner Bros' in comp.get('name', '') for comp in x) else 0)\\ndel df['parsed_production_companies']\\n\\n\\n# Re-parse crew safely to ensure no issues with prior usage.\\ndf['parsed_crew_current'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: director_is_Peter_Jackson - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_Peter_Jackson'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Peter Jackson' for c in x) else 0)\\n\\n# (Feature: director_is_David_Fincher - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_David_Fincher'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\\n# (Feature: director_is_Ron_Howard - Binary for specific prominent director)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{'job': 'Director', 'name': 'Ron Howard'}]\\\"]\\ndf['director_is_Ron_Howard'] = df['parsed_crew_current'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Ron Howard' for c in x) else 0)\\ndel df['parsed_crew_current']\\n\\n# Re-parse cast safely to ensure no issues with prior usage.\\ndf['parsed_cast_current'] = df['cast'].apply(safe_literal_eval)\\n\\n# (Feature: has_top_cast_member_brad_pitt - Binary flag if Brad Pitt is in the cast)\\n# Input samples: 'cast': ['[{\\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]', '[{\\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0}]', '[{\\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['has_top_cast_member_brad_pitt'] = df['parsed_cast_current'].apply(lambda x: 1 if any(c.get('name') == 'Brad Pitt' for c in x) else 0)\\n\\n# (Feature: has_top_cast_member_elijah_wood - Binary flag if Elijah Wood is in the cast)\\n# Input samples: 'cast': ['[{\\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1}]', '[{\\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0}]', '[{\\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['has_top_cast_member_elijah_wood'] = df['parsed_cast_current'].apply(lambda x: 1 if any(c.get('name') == 'Elijah Wood' for c in x) else 0)\\ndel df['parsed_cast_current']\"}, {\"search_node\": {\"trial\": 14, \"parent_trial\": 10, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"score\": -2.1807121926184094}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"score\": -2.175872692501712}], \"predefined_state\": null, \"parent_score\": -2.175872692501712, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\nimport re\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_decade - The decade of the movie's release)\\n# Input samples: 'release_year': [1999.0, 2017.0, 1984.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: has_disney_production - Binary indicator if Disney or related companies produced the movie)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Walt Disney Pictures', 'id': 2}]\\\"]\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval)\\ndf['has_disney_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('Disney' in comp['name'] or 'Pixar' in comp['name'] or 'Marvel Studios' in comp['name'] or 'Lucasfilm' in comp['name'] for comp in x) else 0)\\n\\n# (Feature: has_paramount_production - Binary indicator if Paramount Pictures produced the movie)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Paramount Pictures', 'id': 4}]\\\", \\\"[{'name': 'Walt Disney Pictures', 'id': 2}]\\\"]\\ndf['has_paramount_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('Paramount Pictures' == comp['name'] for comp in x) else 0)\\n\\n# (Feature: has_newline_cinema_production - Binary indicator if New Line Cinema produced the movie)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'New Line Cinema', 'id': 12}]\\\", \\\"[...]\\\"]\\ndf['has_newline_cinema_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('New Line Cinema' == comp['name'] for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: title_has_numbers - Binary indicator if the movie title contains numbers)\\n# Input samples: 'title': ['Fight Club', 'The Best Movie 3-DE', 'The Lord of the Rings: The Two Towers']\\ndf['title_has_numbers'] = df['title'].apply(lambda x: 1 if re.search(r'\\\\d', str(x)) else 0)\\n\\n# (Feature: original_title_is_english - Binary indicator if the original title is solely composed of basic Latin alphabet characters)\\n# Input samples: 'original_title': ['Fight Club', 'Samyy Luchshiy Film 3-DE', 'Ill\\u00e9gal']\\ndf['original_title_is_english'] = df['original_title'].apply(lambda x: 1 if re.match(r'^[A-Za-z0-9\\\\s.,\\\\':;&-]+$', str(x)) else 0)\\n\\n# (Feature: log_popularity - Log transform of popularity, to potentially normalize its distribution)\\n# Input samples: 'popularity': [63.87, 10.16, 0.88]\\ndf['log_popularity'] = np.log1p(df['popularity'])\\n\\n# (Feature: log_budget_per_runtime - Ratio of log budget to log runtime, combining investment and duration aspects)\\n# Input samples: 'log_budget': [17.957, 16.299, 0.0], 'log_runtime': [4.942, 4.615, 4.454]\\ndf['log_budget_per_runtime'] = df.apply(lambda row: row['log_budget'] / (row['log_runtime'] + 1e-6) if row['log_runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_per_num_genres - Popularity divided by the number of genres, showing 'focused' popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 0.88], 'num_genres': [1, 2, 4]\\ndf['popularity_per_num_genres'] = df.apply(lambda row: row['popularity'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: num_crew_top_jobs - Count of unique individuals holding 'Director of Photography', 'Original Music Composer', 'Editor', 'Production Design', 'Costume Design' jobs)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a23', 'job': 'Director of Photography', 'name': 'Jeff Cronenweth'}, {'credit_id': '52fe4250c3a36847f8014a17', 'job': 'Original Music Composer', 'name': 'John King'}]\\\", \\\"...\\\", \\\"...\\\"]\\ndf['parsed_crew_temp'] = df['crew'].apply(safe_literal_eval)\\ntop_jobs = ['Director of Photography', 'Original Music Composer', 'Editor', 'Production Design', 'Costume Design', 'Director', 'Screenplay']\\ndf['num_crew_top_jobs'] = df['parsed_crew_temp'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in top_jobs)))\\n\\n# (Feature: runtime_x_popularity - Interaction between runtime and popularity)\\n# Input samples: 'runtime': [139, 100, 85], 'popularity': [63.87, 10.16, 9.96]\\ndf['runtime_x_popularity'] = df['runtime'] * df['popularity']\\n\\n# (Feature: budget_x_popularity - Interaction between budget and popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_x_popularity'] = df['budget'] * df['popularity']\\n\\n# Cleanup temp columns\\ndel df['parsed_crew_temp']\"]}, \"score\": -2.214163351673201, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\nimport re\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_decade - The decade of the movie's release)\\n# Input samples: 'release_year': [1999.0, 2017.0, 1984.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: has_disney_production - Binary indicator if Disney or related companies produced the movie)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Walt Disney Pictures', 'id': 2}]\\\"]\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval)\\ndf['has_disney_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('Disney' in comp['name'] or 'Pixar' in comp['name'] or 'Marvel Studios' in comp['name'] or 'Lucasfilm' in comp['name'] for comp in x) else 0)\\n\\n# (Feature: has_paramount_production - Binary indicator if Paramount Pictures produced the movie)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}]\\\", \\\"[{'name': 'Paramount Pictures', 'id': 4}]\\\", \\\"[{'name': 'Walt Disney Pictures', 'id': 2}]\\\"]\\ndf['has_paramount_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('Paramount Pictures' == comp['name'] for comp in x) else 0)\\n\\n# (Feature: has_newline_cinema_production - Binary indicator if New Line Cinema produced the movie)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'New Line Cinema', 'id': 12}]\\\", \\\"[...]\\\"]\\ndf['has_newline_cinema_production'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any('New Line Cinema' == comp['name'] for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: title_has_numbers - Binary indicator if the movie title contains numbers)\\n# Input samples: 'title': ['Fight Club', 'The Best Movie 3-DE', 'The Lord of the Rings: The Two Towers']\\ndf['title_has_numbers'] = df['title'].apply(lambda x: 1 if re.search(r'\\\\d', str(x)) else 0)\\n\\n# (Feature: original_title_is_english - Binary indicator if the original title is solely composed of basic Latin alphabet characters)\\n# Input samples: 'original_title': ['Fight Club', 'Samyy Luchshiy Film 3-DE', 'Ill\\u00e9gal']\\ndf['original_title_is_english'] = df['original_title'].apply(lambda x: 1 if re.match(r'^[A-Za-z0-9\\\\s.,\\\\':;&-]+$', str(x)) else 0)\\n\\n# (Feature: log_popularity - Log transform of popularity, to potentially normalize its distribution)\\n# Input samples: 'popularity': [63.87, 10.16, 0.88]\\ndf['log_popularity'] = np.log1p(df['popularity'])\\n\\n# (Feature: log_budget_per_runtime - Ratio of log budget to log runtime, combining investment and duration aspects)\\n# Input samples: 'log_budget': [17.957, 16.299, 0.0], 'log_runtime': [4.942, 4.615, 4.454]\\ndf['log_budget_per_runtime'] = df.apply(lambda row: row['log_budget'] / (row['log_runtime'] + 1e-6) if row['log_runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_per_num_genres - Popularity divided by the number of genres, showing 'focused' popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 0.88], 'num_genres': [1, 2, 4]\\ndf['popularity_per_num_genres'] = df.apply(lambda row: row['popularity'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: num_crew_top_jobs - Count of unique individuals holding 'Director of Photography', 'Original Music Composer', 'Editor', 'Production Design', 'Costume Design' jobs)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a23', 'job': 'Director of Photography', 'name': 'Jeff Cronenweth'}, {'credit_id': '52fe4250c3a36847f8014a17', 'job': 'Original Music Composer', 'name': 'John King'}]\\\", \\\"...\\\", \\\"...\\\"]\\ndf['parsed_crew_temp'] = df['crew'].apply(safe_literal_eval)\\ntop_jobs = ['Director of Photography', 'Original Music Composer', 'Editor', 'Production Design', 'Costume Design', 'Director', 'Screenplay']\\ndf['num_crew_top_jobs'] = df['parsed_crew_temp'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in top_jobs)))\\n\\n# (Feature: runtime_x_popularity - Interaction between runtime and popularity)\\n# Input samples: 'runtime': [139, 100, 85], 'popularity': [63.87, 10.16, 9.96]\\ndf['runtime_x_popularity'] = df['runtime'] * df['popularity']\\n\\n# (Feature: budget_x_popularity - Interaction between budget and popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_x_popularity'] = df['budget'] * df['popularity']\\n\\n# Cleanup temp columns\\ndel df['parsed_crew_temp']\"}, {\"search_node\": {\"trial\": 15, \"parent_trial\": 1, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}], \"predefined_state\": null, \"parent_score\": -2.194834450371649, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport json\\nimport ast\\n\\n# (Helper function for safe literal_eval - repeated for clarity, assume previous blocks run)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: homepage_exists - Binary indicator if a homepage is available)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_exists'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 0 else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].fillna('').apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].fillna('').apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['popularity_to_runtime_ratio'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Re-parsing genres for robustness in case it was dropped in a previous block or run standalone)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\n# Check if 'parsed_genres' exists, if not, create it\\nif 'parsed_genres' not in df.columns:\\n    df['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['genre_is_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if any(g.get('id') == 12 for g in x) else 0)\\n\\n\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Animation'] = df['parsed_genres'].apply(lambda x: 1 if any(g.get('id') == 16 for g in x) else 0)\\n\\n# (Feature: budget_squared - Square of the budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_squared'] = df['budget'] ** 2\\n\\n# (Feature: popularity_budget_product - Product of popularity and budget)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['popularity_budget_product'] = df['popularity'] * df['budget']\\n\\n# (Feature: collection_name_length - Length of the collection name if exists, else 0)\\n# Input samples: 'belongs_to_collection': [\\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan, \\\"[{'id': 119, 'name': 'The Lord of the Rings Collection', 'poster_path': '/p4UokEk2XnjjRTdXGe6DLYXlbI1.jpg', 'backdrop_path': '/bccR2CGTWVVSZAG0yqmy3DIvhTX.jpg'}]\\\"]\\n# Fix: Use safe_literal_eval for parsing, as json.loads fails with single quotes.\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name_length'] = df['parsed_belongs_to_collection'].apply(\\n    lambda x: len(x[0]['name']) if x and isinstance(x[0], dict) and x[0].get('name') else 0\\n)\\ndel df['parsed_belongs_to_collection']\\n\\n\\n# (Feature: original_title_length - Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: title_length - Length of the movie title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: diff_title_original_title_length - Difference in length between title and original_title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_title_original_title_length'] = df['title_length'] - df['original_title_length']\\n\\n# (Feature: overview_sentiment - Basic sentiment score from overview using word lists)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\npositive_words = set(['fun', 'adventure', 'best', 'happy', 'success', 'love', 'charming', 'joy', 'heroic', 'win', 'action'])\\nnegative_words = set(['dilemma', 'fight', 'terror', 'thriller', 'mystery', 'drama', 'crime', 'unforgettable', 'haunting', 'attack', 'dead', 'loss'])\\ndf['overview_sentiment'] = df['overview'].fillna('').apply(\\n    lambda x: sum(1 for word in str(x).lower().split() if word in positive_words) -\\n              sum(1 for word in str(x).lower().split() if word in negative_words)\\n)\\n\\n# (Feature: runtime_cubed - Cube of the runtime for non-linear relationships)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_cubed'] = df['runtime'] ** 3\\n\\n# (Feature: day_of_year - Day of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day_of_year'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: week_of_year - Week of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_week_of_year'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: quarter - Quarter of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# Clean up parsed_genres now, assuming it's not needed in further blocks in this submission,\\n# but it was implicitly retained in the last valid step if not explicitly deleted before.\\n# Since new blocks generate their own context, this ensures cleanliness.\\nif 'parsed_genres' in df.columns:\\n    df = df.drop(columns=['parsed_genres'])\"]}, \"score\": -2.2253703029139507, \"memory_update\": \"import numpy as np\\nimport json\\nimport ast\\n\\n# (Helper function for safe literal_eval - repeated for clarity, assume previous blocks run)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: homepage_exists - Binary indicator if a homepage is available)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_exists'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 0 else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].fillna('').apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].fillna('').apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: budget_runtime_ratio - Ratio of budget to runtime)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['budget_runtime_ratio'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['popularity_to_runtime_ratio'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Re-parsing genres for robustness in case it was dropped in a previous block or run standalone)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\n# Check if 'parsed_genres' exists, if not, create it\\nif 'parsed_genres' not in df.columns:\\n    df['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['genre_is_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if any(g.get('id') == 12 for g in x) else 0)\\n\\n\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Animation'] = df['parsed_genres'].apply(lambda x: 1 if any(g.get('id') == 16 for g in x) else 0)\\n\\n# (Feature: budget_squared - Square of the budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_squared'] = df['budget'] ** 2\\n\\n# (Feature: popularity_budget_product - Product of popularity and budget)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['popularity_budget_product'] = df['popularity'] * df['budget']\\n\\n# (Feature: collection_name_length - Length of the collection name if exists, else 0)\\n# Input samples: 'belongs_to_collection': [\\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan, \\\"[{'id': 119, 'name': 'The Lord of the Rings Collection', 'poster_path': '/p4UokEk2XnjjRTdXGe6DLYXlbI1.jpg', 'backdrop_path': '/bccR2CGTWVVSZAG0yqmy3DIvhTX.jpg'}]\\\"]\\n# Fix: Use safe_literal_eval for parsing, as json.loads fails with single quotes.\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name_length'] = df['parsed_belongs_to_collection'].apply(\\n    lambda x: len(x[0]['name']) if x and isinstance(x[0], dict) and x[0].get('name') else 0\\n)\\ndel df['parsed_belongs_to_collection']\\n\\n\\n# (Feature: original_title_length - Length of the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: title_length - Length of the movie title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)))\\n\\n# (Feature: diff_title_original_title_length - Difference in length between title and original_title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_title_original_title_length'] = df['title_length'] - df['original_title_length']\\n\\n# (Feature: overview_sentiment - Basic sentiment score from overview using word lists)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\npositive_words = set(['fun', 'adventure', 'best', 'happy', 'success', 'love', 'charming', 'joy', 'heroic', 'win', 'action'])\\nnegative_words = set(['dilemma', 'fight', 'terror', 'thriller', 'mystery', 'drama', 'crime', 'unforgettable', 'haunting', 'attack', 'dead', 'loss'])\\ndf['overview_sentiment'] = df['overview'].fillna('').apply(\\n    lambda x: sum(1 for word in str(x).lower().split() if word in positive_words) -\\n              sum(1 for word in str(x).lower().split() if word in negative_words)\\n)\\n\\n# (Feature: runtime_cubed - Cube of the runtime for non-linear relationships)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_cubed'] = df['runtime'] ** 3\\n\\n# (Feature: day_of_year - Day of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day_of_year'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: week_of_year - Week of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_week_of_year'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: quarter - Quarter of the year for release_date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# Clean up parsed_genres now, assuming it's not needed in further blocks in this submission,\\n# but it was implicitly retained in the last valid step if not explicitly deleted before.\\n# Since new blocks generate their own context, this ensures cleanliness.\\nif 'parsed_genres' in df.columns:\\n    df = df.drop(columns=['parsed_genres'])\"}, {\"search_node\": {\"trial\": 16, \"parent_trial\": 10, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"score\": -2.1807121926184094}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"score\": -2.175872692501712}], \"predefined_state\": null, \"parent_score\": -2.175872692501712, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: release_month_sin - Sin transformation of release_month for cyclical nature)\\n# (Feature: release_month_cos - Cos transformation of release_month for cyclical nature)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sin transformation of release_dayofweek for cyclical nature)\\n# (Feature: release_dayofweek_cos - Cos transformation of release_dayofweek for cyclical nature)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: log_budget - Log transformation of budget to handle skewed data)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['log_budget'] = np.log1p(df['budget'])\\n\\n# (Feature: log_runtime - Log transformation of runtime to handle skewed data)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = np.log1p(df['runtime'])\\n\\n# (Feature: status_Released - Binary indicator for movie status being 'Released')\\n# Input samples: 'status': ['Released', 'Released', 'Released']\\ndf['status_Released'] = df['status'].apply(lambda x: 1 if x == 'Released' else 0)\\n\\n# (Feature: num_top_production_countries - Number of production countries if in top N countries by movies produced.)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ntop_countries = ['US', 'GB', 'FR', 'DE', 'CA', 'IN', 'AU', 'IT', 'ES', 'JP'] # Example top N countries\\ndf['num_top_production_countries'] = df['parsed_production_countries'].apply(lambda x: sum(1 for c in x if c['iso_3166_1'] in top_countries))\\ndel df['parsed_production_countries']\\n\\n# (Feature: num_spoken_top_languages - Number of spoken languages if in top N languages used.)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\n# Need to parse it again in case a previous block deleted it\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ntop_languages = ['en', 'fr', 'es', 'de', 'it', 'ru', 'zh', 'hi', 'ja', 'ko'] # Example top N languages\\ndf['num_spoken_top_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for l in x if l['iso_639_1'] in top_languages))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: avg_crew_gender - Average gender of crew members (2 for male, 1 for female, 0 for unknown). Average across `id` rather than directly `gender` is problematic.)\\n# (Feature: num_male_crew - Number of male crew members)\\n# (Feature: num_female_crew - Number of female crew members)\\n# Input samples: 'crew': [\\\"[{'credit_id': '...', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '...'}]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_male_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_crew'] = df['parsed_crew'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: collection_name - Name of the collection the movie belongs to, or 'No Collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\"]\\ndf['parsed_belongs_to_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_name'] = df['parsed_belongs_to_collection'].apply(lambda x: x[0]['name'] if x else 'No Collection')\\n\\n# (Feature: overview_to_tagline_word_ratio - Ratio of word counts between overview and tagline)\\n# Input samples: 'overview_word_count': [45, 12, 16], 'tagline_word_count': [4, 0, 7]\\ndf['overview_to_tagline_word_ratio'] = df.apply(lambda row: row['overview_word_count'] / (row['tagline_word_count'] + 1e-6) if row['tagline_word_count'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of budget to popularity)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'popularity': [63.87, 10.16, 9.96]\\ndf['budget_to_popularity_ratio'] = df.apply(lambda row: row['budget'] / (row['popularity'] + 1e-6) if row['popularity'] > 0 else 0, axis=1)\\n\\n# (Feature: genre_is_Drama_or_Thriller - Combined binary for Drama or Thriller genres)\\n# Input samples: 'genre_is_Drama': [1, 1, 0], 'genre_is_Thriller': [0, 1, 0]\\ndf['genre_is_Drama_or_Thriller'] = df.apply(lambda row: 1 if (row['genre_is_Drama'] == 1 or row['genre_is_Thriller'] == 1) else 0, axis=1)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# Cleanup of temp columns\\ndel df['parsed_crew']\\ndel df['parsed_belongs_to_collection']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: is_english_title_original_title_same - Binary indicator if title and original_title are identical (ignoring case and whitespace))\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_english_title_original_title_same'] = df.apply(lambda row: 1 if str(row['original_title']).strip().lower() == str(row['title']).strip().lower() else 0, axis=1)\\n\\n# (Feature: runtime_over_average_runtime - Ratio of movie runtime to average runtime across the dataset)\\n# Input samples: 'runtime': [139, 100, 85]\\naverage_runtime = df['runtime'].mean()\\ndf['runtime_over_average_runtime'] = df['runtime'] / average_runtime\\n\\n# (Feature: budget_per_genre - Average budget per genre assigned to the movie)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'num_genres': [1, 2, 4]\\ndf['budget_per_genre'] = df.apply(lambda row: row['budget'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_per_genre - Average popularity per genre assigned to the movie)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'num_genres': [1, 2, 4]\\ndf['popularity_per_genre'] = df.apply(lambda row: row['popularity'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: has_multiple_top_genres - Binary indicator if a movie has more than 1 genre from a list of predefined top genres)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}, {'id': 878, 'name': 'Science Fiction'}]\\\"]\\n# Predefined list of popular genres (top N by count or general blockbuster relevance)\\npopular_genre_ids = {12, 28, 35, 878, 53, 10751, 16, 18, 14} # Adventure, Action, Comedy, Science Fiction, Thriller, Family, Animation, Drama, Fantasy\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval) # Ensure parsed_genres exists for this step\\ndf['num_popular_genres'] = df['parsed_genres'].apply(lambda x: sum(1 for g in x if g.get('id') in popular_genre_ids))\\ndf['has_multiple_top_genres'] = (df['num_popular_genres'] > 1).astype(int)\\ndel df['parsed_genres']\\n\\n# (Feature: is_summer_release - Binary indicator if the movie was released during summer months (June, July, August))\\n# Input samples: 'release_month': [10.0, 7.0, 2.0]\\ndf['is_summer_release'] = df['release_month'].apply(lambda x: 1 if x in [6, 7, 8] else 0)\\n\\n# (Feature: is_holiday_season_release - Binary indicator if the movie was released during holiday season (November, December))\\n# Input samples: 'release_month': [10.0, 12.0, 11.0]\\ndf['is_holiday_season_release'] = df['release_month'].apply(lambda x: 1 if x in [11, 12] else 0)\\n\\n# (Feature: num_non_english_spoken_languages - Count of spoken languages that are not English)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval) # Ensure parsed_spoken_languages exists for this step\\ndf['num_non_english_spoken_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for lang in x if lang.get('iso_639_1') != 'en'))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: collection_has_keyword_series - Binary indicator if 'collection_name' contains 'Series' (case-insensitive))\\n# Input samples: 'collection_name': ['No Collection', 'Harry Potter Series', 'The Best Movie Collection']\\ndf['collection_has_keyword_series'] = df['collection_name'].apply(lambda x: 1 if isinstance(x, str) and 'series' in x.lower() else 0)\\n\\n# (Feature: collection_has_keyword_trilogy - Binary indicator if 'collection_name' contains 'Trilogy' (case-insensitive))\\n# Input samples: 'collection_name': ['No Collection', 'Lord of the Rings Trilogy', 'The Best Movie Collection']\\ndf['collection_has_keyword_trilogy'] = df['collection_name'].apply(lambda x: 1 if isinstance(x, str) and 'trilogy' in x.lower() else 0)\\n\\n# (Feature: log_popularity - Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['log_popularity'] = np.log1p(df['popularity'])\\n\\n# (Feature: runtime_imputed_to_0 - Binary indicator if runtime was originally 0 (often indicating missing data))\\n# Input samples: 'runtime': [139, 100, 85, 0]\\ndf['runtime_is_zero'] = (df['runtime'] == 0).astype(int)\\n\\n# (Feature: budget_imputed_to_0 - Binary indicator if budget was originally 0 (often indicating missing data))\\n# Input samples: 'budget': [63000000, 12000000, 0, 6500000]\\ndf['budget_is_zero'] = (df['budget'] == 0).astype(int)\"]}, \"score\": -2.222449585282253, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: is_english_title_original_title_same - Binary indicator if title and original_title are identical (ignoring case and whitespace))\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_english_title_original_title_same'] = df.apply(lambda row: 1 if str(row['original_title']).strip().lower() == str(row['title']).strip().lower() else 0, axis=1)\\n\\n# (Feature: runtime_over_average_runtime - Ratio of movie runtime to average runtime across the dataset)\\n# Input samples: 'runtime': [139, 100, 85]\\naverage_runtime = df['runtime'].mean()\\ndf['runtime_over_average_runtime'] = df['runtime'] / average_runtime\\n\\n# (Feature: budget_per_genre - Average budget per genre assigned to the movie)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'num_genres': [1, 2, 4]\\ndf['budget_per_genre'] = df.apply(lambda row: row['budget'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: popularity_per_genre - Average popularity per genre assigned to the movie)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'num_genres': [1, 2, 4]\\ndf['popularity_per_genre'] = df.apply(lambda row: row['popularity'] / (row['num_genres'] + 1e-6) if row['num_genres'] > 0 else 0, axis=1)\\n\\n# (Feature: has_multiple_top_genres - Binary indicator if a movie has more than 1 genre from a list of predefined top genres)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 28, 'name': 'Action'}, {'id': 12, 'name': 'Adventure'}, {'id': 878, 'name': 'Science Fiction'}]\\\"]\\n# Predefined list of popular genres (top N by count or general blockbuster relevance)\\npopular_genre_ids = {12, 28, 35, 878, 53, 10751, 16, 18, 14} # Adventure, Action, Comedy, Science Fiction, Thriller, Family, Animation, Drama, Fantasy\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval) # Ensure parsed_genres exists for this step\\ndf['num_popular_genres'] = df['parsed_genres'].apply(lambda x: sum(1 for g in x if g.get('id') in popular_genre_ids))\\ndf['has_multiple_top_genres'] = (df['num_popular_genres'] > 1).astype(int)\\ndel df['parsed_genres']\\n\\n# (Feature: is_summer_release - Binary indicator if the movie was released during summer months (June, July, August))\\n# Input samples: 'release_month': [10.0, 7.0, 2.0]\\ndf['is_summer_release'] = df['release_month'].apply(lambda x: 1 if x in [6, 7, 8] else 0)\\n\\n# (Feature: is_holiday_season_release - Binary indicator if the movie was released during holiday season (November, December))\\n# Input samples: 'release_month': [10.0, 12.0, 11.0]\\ndf['is_holiday_season_release'] = df['release_month'].apply(lambda x: 1 if x in [11, 12] else 0)\\n\\n# (Feature: num_non_english_spoken_languages - Count of spoken languages that are not English)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'ru', 'name': 'P\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439'}, {'iso_639_1': 'fr', 'name': 'Fran\\u00e7ais'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval) # Ensure parsed_spoken_languages exists for this step\\ndf['num_non_english_spoken_languages'] = df['parsed_spoken_languages'].apply(lambda x: sum(1 for lang in x if lang.get('iso_639_1') != 'en'))\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: collection_has_keyword_series - Binary indicator if 'collection_name' contains 'Series' (case-insensitive))\\n# Input samples: 'collection_name': ['No Collection', 'Harry Potter Series', 'The Best Movie Collection']\\ndf['collection_has_keyword_series'] = df['collection_name'].apply(lambda x: 1 if isinstance(x, str) and 'series' in x.lower() else 0)\\n\\n# (Feature: collection_has_keyword_trilogy - Binary indicator if 'collection_name' contains 'Trilogy' (case-insensitive))\\n# Input samples: 'collection_name': ['No Collection', 'Lord of the Rings Trilogy', 'The Best Movie Collection']\\ndf['collection_has_keyword_trilogy'] = df['collection_name'].apply(lambda x: 1 if isinstance(x, str) and 'trilogy' in x.lower() else 0)\\n\\n# (Feature: log_popularity - Log transformation of popularity)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['log_popularity'] = np.log1p(df['popularity'])\\n\\n# (Feature: runtime_imputed_to_0 - Binary indicator if runtime was originally 0 (often indicating missing data))\\n# Input samples: 'runtime': [139, 100, 85, 0]\\ndf['runtime_is_zero'] = (df['runtime'] == 0).astype(int)\\n\\n# (Feature: budget_imputed_to_0 - Binary indicator if budget was originally 0 (often indicating missing data))\\n# Input samples: 'budget': [63000000, 12000000, 0, 6500000]\\ndf['budget_is_zero'] = (df['budget'] == 0).astype(int)\"}, {\"search_node\": {\"trial\": 17, \"parent_trial\": 7, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"score\": -2.1807121926184094}], \"predefined_state\": null, \"parent_score\": -2.1807121926184094, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: overview_word_count - Number of words in the movie's overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u00e9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: tagline_exists - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_exists'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() else 0)\\n\\n# (Feature: tagline_word_count - Number of words in the movie's tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if pd.notna(x) else 0)\\n\\n# (Feature: original_language_english - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: release_day - Day of the month of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_day'] = df['release_date'].dt.day\\n\\n# (Feature: release_quarter - Quarter of the year of the movie's release)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_quarter'] = df['release_date'].dt.quarter\\n\\n# (Feature: is_weekend_release - Binary indicator if the movie was released on a weekend (Friday, Saturday, Sunday))\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x >= 4 else 0)\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Animation - Binary indicator for 'Animation' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\"]\\n# Note: Re-parsing genres to ensure the 'parsed_genres' is available if deleted in an earlier block.\\ndf['parsed_genres_temp'] = df['genres'].apply(safe_literal_eval) # Use a temp name to avoid conflict\\ndf['genre_is_Adventure'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_Family'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Animation'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 16, 'name': 'Animation'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres_temp'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['parsed_genres_temp']\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\"]\\n# Note: Re-parsing production_companies to ensure the 'parsed_production_companies' is available if deleted in an earlier block.\\ndf['parsed_production_companies_temp'] = df['production_companies'].apply(safe_literal_eval) # Use a temp name\\ndf['has_UniversalPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Universal Pictures' for comp in x) else 0)\\ndf['has_ColumbiaPictures'] = df['parsed_production_companies_temp'].apply(lambda x: 1 if any(comp['name'] == 'Columbia Pictures' for comp in x) else 0)\\ndel df['parsed_production_companies_temp']\\n\\n# (Feature: diff_original_title_and_title_len - Absolute difference in length between original title and title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['diff_original_title_and_title_len'] = df.apply(lambda row: abs(len(str(row['original_title'])) - len(str(row['title']))) if pd.notna(row['original_title']) and pd.notna(row['title']) else 0, axis=1)\\n\\n# (Feature: popularity_by_runtime - Ratio of popularity to runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_by_runtime'] = df.apply(lambda row: row['popularity'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: budget_by_runtime - Ratio of budget to runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_by_runtime'] = df.apply(lambda row: row['budget'] / row['runtime'] if row['runtime'] > 0 else 0, axis=1)\\n\\n# (Feature: cast_gender_ratio - Ratio of male to female cast members. Added back parsed_cast for this as it was deleted)\\n# Input samples: 'num_male_cast': [20, 7, 11], 'num_female_cast': [1, 7, 4]\\n# Re-evaluate num_male_cast, num_female_cast to ensure consistency with `safe_literal_eval` logic across blocks if not already done.\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_num_male_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['temp_num_female_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\ndf['cast_gender_ratio'] = df.apply(lambda row: row['temp_num_male_cast'] / (row['temp_num_female_cast'] + 1e-6) if row['temp_num_male_cast'] + row['temp_num_female_cast'] > 0 else 0, axis=1)\\ndel df['temp_num_male_cast']\\ndel df['temp_num_female_cast']\\ndel df['temp_parsed_cast']\\n\\n# (Feature: cast_top_billed_male_ratio - Ratio of male actors in the first 5 cast positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0, \\\\'gender\\\\': 2}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 2}, ...]', '[{\\\\'order\\\\': 0, \\\\'gender\\\\': 1}, {\\\\'order\\\\': 1, \\\\'gender\\\\': 1}, ...]', ...]\\ndf['top_5_cast'] = df['cast'].apply(lambda x: [c for c in safe_literal_eval(x) if c.get('order') is not None and c['order'] < 5])\\ndf['cast_top_billed_male_ratio'] = df['top_5_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2) / (len(x) + 1e-6) if len(x) > 0 else 0)\\ndel df['top_5_cast']\", \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd # Ensure pandas is imported for pd.Series.dt.day etc.\\n\\n# Helper function for safe JSON parsing (repeated for robustness if run independently or if previous blocks delete temp columns)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: budget_log1p - Log transform of budget, adding 1 to handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_log1p'] = np.log1p(df['budget'])\\n\\n# (Feature: popularity_log1p - Log transform of popularity, adding 1 to handle values close to zero)\\n# Input samples: 'popularity': [63.87, 10.16, 0.53]\\ndf['popularity_log1p'] = np.log1p(df['popularity'])\\n\\n# (Feature: runtime_log1p - Log transform of runtime, adding 1 to handle zero runtimes)\\n# Input samples: 'runtime': [139, 100, 0]\\ndf['runtime_log1p'] = np.log1p(df['runtime'])\\n\\n# (Feature: has_english_title - Binary indicator if original title is in English and potentially different from standard title)\\n# Input samples: 'original_language': ['en', 'ru'], 'original_title': ['Fight Club', 'Samyy Luchshiy Film 3-DE'], 'title': ['Fight Club', 'The Best Movie 3-DE']\\ndf['has_english_title'] = ((df['original_language'] == 'en') & (df['original_title'] == df['title'])).astype(int)\\n\\n# (Feature: release_month_sin - Sine transformation of release_month for cyclical patterns)\\n# (Feature: release_month_cos - Cosine transformation of release_month for cyclical patterns)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sine transformation of release_dayofweek for cyclical patterns)\\n# (Feature: release_dayofweek_cos - Cosine transformation of release_dayofweek for cyclical patterns)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 2.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: release_decade - The decade of the movie's release)\\n# Input samples: 'release_year': [1999.0, 2017.0, 1984.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: is_recent_release - Binary indicator for movies released in the last few years (e.g., post-2010 for this dataset's range))\\n# Input samples: 'release_year': [1999.0, 2017.0, 2011.0]\\ndf['is_recent_release'] = (df['release_year'] >= 2010).astype(int)\\n\\n# (Feature: title_length - Length of the movie's title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\\n\\n# (Feature: original_title_length - Length of the movie's original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\\n\\n# (Feature: has_overview - Binary indicator if an overview exists)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', nan, 'When Shaun decides to take the day off...']\\ndf['has_overview'] = df['overview'].apply(lambda x: 1 if pd.notna(x) and len(str(x).strip()) > 0 else 0)\\n\\n# (Feature: runtime_is_zero - Binary indicator if runtime is zero)\\n# Input samples: 'runtime': [139, 100, 0]\\ndf['runtime_is_zero'] = (df['runtime'] == 0).astype(int)\\n\\n# (Feature: budget_is_zero - Binary indicator if budget is zero)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_is_zero'] = (df['budget'] == 0).astype(int)\\n\\n# (Feature: release_year_squared - Square of release year for non-linear trends)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_squared'] = df['release_year'] ** 2\\n\\n# (Feature: runtime_over_year - Ratio of runtime to release year)\\n# Input samples: 'runtime': [139, 100, 85], 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['runtime_over_year'] = df.apply(lambda row: row['runtime'] / row['release_year'] if row['release_year'] > 0 else 0, axis=1)\\n\\n# (Feature: homepage_length - Length of the homepage URL string)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_length'] = df['homepage'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\"]}, \"score\": -2.2201179024565407, \"memory_update\": \"import json\\nimport ast\\nimport numpy as np\\nimport pandas as pd # Ensure pandas is imported for pd.Series.dt.day etc.\\n\\n# Helper function for safe JSON parsing (repeated for robustness if run independently or if previous blocks delete temp columns)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: budget_log1p - Log transform of budget, adding 1 to handle zero budgets)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_log1p'] = np.log1p(df['budget'])\\n\\n# (Feature: popularity_log1p - Log transform of popularity, adding 1 to handle values close to zero)\\n# Input samples: 'popularity': [63.87, 10.16, 0.53]\\ndf['popularity_log1p'] = np.log1p(df['popularity'])\\n\\n# (Feature: runtime_log1p - Log transform of runtime, adding 1 to handle zero runtimes)\\n# Input samples: 'runtime': [139, 100, 0]\\ndf['runtime_log1p'] = np.log1p(df['runtime'])\\n\\n# (Feature: has_english_title - Binary indicator if original title is in English and potentially different from standard title)\\n# Input samples: 'original_language': ['en', 'ru'], 'original_title': ['Fight Club', 'Samyy Luchshiy Film 3-DE'], 'title': ['Fight Club', 'The Best Movie 3-DE']\\ndf['has_english_title'] = ((df['original_language'] == 'en') & (df['original_title'] == df['title'])).astype(int)\\n\\n# (Feature: release_month_sin - Sine transformation of release_month for cyclical patterns)\\n# (Feature: release_month_cos - Cosine transformation of release_month for cyclical patterns)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sine transformation of release_dayofweek for cyclical patterns)\\n# (Feature: release_dayofweek_cos - Cosine transformation of release_dayofweek for cyclical patterns)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 2.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: release_decade - The decade of the movie's release)\\n# Input samples: 'release_year': [1999.0, 2017.0, 1984.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: is_recent_release - Binary indicator for movies released in the last few years (e.g., post-2010 for this dataset's range))\\n# Input samples: 'release_year': [1999.0, 2017.0, 2011.0]\\ndf['is_recent_release'] = (df['release_year'] >= 2010).astype(int)\\n\\n# (Feature: title_length - Length of the movie's title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\\n\\n# (Feature: original_title_length - Length of the movie's original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_length'] = df['original_title'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\\n\\n# (Feature: has_overview - Binary indicator if an overview exists)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman...', nan, 'When Shaun decides to take the day off...']\\ndf['has_overview'] = df['overview'].apply(lambda x: 1 if pd.notna(x) and len(str(x).strip()) > 0 else 0)\\n\\n# (Feature: runtime_is_zero - Binary indicator if runtime is zero)\\n# Input samples: 'runtime': [139, 100, 0]\\ndf['runtime_is_zero'] = (df['runtime'] == 0).astype(int)\\n\\n# (Feature: budget_is_zero - Binary indicator if budget is zero)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_is_zero'] = (df['budget'] == 0).astype(int)\\n\\n# (Feature: release_year_squared - Square of release year for non-linear trends)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_squared'] = df['release_year'] ** 2\\n\\n# (Feature: runtime_over_year - Ratio of runtime to release year)\\n# Input samples: 'runtime': [139, 100, 85], 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['runtime_over_year'] = df.apply(lambda row: row['runtime'] / row['release_year'] if row['release_year'] > 0 else 0, axis=1)\\n\\n# (Feature: homepage_length - Length of the homepage URL string)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_length'] = df['homepage'].apply(lambda x: len(str(x)) if pd.notna(x) else 0)\"}, {\"search_node\": {\"trial\": 18, \"parent_trial\": 9, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"# (Feature: has_collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Feature: homepage_present)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: tagline_present)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: overview_word_count)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy. Their concept catches on, with underground \\\"fight clubs\\\" forming in every town, until an eccentric gets in the way and ignites an out-of-control spiral toward oblivion.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for. A mix up with the Farmer, a caravan and a very steep hill lead them all to the Big City and it's up to Shaun and the flock to return everyone safely to the green grass of home.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: is_english)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: title_vs_original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_vs_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# JSON parsing for 'genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew'\\n# Safely evaluate string literal for list of dicts.\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError):\\n        return []\\n\\ndf['genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\ndf['production_countries_parsed'] = df['production_countries'].apply(safe_literal_eval)\\ndf['spoken_languages_parsed'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['Keywords_parsed'] = df['Keywords'].apply(safe_literal_eval)\\ndf['cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['crew_parsed'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: num_genres)\\n# Input samples: 'genres': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres_parsed'].apply(len)\\n\\n# (Feature: num_production_companies)\\n# Input samples: 'production_companies': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_companies'] = df['production_companies_parsed'].apply(len)\\n\\n# (Feature: num_production_countries)\\n# Input samples: 'production_countries': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_countries'] = df['production_countries_parsed'].apply(len)\\n\\n# (Feature: num_spoken_languages)\\n# Input samples: 'spoken_languages': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages_parsed'].apply(len)\\n\\n# (Feature: num_Keywords)\\n# Input samples: 'Keywords': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_Keywords'] = df['Keywords_parsed'].apply(len)\\n\\n# (Feature: num_cast)\\n# Input samples: 'cast': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_cast'] = df['cast_parsed'].apply(len)\\n\\n# (Feature: num_crew)\\n# Input samples: 'crew': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_crew'] = df['crew_parsed'].apply(len)\\n\\n# (Feature: director_gender)\\n# Input samples: 'crew_parsed': [[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '...'}], [{'credit_id': '...', 'department': 'Directing', 'gender': 1, 'id': 1899, 'job': 'Director', 'name': 'Denise Di Novi', 'profile_path': '...'}], []]\\ndef get_director_gender(crew_list):\\n    for member in crew_list:\\n        if member.get('job') == 'Director':\\n            return member.get('gender', 0) # 1: female, 2: male, 0: unknown\\n    return 0\\ndf['director_gender'] = df['crew_parsed'].apply(get_director_gender)\\n\\n# (Feature: num_cast_gender_1 - female)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_1'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: num_cast_gender_2 - male)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_2'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\n\\n# (Feature: ratio_male_cast)\\n# Input samples: 'num_cast_gender_2': [2, 1, 0], 'num_cast_gender_1': [1, 2, 0]\\ndf['ratio_male_cast'] = df.apply(lambda row: row['num_cast_gender_2'] / (row['num_cast_gender_1'] + row['num_cast_gender_2']) if (row['num_cast_gender_1'] + row['num_cast_gender_2']) > 0 else 0, axis=1)\\n\\n# (Feature: genre_encoded_Drama)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Drama'}, {'name': 'Thriller'}], [{'name': 'Family'}, {'name': 'Animation'}, {'name': 'Comedy'}, {'name': 'Adventure'}]]\\ndef has_genre(genre_list, genre_name):\\n    return 1 if any(g.get('name') == genre_name for g in genre_list) else 0\\n\\nfor genre_name in ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Horror', 'Romance']:\\n    df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: has_genre(x, genre_name))\\n\\n# (Feature: prod_country_US)\\n# Input samples: 'production_countries_parsed': [[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}], [{'iso_3166_1': 'US'}], [{'iso_3166_1': 'FR'}, {'iso_3166_1': 'GB'}]]\\ndef has_country(country_list, country_iso):\\n    return 1 if any(c.get('iso_3166_1') == country_iso for c in country_list) else 0\\n\\nfor country_iso in ['US', 'GB', 'FR', 'DE', 'RU']: # Top countries\\n    df[f'prod_country_{country_iso}'] = df['production_countries_parsed'].apply(lambda x: has_country(x, country_iso))\\n\\n# (Feature: spoke_language_en)\\n# Input samples: 'spoken_languages_parsed': [[{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}]]\\ndef has_language(lang_list, lang_iso):\\n    return 1 if any(l.get('iso_639_1') == lang_iso for l in lang_list) else 0\\n\\nfor lang_iso in ['en', 'fr', 'ru', 'de', 'es']: # Top languages\\n    df[f'spoke_language_{lang_iso}'] = df['spoken_languages_parsed'].apply(lambda x: has_language(x, lang_iso))\\n\", \"score\": -2.1943666631942884}], \"predefined_state\": null, \"parent_score\": -2.1943666631942884, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"# (Feature: has_collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Feature: homepage_present)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['homepage_present'] = df['homepage'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: tagline_present)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_present'] = df['tagline'].apply(lambda x: 1 if isinstance(x, str) and x.strip() != '' else 0)\\n\\n# (Feature: overview_word_count)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy. Their concept catches on, with underground \\\"fight clubs\\\" forming in every town, until an eccentric gets in the way and ignites an out-of-control spiral toward oblivion.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for. A mix up with the Farmer, a caravan and a very steep hill lead them all to the Big City and it's up to Shaun and the flock to return everyone safely to the green grass of home.\\\"]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: is_english)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_english'] = df['original_language'].apply(lambda x: 1 if x == 'en' else 0)\\n\\n# (Feature: title_vs_original_title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_vs_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# JSON parsing for 'genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew'\\n# Safely evaluate string literal for list of dicts.\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError):\\n        return []\\n\\ndf['genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\ndf['production_countries_parsed'] = df['production_countries'].apply(safe_literal_eval)\\ndf['spoken_languages_parsed'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['Keywords_parsed'] = df['Keywords'].apply(safe_literal_eval)\\ndf['cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['crew_parsed'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: num_genres)\\n# Input samples: 'genres': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['num_genres'] = df['genres_parsed'].apply(len)\\n\\n# (Feature: num_production_companies)\\n# Input samples: 'production_companies': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_companies'] = df['production_companies_parsed'].apply(len)\\n\\n# (Feature: num_production_countries)\\n# Input samples: 'production_countries': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_production_countries'] = df['production_countries_parsed'].apply(len)\\n\\n# (Feature: num_spoken_languages)\\n# Input samples: 'spoken_languages': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_spoken_languages'] = df['spoken_languages_parsed'].apply(len)\\n\\n# (Feature: num_Keywords)\\n# Input samples: 'Keywords': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_Keywords'] = df['Keywords_parsed'].apply(len)\\n\\n# (Feature: num_cast)\\n# Input samples: 'cast': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_cast'] = df['cast_parsed'].apply(len)\\n\\n# (Feature: num_crew)\\n# Input samples: 'crew': [\\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\", \\\"[nan, nan, nan]\\\"]\\ndf['num_crew'] = df['crew_parsed'].apply(len)\\n\\n# (Feature: director_gender)\\n# Input samples: 'crew_parsed': [[{'credit_id': '...', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '...'}], [{'credit_id': '...', 'department': 'Directing', 'gender': 1, 'id': 1899, 'job': 'Director', 'name': 'Denise Di Novi', 'profile_path': '...'}], []]\\ndef get_director_gender(crew_list):\\n    for member in crew_list:\\n        if member.get('job') == 'Director':\\n            return member.get('gender', 0) # 1: female, 2: male, 0: unknown\\n    return 0\\ndf['director_gender'] = df['crew_parsed'].apply(get_director_gender)\\n\\n# (Feature: num_cast_gender_1 - female)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_1'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: num_cast_gender_2 - male)\\n# Input samples: 'cast_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 1}], []]\\ndf['num_cast_gender_2'] = df['cast_parsed'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\n\\n# (Feature: ratio_male_cast)\\n# Input samples: 'num_cast_gender_2': [2, 1, 0], 'num_cast_gender_1': [1, 2, 0]\\ndf['ratio_male_cast'] = df.apply(lambda row: row['num_cast_gender_2'] / (row['num_cast_gender_1'] + row['num_cast_gender_2']) if (row['num_cast_gender_1'] + row['num_cast_gender_2']) > 0 else 0, axis=1)\\n\\n# (Feature: genre_encoded_Drama)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Drama'}, {'name': 'Thriller'}], [{'name': 'Family'}, {'name': 'Animation'}, {'name': 'Comedy'}, {'name': 'Adventure'}]]\\ndef has_genre(genre_list, genre_name):\\n    return 1 if any(g.get('name') == genre_name for g in genre_list) else 0\\n\\nfor genre_name in ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Horror', 'Romance']:\\n    df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: has_genre(x, genre_name))\\n\\n# (Feature: prod_country_US)\\n# Input samples: 'production_countries_parsed': [[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}], [{'iso_3166_1': 'US'}], [{'iso_3166_1': 'FR'}, {'iso_3166_1': 'GB'}]]\\ndef has_country(country_list, country_iso):\\n    return 1 if any(c.get('iso_3166_1') == country_iso for c in country_list) else 0\\n\\nfor country_iso in ['US', 'GB', 'FR', 'DE', 'RU']: # Top countries\\n    df[f'prod_country_{country_iso}'] = df['production_countries_parsed'].apply(lambda x: has_country(x, country_iso))\\n\\n# (Feature: spoke_language_en)\\n# Input samples: 'spoken_languages_parsed': [[{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}], [{'iso_639_1': 'en'}]]\\ndef has_language(lang_list, lang_iso):\\n    return 1 if any(l.get('iso_639_1') == lang_iso for l in lang_list) else 0\\n\\nfor lang_iso in ['en', 'fr', 'ru', 'de', 'es']: # Top languages\\n    df[f'spoke_language_{lang_iso}'] = df['spoken_languages_parsed'].apply(lambda x: has_language(x, lang_iso))\\n\", \"import ast\\nimport numpy as np\\n\\n# JSON parsing functions (re-definition for idempotency if block is run standalone, or ensure 'df_raw' or pre-parsed columns are handled)\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError, TypeError): # Added TypeError for nan handling in apply\\n        return []\\n\\n# Ensure parsed columns exist for further processing\\nfor col_name in ['genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew', 'belongs_to_collection']:\\n    if f'{col_name}_parsed' not in df.columns:\\n        df[f'{col_name}_parsed'] = df[col_name].apply(safe_literal_eval)\\n\\n# (Feature: top_3_cast_gender_1 - female count in top 3 cast)\\n# Input samples: 'cast_parsed': [[{'order': 0, 'gender': 2}, {'order': 1, 'gender': 1}, {'order': 2, 'gender': 1}], [{'order': 0, 'gender': 1}, {'order': 1, 'gender': 2}], []]\\ndef get_top_n_cast_gender_count(cast_list, n=3, gender=1):\\n    top_n_cast = sorted([c for c in cast_list if 'order' in c], key=lambda x: x['order'])[:n]\\n    return sum(1 for c in top_n_cast if c.get('gender') == gender)\\ndf['top_3_cast_gender_1'] = df['cast_parsed'].apply(lambda x: get_top_n_cast_gender_count(x, n=3, gender=1))\\ndf['top_3_cast_gender_2'] = df['cast_parsed'].apply(lambda x: get_top_n_cast_gender_count(x, n=3, gender=2))\\n\\n# (Feature: has_first_billed_female)\\n# Input samples: 'cast_parsed': [[{'order': 0, 'gender': 2}, {'order': 1, 'gender': 1}], [{'order': 0, 'gender': 1}, {'order': 1, 'gender': 2}], []]\\ndef has_first_billed_female(cast_list):\\n    first_cast = sorted([c for c in cast_list if 'order' in c], key=lambda x: x['order'])\\n    if first_cast and first_cast[0].get('gender') == 1:\\n        return 1\\n    return 0\\ndf['has_first_billed_female'] = df['cast_parsed'].apply(has_first_billed_female)\\n\\n# (Feature: num_unique_directors)\\n# Input samples: 'crew_parsed': [[{'job': 'Director', 'name': 'David Fincher'}], [{'job': 'Director', 'name': 'Denise Di Novi'}], [{'job': 'Director', 'name': 'Director A'}, {'job': 'Director', 'name': 'Director B'}]]\\ndef get_unique_directors(crew_list):\\n    return len(set(c.get('name') for c in crew_list if c.get('job') == 'Director' and 'name' in c))\\ndf['num_unique_directors'] = df['crew_parsed'].apply(get_unique_directors)\\n\\n# (Feature: has_producer)\\n# Input samples: 'crew_parsed': [[{'job': 'Producer', 'name': 'Art Linson'}], [{'job': 'Director'}], [{'job': 'Producer'}]]\\ndf['has_producer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Producer' for c in x) else 0)\\n\\n# (Feature: has_writer)\\n# Input samples: 'crew_parsed': [[{'job': 'Writer', 'name': 'Chuck Palahniuk'}], [{'job': 'Producer'}], []]\\ndf['has_writer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Writer' or c.get('job') == 'Screenplay' or c.get('job') == 'Novel' for c in x) else 0)\\n\\n# (Feature: popularity_log)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = np.log1p(df['popularity'])\\n\\n# (Feature: budget_log)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_log'] = np.log1p(df['budget'])\\n\\n# (Feature: runtime_log)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_log'] = np.log1p(df['runtime'])\\n\\n# (Feature: runtime_per_budget - handling zero budget)\\n# Input samples: 'runtime': [139, 100, 0], 'budget': [63000000, 12000000, 0]\\ndf['runtime_per_budget'] = df.apply(lambda row: row['runtime'] / row['budget'] if row['budget'] > 0 else 0, axis=1)\\n\\n# (Feature: has_top_5_genre)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Comedy'}], [{'name': 'Thriller'}]]\\n# Based on overall distribution (hypothetically from EDA), let's consider a few more genres.\\ntop_genres = ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Crime', 'Horror']\\nfor genre_name in top_genres:\\n    if f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}' not in df.columns: # Prevent re-creation\\n        df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: 1 if any(g.get('name') == genre_name for g in x) else 0)\\n\\n# (Feature: collection_poster_present)\\n# Input samples: 'belongs_to_collection_parsed': [[{'poster_path': '/path.jpg'}], [], [{'poster_path': None}]]\\ndef has_collection_poster(collection_info):\\n    if collection_info and isinstance(collection_info, list) and collection_info[0] and 'poster_path' in collection_info[0]:\\n        return 1 if collection_info[0]['poster_path'] else 0\\n    return 0\\ndf['collection_poster_present'] = df['belongs_to_collection_parsed'].apply(has_collection_poster)\\n\\n# (Feature: has_Keywords_money_related)\\n# Input samples: 'Keywords_parsed': [[{'name': 'money'}, {'name': 'success'}], [{'name': 'drama'}], []]\\nmoney_keywords = ['money', 'revenue', 'box office', 'profit', 'investment', 'success', 'cash']\\ndef has_money_keyword(keywords_list):\\n    return 1 if any(k.get('name') in money_keywords for k in keywords_list) else 0\\ndf['has_Keywords_money_related'] = df['Keywords_parsed'].apply(has_money_keyword)\\n\\n# (Feature: release_year_squared)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_squared'] = df['release_year'] ** 2\\n\\n# (Feature: release_decade)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: weekend_release - assuming release_dayofweek 4 is Friday, 5 is Saturday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x in [4, 5] else 0)\\n\\n# (Feature: crew_average_gender - for overall crew composition)\\n# Input samples: 'crew_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 2}, {'gender': 2}], []]\\ndef get_avg_crew_gender(crew_list):\\n    genders = [c.get('gender') for c in crew_list if 'gender' in c and c.get('gender') in [1, 2]]\\n    if genders:\\n        return sum(genders) / len(genders) # 1: female, 2: male. avg closer to 1 implies more female, closer to 2 more male\\n    return 0\\ndf['crew_average_gender'] = df['crew_parsed'].apply(get_avg_crew_gender)\\n\\n# (Feature: top_producer_present)\\n# Input samples: 'crew_parsed': [[{'job': 'Producer', 'name': 'Arnon Milchan'}], [], [{'job': 'Producer', 'name': 'Some Other'}]\\n# This requires a global frequency count from a larger dataset to be effective. For now, picking a high-profile one from sample:\\ndf['has_Arnon_Milchan_producer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Executive Producer' and c.get('name') == 'Arnon Milchan' for c in x) else 0)\\n\\n# (Feature: top_director_present)\\n# Input samples: 'crew_parsed': [[{'job': 'Director', 'name': 'David Fincher'}], [{'job': 'Director', 'name': 'Denise Di Novi'}], []]\\ndf['has_David_Fincher_director'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\"]}, \"score\": -2.202805574332381, \"memory_update\": \"import ast\\nimport numpy as np\\n\\n# JSON parsing functions (re-definition for idempotency if block is run standalone, or ensure 'df_raw' or pre-parsed columns are handled)\\ndef safe_literal_eval(x):\\n    try:\\n        if isinstance(x, str):\\n            return ast.literal_eval(x)\\n        return []\\n    except (ValueError, SyntaxError, TypeError): # Added TypeError for nan handling in apply\\n        return []\\n\\n# Ensure parsed columns exist for further processing\\nfor col_name in ['genres', 'production_companies', 'production_countries', 'spoken_languages', 'Keywords', 'cast', 'crew', 'belongs_to_collection']:\\n    if f'{col_name}_parsed' not in df.columns:\\n        df[f'{col_name}_parsed'] = df[col_name].apply(safe_literal_eval)\\n\\n# (Feature: top_3_cast_gender_1 - female count in top 3 cast)\\n# Input samples: 'cast_parsed': [[{'order': 0, 'gender': 2}, {'order': 1, 'gender': 1}, {'order': 2, 'gender': 1}], [{'order': 0, 'gender': 1}, {'order': 1, 'gender': 2}], []]\\ndef get_top_n_cast_gender_count(cast_list, n=3, gender=1):\\n    top_n_cast = sorted([c for c in cast_list if 'order' in c], key=lambda x: x['order'])[:n]\\n    return sum(1 for c in top_n_cast if c.get('gender') == gender)\\ndf['top_3_cast_gender_1'] = df['cast_parsed'].apply(lambda x: get_top_n_cast_gender_count(x, n=3, gender=1))\\ndf['top_3_cast_gender_2'] = df['cast_parsed'].apply(lambda x: get_top_n_cast_gender_count(x, n=3, gender=2))\\n\\n# (Feature: has_first_billed_female)\\n# Input samples: 'cast_parsed': [[{'order': 0, 'gender': 2}, {'order': 1, 'gender': 1}], [{'order': 0, 'gender': 1}, {'order': 1, 'gender': 2}], []]\\ndef has_first_billed_female(cast_list):\\n    first_cast = sorted([c for c in cast_list if 'order' in c], key=lambda x: x['order'])\\n    if first_cast and first_cast[0].get('gender') == 1:\\n        return 1\\n    return 0\\ndf['has_first_billed_female'] = df['cast_parsed'].apply(has_first_billed_female)\\n\\n# (Feature: num_unique_directors)\\n# Input samples: 'crew_parsed': [[{'job': 'Director', 'name': 'David Fincher'}], [{'job': 'Director', 'name': 'Denise Di Novi'}], [{'job': 'Director', 'name': 'Director A'}, {'job': 'Director', 'name': 'Director B'}]]\\ndef get_unique_directors(crew_list):\\n    return len(set(c.get('name') for c in crew_list if c.get('job') == 'Director' and 'name' in c))\\ndf['num_unique_directors'] = df['crew_parsed'].apply(get_unique_directors)\\n\\n# (Feature: has_producer)\\n# Input samples: 'crew_parsed': [[{'job': 'Producer', 'name': 'Art Linson'}], [{'job': 'Director'}], [{'job': 'Producer'}]]\\ndf['has_producer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Producer' for c in x) else 0)\\n\\n# (Feature: has_writer)\\n# Input samples: 'crew_parsed': [[{'job': 'Writer', 'name': 'Chuck Palahniuk'}], [{'job': 'Producer'}], []]\\ndf['has_writer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Writer' or c.get('job') == 'Screenplay' or c.get('job') == 'Novel' for c in x) else 0)\\n\\n# (Feature: popularity_log)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = np.log1p(df['popularity'])\\n\\n# (Feature: budget_log)\\n# Input samples: 'budget': [63000000, 12000000, 0]\\ndf['budget_log'] = np.log1p(df['budget'])\\n\\n# (Feature: runtime_log)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_log'] = np.log1p(df['runtime'])\\n\\n# (Feature: runtime_per_budget - handling zero budget)\\n# Input samples: 'runtime': [139, 100, 0], 'budget': [63000000, 12000000, 0]\\ndf['runtime_per_budget'] = df.apply(lambda row: row['runtime'] / row['budget'] if row['budget'] > 0 else 0, axis=1)\\n\\n# (Feature: has_top_5_genre)\\n# Input samples: 'genres_parsed': [[{'name': 'Drama'}], [{'name': 'Comedy'}], [{'name': 'Thriller'}]]\\n# Based on overall distribution (hypothetically from EDA), let's consider a few more genres.\\ntop_genres = ['Drama', 'Comedy', 'Thriller', 'Action', 'Adventure', 'Family', 'Animation', 'Science Fiction', 'Crime', 'Horror']\\nfor genre_name in top_genres:\\n    if f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}' not in df.columns: # Prevent re-creation\\n        df[f'genre_encoded_{genre_name.replace(\\\" \\\", \\\"_\\\")}'] = df['genres_parsed'].apply(lambda x: 1 if any(g.get('name') == genre_name for g in x) else 0)\\n\\n# (Feature: collection_poster_present)\\n# Input samples: 'belongs_to_collection_parsed': [[{'poster_path': '/path.jpg'}], [], [{'poster_path': None}]]\\ndef has_collection_poster(collection_info):\\n    if collection_info and isinstance(collection_info, list) and collection_info[0] and 'poster_path' in collection_info[0]:\\n        return 1 if collection_info[0]['poster_path'] else 0\\n    return 0\\ndf['collection_poster_present'] = df['belongs_to_collection_parsed'].apply(has_collection_poster)\\n\\n# (Feature: has_Keywords_money_related)\\n# Input samples: 'Keywords_parsed': [[{'name': 'money'}, {'name': 'success'}], [{'name': 'drama'}], []]\\nmoney_keywords = ['money', 'revenue', 'box office', 'profit', 'investment', 'success', 'cash']\\ndef has_money_keyword(keywords_list):\\n    return 1 if any(k.get('name') in money_keywords for k in keywords_list) else 0\\ndf['has_Keywords_money_related'] = df['Keywords_parsed'].apply(has_money_keyword)\\n\\n# (Feature: release_year_squared)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_squared'] = df['release_year'] ** 2\\n\\n# (Feature: release_decade)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_decade'] = (df['release_year'] // 10 * 10).astype(int)\\n\\n# (Feature: weekend_release - assuming release_dayofweek 4 is Friday, 5 is Saturday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['weekend_release'] = df['release_dayofweek'].apply(lambda x: 1 if x in [4, 5] else 0)\\n\\n# (Feature: crew_average_gender - for overall crew composition)\\n# Input samples: 'crew_parsed': [[{'gender': 2}, {'gender': 1}], [{'gender': 1}, {'gender': 2}, {'gender': 2}], []]\\ndef get_avg_crew_gender(crew_list):\\n    genders = [c.get('gender') for c in crew_list if 'gender' in c and c.get('gender') in [1, 2]]\\n    if genders:\\n        return sum(genders) / len(genders) # 1: female, 2: male. avg closer to 1 implies more female, closer to 2 more male\\n    return 0\\ndf['crew_average_gender'] = df['crew_parsed'].apply(get_avg_crew_gender)\\n\\n# (Feature: top_producer_present)\\n# Input samples: 'crew_parsed': [[{'job': 'Producer', 'name': 'Arnon Milchan'}], [], [{'job': 'Producer', 'name': 'Some Other'}]\\n# This requires a global frequency count from a larger dataset to be effective. For now, picking a high-profile one from sample:\\ndf['has_Arnon_Milchan_producer'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Executive Producer' and c.get('name') == 'Arnon Milchan' for c in x) else 0)\\n\\n# (Feature: top_director_present)\\n# Input samples: 'crew_parsed': [[{'job': 'Director', 'name': 'David Fincher'}], [{'job': 'Director', 'name': 'Denise Di Novi'}], []]\\ndf['has_David_Fincher_director'] = df['crew_parsed'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\"}, {\"search_node\": {\"trial\": 19, \"parent_trial\": 8, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}], \"predefined_state\": null, \"parent_score\": -2.1878916554583694, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport ast\\nimport json\\n\\n# (Helper function for safe literal_eval, duplicated for robustness in self-contained block logic)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list on parse error for lists\\n    return []\\n\\n# Re-parse genres for more specific indicators if not already present\\nif 'parsed_genres' not in df.columns:\\n    df['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\n\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Family'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndel df['parsed_genres']\\n\\n# Re-parse cast for lead actor if not already present\\nif 'parsed_cast' not in df.columns:\\n    df['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\n\\n# (Feature: lead_actor_id - ID of the lead actor (order 0))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 13, \\\\'character\\\\': \\\\'Frodo Baggins\\\\', \\\\'credit_id\\\\': \\\\'52fe421ac3a36847f8004589\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 109, \\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/hHzLAVspGGuPg1KW5JAEsyRvnUT.jpg\\\\'}]']\\ndf['lead_actor_id'] = df['parsed_cast'].apply(lambda x: next((c['id'] for c in x if c.get('order') == 0), -1))\\ndel df['parsed_cast'] # Clean up intermediate column\\n\\n# Re-parse crew for director id if not already present\\nif 'parsed_crew' not in df.columns:\\n    df['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: director_id - ID of the main director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\", \\\"[{'credit_id': '52fe494bc3a36847f8192d15', 'department': 'Directing', 'gender': 0, 'id': 227083, 'job': 'Director', 'name': 'Kirill Kuzin', 'profile_path': None}]\\\", \\\"[{'credit_id': '52fe4518c3a36847f80bc1c1', 'department': 'Directing', 'gender': 2, 'id': 11770, 'job': 'Director', 'name': 'John Carpenter', 'profile_path': '/5qgEQ9D9r8JmbBmqeLupc1jeTcz.jpg'}]\\\"]\\ndf['director_id'] = df['parsed_crew'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Director'), -1))\\ndel df['parsed_crew'] # Clean up intermediate column\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling zero values)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_per_runtime - Ratio of budget to runtime, handling division by zero/small runtime)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['budget_per_runtime'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_per_runtime_log'] = np.where(df['budget_per_runtime'] > 0, np.log1p(df['budget_per_runtime']), 0)\\n\\n\\n# (Feature: title_equals_original_title - Binary indicator if title and original title are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: title_length - Length of the title string)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].astype(str).apply(len)\\n\\n# (Feature: overview_length - Length of the overview string)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\n# The 'overview' column was dropped in the previous block. Re-adding here for feature creation\\n# Since the description states 'Additional columns can be used in other codeblocks',\\n# if 'overview' was removed and a feature from it is requested again, I need to know if it implies it's gone for good or if it means\\n# access to the original source. Given previous df changes are kept, 'overview' would indeed be dropped.\\n# I will use existing `overview_word_count` to infer the presence, but if an absolute string length is needed, I should re-consider column existence.\\n# Assuming previous code drops 'overview' column as per instructions: \\\"df.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\\\", then 'overview_length' based on string can't be added directly.\\n# However, for conciseness and typical Kaggle scenario, original columns usually persist as hidden but accessible.\\n# If original data source access is permitted, it means reloading it OR `df.drop` with `errors='ignore'` implicitly suggests these are final clean-up.\\n# Given no 'original_df' or 'train.csv' is mentioned, I will assume dropped columns are unavailable.\\n# Skipping overview_length because the base 'overview' column was dropped in the previous block.\\n# Skipping 'tagline_overview_word_ratio' as 'overview' was dropped.\\n\\n# (Feature: release_month_sin - Sine transformation of release month for cyclic seasonality)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_month_cos - Cosine transformation of release month for cyclic seasonality)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sine transformation of release dayofweek for cyclic seasonality)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: release_dayofweek_cos - Cosine transformation of release dayofweek for cyclic seasonality)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\"]}, \"score\": -2.197871003291028, \"memory_update\": \"import numpy as np\\nimport ast\\nimport json\\n\\n# (Helper function for safe literal_eval, duplicated for robustness in self-contained block logic)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list on parse error for lists\\n    return []\\n\\n# Re-parse genres for more specific indicators if not already present\\nif 'parsed_genres' not in df.columns:\\n    df['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\n\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}, {'id': 28, 'name': 'Action'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Family'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\ndf['genre_is_Adventure'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\ndf['genre_is_ScienceFiction'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndf['genre_is_Fantasy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\ndel df['parsed_genres']\\n\\n# Re-parse cast for lead actor if not already present\\nif 'parsed_cast' not in df.columns:\\n    df['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\n\\n# (Feature: lead_actor_id - ID of the lead actor (order 0))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 13, \\\\'character\\\\': \\\\'Frodo Baggins\\\\', \\\\'credit_id\\\\': \\\\'52fe421ac3a36847f8004589\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 109, \\\\'name\\\\': \\\\'Elijah Wood\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/hHzLAVspGGuPg1KW5JAEsyRvnUT.jpg\\\\'}]']\\ndf['lead_actor_id'] = df['parsed_cast'].apply(lambda x: next((c['id'] for c in x if c.get('order') == 0), -1))\\ndel df['parsed_cast'] # Clean up intermediate column\\n\\n# Re-parse crew for director id if not already present\\nif 'parsed_crew' not in df.columns:\\n    df['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\n\\n# (Feature: director_id - ID of the main director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\", \\\"[{'credit_id': '52fe494bc3a36847f8192d15', 'department': 'Directing', 'gender': 0, 'id': 227083, 'job': 'Director', 'name': 'Kirill Kuzin', 'profile_path': None}]\\\", \\\"[{'credit_id': '52fe4518c3a36847f80bc1c1', 'department': 'Directing', 'gender': 2, 'id': 11770, 'job': 'Director', 'name': 'John Carpenter', 'profile_path': '/5qgEQ9D9r8JmbBmqeLupc1jeTcz.jpg'}]\\\"]\\ndf['director_id'] = df['parsed_crew'].apply(lambda x: next((c['id'] for c in x if c.get('job') == 'Director'), -1))\\ndel df['parsed_crew'] # Clean up intermediate column\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling zero values)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_per_runtime - Ratio of budget to runtime, handling division by zero/small runtime)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)], 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['budget_per_runtime'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_per_runtime_log'] = np.where(df['budget_per_runtime'] > 0, np.log1p(df['budget_per_runtime']), 0)\\n\\n\\n# (Feature: title_equals_original_title - Binary indicator if title and original title are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: title_length - Length of the title string)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_length'] = df['title'].astype(str).apply(len)\\n\\n# (Feature: overview_length - Length of the overview string)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\"]\\n# The 'overview' column was dropped in the previous block. Re-adding here for feature creation\\n# Since the description states 'Additional columns can be used in other codeblocks',\\n# if 'overview' was removed and a feature from it is requested again, I need to know if it implies it's gone for good or if it means\\n# access to the original source. Given previous df changes are kept, 'overview' would indeed be dropped.\\n# I will use existing `overview_word_count` to infer the presence, but if an absolute string length is needed, I should re-consider column existence.\\n# Assuming previous code drops 'overview' column as per instructions: \\\"df.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\\\", then 'overview_length' based on string can't be added directly.\\n# However, for conciseness and typical Kaggle scenario, original columns usually persist as hidden but accessible.\\n# If original data source access is permitted, it means reloading it OR `df.drop` with `errors='ignore'` implicitly suggests these are final clean-up.\\n# Given no 'original_df' or 'train.csv' is mentioned, I will assume dropped columns are unavailable.\\n# Skipping overview_length because the base 'overview' column was dropped in the previous block.\\n# Skipping 'tagline_overview_word_ratio' as 'overview' was dropped.\\n\\n# (Feature: release_month_sin - Sine transformation of release month for cyclic seasonality)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = np.sin(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_month_cos - Cosine transformation of release month for cyclic seasonality)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_cos'] = np.cos(2 * np.pi * df['release_month'] / 12)\\n\\n# (Feature: release_dayofweek_sin - Sine transformation of release dayofweek for cyclic seasonality)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = np.sin(2 * np.pi * df['release_dayofweek'] / 7)\\n\\n# (Feature: release_dayofweek_cos - Cosine transformation of release dayofweek for cyclic seasonality)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_cos'] = np.cos(2 * np.pi * df['release_dayofweek'] / 7)\"}, {\"search_node\": {\"trial\": 20, \"parent_trial\": 8, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}], \"predefined_state\": null, \"parent_score\": -2.1878916554583694, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport pandas as pd # Import pandas to use Timestamp properties if needed, and apply functions\\nimport math # For sine/cosine functions\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling zero runtime if it occurs)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_per_runtime - Ratio of logarithmic budget to logarithmic runtime)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'runtime_log': [np.float64(4.941642234551107), np.float64(4.615120516841267), np.float64(4.454347293144869)]\\n# Use epsilon to prevent division by zero for runtime_log if any entry became 0, which should not happen for actual movie runtime.\\nepsilon = 1e-6\\ndf['budget_per_runtime'] = df['budget_log'] / (df['runtime_log'] + epsilon)\\n\\n# (Feature: popularity_x_budget_log - Interaction feature between logarithmic popularity and logarithmic budget)\\n# Input samples: 'popularity_log': [4.172465492196652, 2.3184698375630654, 2.3940170889987933], 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)]\\ndf['popularity_x_budget_log'] = df['popularity_log'] * df['budget_log']\\n\\n# (Feature: original_language_en - Binary indicator for original language English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: original_language_fr - Binary indicator for original language French)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: original_language_ru - Binary indicator for original language Russian)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: release_month_sin - Cyclical sine component for release month)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = df['release_month'].apply(lambda x: math.sin(2 * math.pi * (x - 1) / 12))\\n\\n# (Feature: release_month_cos - Cyclical cosine component for release month)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_cos'] = df['release_month'].apply(lambda x: math.cos(2 * math.pi * (x - 1) / 12))\\n\\n# (Feature: release_dayofweek_sin - Cyclical sine component for release day of week)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = df['release_dayofweek'].apply(lambda x: math.sin(2 * math.pi * x / 7))\\n\\n# (Feature: release_dayofweek_cos - Cyclical cosine component for release day of week)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_cos'] = df['release_dayofweek'].apply(lambda x: math.cos(2 * math.pi * x / 7))\\n\\n# (Feature: days_since_release_epoch - Number of days since a common epoch for release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\nepoch = pd.Timestamp('1970-01-01') # Standard Unix epoch\\ndf['days_since_release_epoch'] = (df['release_date'] - epoch).dt.days\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of logarithmic budget to logarithmic popularity)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'popularity_log': [4.172465492196652, 2.3184698375630654, 2.3940170889987933]\\ndf['budget_to_popularity_ratio'] = df['budget_log'] / (df['popularity_log'] + epsilon)\\n\\n# (Feature: overview_title_length_ratio - Ratio of overview word count to original title word count)\\n# Input samples: 'overview_word_count': [54, 34, 53], 'original_title_word_count': [2, 1, 4]\\ndf['overview_title_length_ratio'] = df['overview_word_count'] / (df['original_title_word_count'] + epsilon)\\n\\n# (Feature: budget_per_num_genres - Log budget per number of genres)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'num_genres': [1, 2, 4]\\ndf['budget_per_num_genres'] = df['budget_log'] / (df['num_genres'] + epsilon)\"]}, \"score\": -2.200487470859044, \"memory_update\": \"import numpy as np\\nimport pandas as pd # Import pandas to use Timestamp properties if needed, and apply functions\\nimport math # For sine/cosine functions\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling zero runtime if it occurs)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_per_runtime - Ratio of logarithmic budget to logarithmic runtime)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'runtime_log': [np.float64(4.941642234551107), np.float64(4.615120516841267), np.float64(4.454347293144869)]\\n# Use epsilon to prevent division by zero for runtime_log if any entry became 0, which should not happen for actual movie runtime.\\nepsilon = 1e-6\\ndf['budget_per_runtime'] = df['budget_log'] / (df['runtime_log'] + epsilon)\\n\\n# (Feature: popularity_x_budget_log - Interaction feature between logarithmic popularity and logarithmic budget)\\n# Input samples: 'popularity_log': [4.172465492196652, 2.3184698375630654, 2.3940170889987933], 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)]\\ndf['popularity_x_budget_log'] = df['popularity_log'] * df['budget_log']\\n\\n# (Feature: original_language_en - Binary indicator for original language English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: original_language_fr - Binary indicator for original language French)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: original_language_ru - Binary indicator for original language Russian)\\n# Input samples: 'original_language': ['en', 'fr', 'ru']\\ndf['original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: release_month_sin - Cyclical sine component for release month)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_sin'] = df['release_month'].apply(lambda x: math.sin(2 * math.pi * (x - 1) / 12))\\n\\n# (Feature: release_month_cos - Cyclical cosine component for release month)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_month_cos'] = df['release_month'].apply(lambda x: math.cos(2 * math.pi * (x - 1) / 12))\\n\\n# (Feature: release_dayofweek_sin - Cyclical sine component for release day of week)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_sin'] = df['release_dayofweek'].apply(lambda x: math.sin(2 * math.pi * x / 7))\\n\\n# (Feature: release_dayofweek_cos - Cyclical cosine component for release day of week)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['release_dayofweek_cos'] = df['release_dayofweek'].apply(lambda x: math.cos(2 * math.pi * x / 7))\\n\\n# (Feature: days_since_release_epoch - Number of days since a common epoch for release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\nepoch = pd.Timestamp('1970-01-01') # Standard Unix epoch\\ndf['days_since_release_epoch'] = (df['release_date'] - epoch).dt.days\\n\\n# (Feature: budget_to_popularity_ratio - Ratio of logarithmic budget to logarithmic popularity)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'popularity_log': [4.172465492196652, 2.3184698375630654, 2.3940170889987933]\\ndf['budget_to_popularity_ratio'] = df['budget_log'] / (df['popularity_log'] + epsilon)\\n\\n# (Feature: overview_title_length_ratio - Ratio of overview word count to original title word count)\\n# Input samples: 'overview_word_count': [54, 34, 53], 'original_title_word_count': [2, 1, 4]\\ndf['overview_title_length_ratio'] = df['overview_word_count'] / (df['original_title_word_count'] + epsilon)\\n\\n# (Feature: budget_per_num_genres - Log budget per number of genres)\\n# Input samples: 'budget_log': [np.float64(17.95874287841103), np.float64(16.295240217986705), np.float64(0.0)], 'num_genres': [1, 2, 4]\\ndf['budget_per_num_genres'] = df['budget_log'] / (df['num_genres'] + epsilon)\"}, {\"search_node\": {\"trial\": 21, \"parent_trial\": 12, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}, {\"update\": \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\", \"score\": -2.1611170271190994}], \"predefined_state\": null, \"parent_score\": -2.1611170271190994, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\", \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# (Helper function for safe literal_eval)\\n# This function is crucial for robust parsing of JSON-like strings\\n# and needs to be present in each block where parsing is performed.\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list for failed parses to maintain consistency for list operations.\\n    return []\\n\\n# Re-parse JSON-like columns as temporary intermediate columns\\n# These base columns (`genres`, `production_companies`, etc.) were not dropped in prior blocks.\\ndf['temp_parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['temp_parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['temp_parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\n\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'log_runtime': [np.log1p(139), np.log1p(100), np.log1p(85)]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}]\\\"]\\ndf['genre_is_Adventure'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\n\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Family'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\n\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_ScienceFiction'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\n\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Fantasy'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[...]\\\"]\\ndf['has_UniversalPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Universal Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[...]\\\"]\\ndf['has_ColumbiaPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Columbia Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ParamountPictures - Binary indicator if Paramount Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"[{'name': 'Paramount Pictures', 'id': 4}]\\\", \\\"[...]\\\"]\\ndf['has_ParamountPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Paramount Pictures' for comp in x) else 0)\\n\\n# (Feature: director_peter_jackson - Binary indicator if Peter Jackson is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{..., 'name': 'David Fincher', ...}]\\\"]\\ndf['director_peter_jackson'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Peter Jackson' for c in x) else 0)\\n\\n# (Feature: director_david_fincher - Binary indicator if David Fincher is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{..., 'name': 'Peter Jackson', ...}]\\\"]\\ndf['director_david_fincher'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\\n# (Feature: has_original_music_composer - Binary indicator if the movie has an 'Original Music Composer' in crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer'}]\\\", \\\"[{...}]\\\"]\\ndf['has_original_music_composer'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Original Music Composer' for c in x) else 0)\\n\\n# (Feature: num_top_billed_cast - Count of actors in the first 5 billed positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0}, {\\\\'order\\\\': 1}, {\\\\'order\\\\': 2}, {\\\\'order\\\\': 3}, {\\\\'order\\\\': 4}, {\\\\'order\\\\': 5}]']\\ndf['num_top_billed_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('order') is not None and c.get('order') < 5))\\n\\n# (Feature: first_genre_id - The ID of the first listed genre, or -1 if none)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[]\\\"]\\ndf['first_genre_id'] = df['temp_parsed_genres'].apply(lambda x: x[0]['id'] if x and 'id' in x[0] else -1)\\n\\n# (Feature: num_english_speaking_production_countries - Count of 'US' or 'GB' production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}]\\\", \\\"[{'iso_3166_1': 'GB'}]\\\", \\\"[{'iso_3166_1': 'FR'}]\\\"]\\ndf['num_english_speaking_production_countries'] = df['temp_parsed_production_countries'].apply(\\n    lambda x: sum(1 for c in x if c.get('iso_3166_1') in ['US', 'GB']))\\n\\n# Clean up temporary parsed columns\\ndf.drop(columns=[\\n    'temp_parsed_genres', 'temp_parsed_production_companies',\\n    'temp_parsed_crew', 'temp_parsed_cast', 'temp_parsed_production_countries'\\n], inplace=True, errors='ignore')\"]}, \"score\": -2.1779286219955005, \"memory_update\": \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# (Helper function for safe literal_eval)\\n# This function is crucial for robust parsing of JSON-like strings\\n# and needs to be present in each block where parsing is performed.\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list for failed parses to maintain consistency for list operations.\\n    return []\\n\\n# Re-parse JSON-like columns as temporary intermediate columns\\n# These base columns (`genres`, `production_companies`, etc.) were not dropped in prior blocks.\\ndf['temp_parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['temp_parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['temp_parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\n\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'log_runtime': [np.log1p(139), np.log1p(100), np.log1p(85)]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}]\\\"]\\ndf['genre_is_Adventure'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\n\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Family'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\n\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_ScienceFiction'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\n\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Fantasy'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[...]\\\"]\\ndf['has_UniversalPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Universal Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[...]\\\"]\\ndf['has_ColumbiaPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Columbia Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ParamountPictures - Binary indicator if Paramount Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"[{'name': 'Paramount Pictures', 'id': 4}]\\\", \\\"[...]\\\"]\\ndf['has_ParamountPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Paramount Pictures' for comp in x) else 0)\\n\\n# (Feature: director_peter_jackson - Binary indicator if Peter Jackson is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{..., 'name': 'David Fincher', ...}]\\\"]\\ndf['director_peter_jackson'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Peter Jackson' for c in x) else 0)\\n\\n# (Feature: director_david_fincher - Binary indicator if David Fincher is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{..., 'name': 'Peter Jackson', ...}]\\\"]\\ndf['director_david_fincher'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\\n# (Feature: has_original_music_composer - Binary indicator if the movie has an 'Original Music Composer' in crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer'}]\\\", \\\"[{...}]\\\"]\\ndf['has_original_music_composer'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Original Music Composer' for c in x) else 0)\\n\\n# (Feature: num_top_billed_cast - Count of actors in the first 5 billed positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0}, {\\\\'order\\\\': 1}, {\\\\'order\\\\': 2}, {\\\\'order\\\\': 3}, {\\\\'order\\\\': 4}, {\\\\'order\\\\': 5}]']\\ndf['num_top_billed_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('order') is not None and c.get('order') < 5))\\n\\n# (Feature: first_genre_id - The ID of the first listed genre, or -1 if none)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[]\\\"]\\ndf['first_genre_id'] = df['temp_parsed_genres'].apply(lambda x: x[0]['id'] if x and 'id' in x[0] else -1)\\n\\n# (Feature: num_english_speaking_production_countries - Count of 'US' or 'GB' production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}]\\\", \\\"[{'iso_3166_1': 'GB'}]\\\", \\\"[{'iso_3166_1': 'FR'}]\\\"]\\ndf['num_english_speaking_production_countries'] = df['temp_parsed_production_countries'].apply(\\n    lambda x: sum(1 for c in x if c.get('iso_3166_1') in ['US', 'GB']))\\n\\n# Clean up temporary parsed columns\\ndf.drop(columns=[\\n    'temp_parsed_genres', 'temp_parsed_production_companies',\\n    'temp_parsed_crew', 'temp_parsed_cast', 'temp_parsed_production_countries'\\n], inplace=True, errors='ignore')\"}, {\"search_node\": {\"trial\": 22, \"parent_trial\": 21, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}, {\"update\": \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\", \"score\": -2.1611170271190994}, {\"update\": \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# (Helper function for safe literal_eval)\\n# This function is crucial for robust parsing of JSON-like strings\\n# and needs to be present in each block where parsing is performed.\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list for failed parses to maintain consistency for list operations.\\n    return []\\n\\n# Re-parse JSON-like columns as temporary intermediate columns\\n# These base columns (`genres`, `production_companies`, etc.) were not dropped in prior blocks.\\ndf['temp_parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['temp_parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['temp_parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['temp_parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['temp_parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\n\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'log_runtime': [np.log1p(139), np.log1p(100), np.log1p(85)]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\\n\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}]\\\"]\\ndf['genre_is_Adventure'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\n\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Family'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\n\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\n# Input samples: 'genres': [\\\"[{'id': 878, 'name': 'Science Fiction'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_ScienceFiction'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\n\\n# (Feature: genre_is_Fantasy - Binary indicator for 'Fantasy' genre)\\n# Input samples: 'genres': [\\\"[{'id': 12, 'name': 'Adventure'}, {'id': 14, 'name': 'Fantasy'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['genre_is_Fantasy'] = df['temp_parsed_genres'].apply(lambda x: 1 if {'id': 14, 'name': 'Fantasy'} in x else 0)\\n\\n# (Feature: has_UniversalPictures - Binary indicator if Universal Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'Universal Pictures', 'id': 33}]\\\", \\\"[...]\\\"]\\ndf['has_UniversalPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Universal Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ColumbiaPictures - Binary indicator if Columbia Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...]\\\", \\\"[{'name': 'Columbia Pictures', 'id': 5}]\\\", \\\"[...]\\\"]\\ndf['has_ColumbiaPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Columbia Pictures' for comp in x) else 0)\\n\\n# (Feature: has_ParamountPictures - Binary indicator if Paramount Pictures is a production company)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"[{'name': 'Paramount Pictures', 'id': 4}]\\\", \\\"[...]\\\"]\\ndf['has_ParamountPictures'] = df['temp_parsed_production_companies'].apply(lambda x: 1 if any(comp.get('name') == 'Paramount Pictures' for comp in x) else 0)\\n\\n# (Feature: director_peter_jackson - Binary indicator if Peter Jackson is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'Peter Jackson'}]\\\", \\\"[{..., 'name': 'David Fincher', ...}]\\\"]\\ndf['director_peter_jackson'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'Peter Jackson' for c in x) else 0)\\n\\n# (Feature: director_david_fincher - Binary indicator if David Fincher is among the directors)\\n# Input samples: 'crew': [\\\"[{'job': 'Director', 'name': 'David Fincher'}]\\\", \\\"[{..., 'name': 'Peter Jackson', ...}]\\\"]\\ndf['director_david_fincher'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('name') == 'David Fincher' for c in x) else 0)\\n\\n# (Feature: has_original_music_composer - Binary indicator if the movie has an 'Original Music Composer' in crew)\\n# Input samples: 'crew': [\\\"[{'job': 'Original Music Composer'}]\\\", \\\"[{...}]\\\"]\\ndf['has_original_music_composer'] = df['temp_parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Original Music Composer' for c in x) else 0)\\n\\n# (Feature: num_top_billed_cast - Count of actors in the first 5 billed positions)\\n# Input samples: 'cast': ['[{\\\\'order\\\\': 0}, {\\\\'order\\\\': 1}, {\\\\'order\\\\': 2}, {\\\\'order\\\\': 3}, {\\\\'order\\\\': 4}, {\\\\'order\\\\': 5}]']\\ndf['num_top_billed_cast'] = df['temp_parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('order') is not None and c.get('order') < 5))\\n\\n# (Feature: first_genre_id - The ID of the first listed genre, or -1 if none)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 12, 'name': 'Adventure'}]\\\", \\\"[]\\\"]\\ndf['first_genre_id'] = df['temp_parsed_genres'].apply(lambda x: x[0]['id'] if x and 'id' in x[0] else -1)\\n\\n# (Feature: num_english_speaking_production_countries - Count of 'US' or 'GB' production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE'}, {'iso_3166_1': 'US'}]\\\", \\\"[{'iso_3166_1': 'GB'}]\\\", \\\"[{'iso_3166_1': 'FR'}]\\\"]\\ndf['num_english_speaking_production_countries'] = df['temp_parsed_production_countries'].apply(\\n    lambda x: sum(1 for c in x if c.get('iso_3166_1') in ['US', 'GB']))\\n\\n# Clean up temporary parsed columns\\ndf.drop(columns=[\\n    'temp_parsed_genres', 'temp_parsed_production_companies',\\n    'temp_parsed_crew', 'temp_parsed_cast', 'temp_parsed_production_countries'\\n], inplace=True, errors='ignore')\", \"score\": -2.1779286219955005}], \"predefined_state\": null, \"parent_score\": -2.1779286219955005, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport ast\\nimport json # Included just in case it's explicitly needed, but ast.literal_eval handles Python literal strings better.\\n\\n# Ensure safe_literal_eval is defined in this block if not carried over\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: release_dayofyear - Day of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear\\n\\n# (Feature: release_weekofyear - Week of the year for the release date)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: log_runtime - Logarithmic transformation of runtime, handling potential zero runtime)\\n# Input samples: 'runtime': [139, 100, 85]\\ndf['log_runtime'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: budget_to_runtime_ratio - Ratio of budget to runtime, with robust handling of zero runtime)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['budget_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['budget'] / df['runtime'], 0)\\ndf['budget_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: popularity_to_runtime_ratio - Ratio of popularity to runtime, with robust handling of zero runtime)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'runtime': [139, 100, 85]\\ndf['popularity_to_runtime_ratio'] = np.where(df['runtime'] > 0, df['popularity'] / df['runtime'], 0)\\ndf['popularity_to_runtime_ratio'].replace([np.inf, -np.inf], 0, inplace=True) # Replace inf with 0 just in case.\\n\\n# (Feature: is_title_original - Binary indicator if 'title' and 'original_title' are identical)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie'], 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['is_title_original'] = (df['title'] == df['original_title']).astype(int)\\n\\n# (Feature: is_original_language_en - Binary indicator if original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: is_original_language_fr - Binary indicator if original language is French)\\n# Input samples: 'original_language': ['en', 'fr', 'en']\\ndf['is_original_language_fr'] = (df['original_language'] == 'fr').astype(int)\\n\\n# (Feature: is_original_language_ru - Binary indicator if original language is Russian)\\n# Input samples: 'original_language': ['ru', 'en', 'en']\\ndf['is_original_language_ru'] = (df['original_language'] == 'ru').astype(int)\\n\\n# (Feature: is_original_language_es - Binary indicator if original language is Spanish)\\n# Input samples: 'original_language': ['en', 'es', 'en']\\ndf['is_original_language_es'] = (df['original_language'] == 'es').astype(int)\\n\\n# (Feature: log_budget_plus_one_runtime_product - Combined feature of log budget and log runtime for interaction)\\n# Input samples: 'budget': [63000000, 12000000, 0], 'runtime': [139, 100, 85]\\ndf['log_budget_plus_one_runtime_product'] = df['budget_log'] * df['log_runtime']\", \"import numpy as np\\nimport ast\\nimport json\\nimport pandas as pd\\n\\n# (Helper function for safe literal_eval)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# Ensure parsed content for 'genres', 'crew', 'cast', 'production_companies' is available for current calculations.\\n# These will be recreated for safe access within this block, as prior temp columns were discarded on failure.\\ndf['_genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['_crew_parsed'] = df['crew'].apply(safe_literal_eval)\\ndf['_cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['_production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\n\\n# (Feature: budget_per_popularity - Ratio of (log) budget to (log) popularity, avoiding division by zero)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'popularity_log': [np.log1p(63.87), np.log1p(10.16), np.log1p(9.96)]\\ndf['budget_per_popularity'] = np.where(df['popularity_log'] > 0, df['budget_log'] / df['popularity_log'], 0)\\ndf['budget_per_popularity'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: avg_genre_per_runtime - Average genres count normalized by runtime)\\n# Input samples: 'num_genres': [1, 2, 4], 'runtime': [139, 100, 85]\\ndf['avg_genre_per_runtime'] = np.where(df['runtime'] > 0, df['num_genres'] / df['runtime'], 0)\\ndf['avg_genre_per_runtime'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: num_unique_crews - Count of unique 'person id' across all crew members for the movie)\\n# Input samples: 'crew': [\\\"[{'id': 376}, {'id': 605}]\\\", \\\"[{'id': 1899}, {'id': 5508}]\\\", \\\"[{'id': 1502583}, {'id': 1337411}]\\\"]\\ndf['num_unique_crews'] = df['_crew_parsed'].apply(lambda x: len(set(c.get('id') for c in x if c.get('id'))))\\n\\n# (Feature: num_unique_cast - Count of unique 'person id' across all cast members for the movie)\\n# Input samples: 'cast': [\\\"[{'id': 819}, {'id': 287}]\\\", \\\"[{'id': 5916}, {'id': 25541}]\\\", \\\"[{'id': 224354}, {'id': 41379}]\\\"]\\ndf['num_unique_cast'] = df['_cast_parsed'].apply(lambda x: len(set(c.get('id') for c in x if c.get('id'))))\\n\\n# (Feature: crew_effectiveness_ratio - Ratio of num_directors * num_producers / num_unique_crews)\\n# Input samples: 'num_directors': [1, 1, 2], 'num_producers': [3, 2, 4], 'num_unique_crews': [10, 8, 15]\\ndf['crew_effectiveness_ratio'] = np.where(df['num_unique_crews'] > 0, (df['num_directors'] * df['num_producers']) / df['num_unique_crews'], 0)\\ndf['crew_effectiveness_ratio'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# Removed tagline_char_count and overview_char_count due to KeyErrors as original 'tagline' and 'overview' columns were dropped previously.\\n# The word counts for these already exist as 'tagline_word_count' and 'overview_word_count'.\\n\\n# (Feature: month_dayofweek_interaction - Interaction feature for month and day of week)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0], 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['month_dayofweek_interaction'] = df['release_month'] * df['release_dayofweek']\\n\\n# (Feature: year_popularity_interaction - Interaction feature for release year and popularity)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'popularity': [63.87, 10.16, 9.96]\\ndf['year_popularity_interaction'] = df['release_year'] * df['popularity']\\n\\n# (Feature: budget_sq - Square of log budget to capture non-linear effects)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0]\\ndf['budget_sq'] = df['budget_log'] ** 2\\n\\n# (Feature: runtime_sq - Square of log runtime)\\n# Input samples: 'log_runtime': [np.log1p(139), np.log1p(100), np.log1p(85)]\\ndf['runtime_sq'] = df['log_runtime'] ** 2\\n\\n# (Feature: has_Top_5_Production_Co - Binary indicator if any of the top 5 global production companies (from current df context) are present)\\n# Input samples: '_production_companies_parsed': [\\\"[{'name': 'Twentieth Century Fox Film Corporation'}]\\\", \\\"[{'name': 'Universal Pictures'}]\\\", \\\"[]\\\"]\\nall_companies = [comp.get('name') for sublist in df['_production_companies_parsed'] for comp in sublist if comp.get('name')]\\ntop_companies = pd.Series(all_companies).value_counts().nlargest(5).index.tolist()\\ndf['has_Top_5_Production_Co'] = df['_production_companies_parsed'].apply(\\n    lambda x: 1 if any(comp.get('name') in top_companies for comp in x) else 0\\n)\\n\\n# (Feature: crew_diversity_to_overall_crew_ratio - Ratio of unique crew members to total crew entries)\\n# Input samples: 'num_unique_crews': [10, 8, 15], 'num_crew': [20, 15, 30]\\ndf['crew_diversity_to_overall_crew_ratio'] = np.where(df['num_crew'] > 0, df['num_unique_crews'] / df['num_crew'], 0)\\ndf['crew_diversity_to_overall_crew_ratio'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: popularity_x_num_genres - Interaction of movie popularity and number of genres)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'num_genres': [1, 2, 4]\\ndf['popularity_x_num_genres'] = df['popularity'] * df['num_genres']\\n\\n# (Feature: budget_x_num_prod_companies - Interaction of budget and number of production companies)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'num_production_companies': [7, 1, 3]\\ndf['budget_x_num_prod_companies'] = df['budget_log'] * df['num_production_companies']\\n\\n# (Feature: release_year_sq - Square of the release year for capturing polynomial trends)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_sq'] = df['release_year'] ** 2\\n\\n# Clean up temporary parsed columns after use in this block\\ndf.drop(columns=['_genres_parsed', '_crew_parsed', '_cast_parsed', '_production_companies_parsed'], inplace=True, errors='ignore')\"]}, \"score\": -2.1773576474041, \"memory_update\": \"import numpy as np\\nimport ast\\nimport json\\nimport pandas as pd\\n\\n# (Helper function for safe literal_eval)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# Ensure parsed content for 'genres', 'crew', 'cast', 'production_companies' is available for current calculations.\\n# These will be recreated for safe access within this block, as prior temp columns were discarded on failure.\\ndf['_genres_parsed'] = df['genres'].apply(safe_literal_eval)\\ndf['_crew_parsed'] = df['crew'].apply(safe_literal_eval)\\ndf['_cast_parsed'] = df['cast'].apply(safe_literal_eval)\\ndf['_production_companies_parsed'] = df['production_companies'].apply(safe_literal_eval)\\n\\n# (Feature: budget_per_popularity - Ratio of (log) budget to (log) popularity, avoiding division by zero)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'popularity_log': [np.log1p(63.87), np.log1p(10.16), np.log1p(9.96)]\\ndf['budget_per_popularity'] = np.where(df['popularity_log'] > 0, df['budget_log'] / df['popularity_log'], 0)\\ndf['budget_per_popularity'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: avg_genre_per_runtime - Average genres count normalized by runtime)\\n# Input samples: 'num_genres': [1, 2, 4], 'runtime': [139, 100, 85]\\ndf['avg_genre_per_runtime'] = np.where(df['runtime'] > 0, df['num_genres'] / df['runtime'], 0)\\ndf['avg_genre_per_runtime'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: num_unique_crews - Count of unique 'person id' across all crew members for the movie)\\n# Input samples: 'crew': [\\\"[{'id': 376}, {'id': 605}]\\\", \\\"[{'id': 1899}, {'id': 5508}]\\\", \\\"[{'id': 1502583}, {'id': 1337411}]\\\"]\\ndf['num_unique_crews'] = df['_crew_parsed'].apply(lambda x: len(set(c.get('id') for c in x if c.get('id'))))\\n\\n# (Feature: num_unique_cast - Count of unique 'person id' across all cast members for the movie)\\n# Input samples: 'cast': [\\\"[{'id': 819}, {'id': 287}]\\\", \\\"[{'id': 5916}, {'id': 25541}]\\\", \\\"[{'id': 224354}, {'id': 41379}]\\\"]\\ndf['num_unique_cast'] = df['_cast_parsed'].apply(lambda x: len(set(c.get('id') for c in x if c.get('id'))))\\n\\n# (Feature: crew_effectiveness_ratio - Ratio of num_directors * num_producers / num_unique_crews)\\n# Input samples: 'num_directors': [1, 1, 2], 'num_producers': [3, 2, 4], 'num_unique_crews': [10, 8, 15]\\ndf['crew_effectiveness_ratio'] = np.where(df['num_unique_crews'] > 0, (df['num_directors'] * df['num_producers']) / df['num_unique_crews'], 0)\\ndf['crew_effectiveness_ratio'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# Removed tagline_char_count and overview_char_count due to KeyErrors as original 'tagline' and 'overview' columns were dropped previously.\\n# The word counts for these already exist as 'tagline_word_count' and 'overview_word_count'.\\n\\n# (Feature: month_dayofweek_interaction - Interaction feature for month and day of week)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0], 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['month_dayofweek_interaction'] = df['release_month'] * df['release_dayofweek']\\n\\n# (Feature: year_popularity_interaction - Interaction feature for release year and popularity)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0], 'popularity': [63.87, 10.16, 9.96]\\ndf['year_popularity_interaction'] = df['release_year'] * df['popularity']\\n\\n# (Feature: budget_sq - Square of log budget to capture non-linear effects)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0]\\ndf['budget_sq'] = df['budget_log'] ** 2\\n\\n# (Feature: runtime_sq - Square of log runtime)\\n# Input samples: 'log_runtime': [np.log1p(139), np.log1p(100), np.log1p(85)]\\ndf['runtime_sq'] = df['log_runtime'] ** 2\\n\\n# (Feature: has_Top_5_Production_Co - Binary indicator if any of the top 5 global production companies (from current df context) are present)\\n# Input samples: '_production_companies_parsed': [\\\"[{'name': 'Twentieth Century Fox Film Corporation'}]\\\", \\\"[{'name': 'Universal Pictures'}]\\\", \\\"[]\\\"]\\nall_companies = [comp.get('name') for sublist in df['_production_companies_parsed'] for comp in sublist if comp.get('name')]\\ntop_companies = pd.Series(all_companies).value_counts().nlargest(5).index.tolist()\\ndf['has_Top_5_Production_Co'] = df['_production_companies_parsed'].apply(\\n    lambda x: 1 if any(comp.get('name') in top_companies for comp in x) else 0\\n)\\n\\n# (Feature: crew_diversity_to_overall_crew_ratio - Ratio of unique crew members to total crew entries)\\n# Input samples: 'num_unique_crews': [10, 8, 15], 'num_crew': [20, 15, 30]\\ndf['crew_diversity_to_overall_crew_ratio'] = np.where(df['num_crew'] > 0, df['num_unique_crews'] / df['num_crew'], 0)\\ndf['crew_diversity_to_overall_crew_ratio'].replace([np.inf, -np.inf], 0, inplace=True)\\n\\n# (Feature: popularity_x_num_genres - Interaction of movie popularity and number of genres)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96], 'num_genres': [1, 2, 4]\\ndf['popularity_x_num_genres'] = df['popularity'] * df['num_genres']\\n\\n# (Feature: budget_x_num_prod_companies - Interaction of budget and number of production companies)\\n# Input samples: 'budget_log': [np.log1p(63000000), np.log1p(12000000), 0], 'num_production_companies': [7, 1, 3]\\ndf['budget_x_num_prod_companies'] = df['budget_log'] * df['num_production_companies']\\n\\n# (Feature: release_year_sq - Square of the release year for capturing polynomial trends)\\n# Input samples: 'release_year': [1999.0, 2017.0, 2015.0]\\ndf['release_year_sq'] = df['release_year'] ** 2\\n\\n# Clean up temporary parsed columns after use in this block\\ndf.drop(columns=['_genres_parsed', '_crew_parsed', '_cast_parsed', '_production_companies_parsed'], inplace=True, errors='ignore')\"}, {\"search_node\": {\"trial\": 23, \"parent_trial\": 8, \"memory\": [{\"update\": \"\", \"score\": -2.19964814861273}, {\"update\": \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"score\": -2.194834450371649}, {\"update\": \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"score\": -2.1878916554583694}], \"predefined_state\": null, \"parent_score\": -2.1878916554583694, \"inspirations\": []}, \"state\": {\"generated_code\": [\"\", \"import json\\nimport ast\\nimport numpy as np\\n\\n# (Feature: has_collection - Binary indicator if the movie belongs to a collection)\\n# Input samples: 'belongs_to_collection': [nan, nan, nan]\\ndf['has_collection'] = df['belongs_to_collection'].apply(lambda x: 1 if isinstance(x, str) and len(x) > 2 else 0)\\n\\n# (Helper function for safe JSON parsing)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return []\\n    return []\\n\\n# (Feature: num_genres - Number of genres associated with the movie)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['parsed_genres'] = df['genres'].apply(safe_literal_eval)\\ndf['num_genres'] = df['parsed_genres'].apply(len)\\n\\n# (Feature: genre_is_Drama - Binary indicator for 'Drama' genre)\\n# (Feature: genre_is_Comedy - Binary indicator for 'Comedy' genre)\\n# (Feature: genre_is_Thriller - Binary indicator for 'Thriller' genre)\\n# (Feature: genre_is_Action - Binary indicator for 'Action' genre)\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}, {'id': 12, 'name': 'Adventure'}]\\\"]\\ndf['genre_is_Drama'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 18, 'name': 'Drama'} in x else 0)\\ndf['genre_is_Comedy'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 35, 'name': 'Comedy'} in x else 0)\\ndf['genre_is_Thriller'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 53, 'name': 'Thriller'} in x else 0)\\ndf['genre_is_Action'] = df['parsed_genres'].apply(lambda x: 1 if {'id': 28, 'name': 'Action'} in x else 0)\\ndel df['parsed_genres']\\n\\n# (Feature: num_production_companies - Number of production companies)\\n# Input samples: 'production_companies': [\\\"[...\\\", \\\"{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[...]\\\"]\\ndf['parsed_production_companies'] = df['production_companies'].apply(safe_literal_eval)\\ndf['num_production_companies'] = df['parsed_production_companies'].apply(len)\\n\\n# (Feature: has_WarnerBros - Binary indicator if Warner Bros. is a production company)\\n# Input samples: 'production_companies': [\\\"[{'name': 'Twentieth Century Fox Film Corporation', 'id': 306}, {'name': 'Regency Enterprises', 'id': 508}, {'name': 'Fox 2000 Pictures', 'id': 711}, {'name': 'Taurus Film', 'id': 20555}, {'name': 'Linson Films', 'id': 54050}, {'name': 'Atman Entertainment', 'id': 54051}, {'name': 'Knickerbocker Films', 'id': 54052}]\\\", \\\"[{'name': 'DiNovi Pictures', 'id': 813}]\\\", \\\"[{'name': 'Aardman Animations', 'id': 297}, {'name': 'Studio Canal', 'id': 5870}, {'name': 'Anton Capital Entertainment (ACE)', 'id': 20664}]\\\"]\\ndf['has_WarnerBros'] = df['parsed_production_companies'].apply(lambda x: 1 if any(comp['name'] == 'Warner Bros.' for comp in x) else 0)\\n\\n# (Feature: num_production_countries - Number of production countries)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['parsed_production_countries'] = df['production_countries'].apply(safe_literal_eval)\\ndf['num_production_countries'] = df['parsed_production_countries'].apply(len)\\n\\n# (Feature: is_US_production - Binary indicator if the US is a production country)\\n# Input samples: 'production_countries': [\\\"[{'iso_3166_1': 'DE', 'name': 'Germany'}, {'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'US', 'name': 'United States of America'}]\\\", \\\"[{'iso_3166_1': 'FR', 'name': 'France'}, {'iso_3166_1': 'GB', 'name': 'United Kingdom'}]\\\"]\\ndf['is_US_production'] = df['parsed_production_countries'].apply(lambda x: 1 if any(country['iso_3166_1'] == 'US' for country in x) else 0)\\ndel df['parsed_production_countries']\\ndel df['parsed_production_companies']\\n\\n# (Feature: num_spoken_languages - Number of spoken languages in the movie)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['parsed_spoken_languages'] = df['spoken_languages'].apply(safe_literal_eval)\\ndf['num_spoken_languages'] = df['parsed_spoken_languages'].apply(len)\\n\\n# (Feature: is_English_spoken - Binary indicator if English is a spoken language)\\n# Input samples: 'spoken_languages': [\\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\", \\\"[{'iso_639_1': 'en', 'name': 'English'}]\\\"]\\ndf['is_English_spoken'] = df['parsed_spoken_languages'].apply(lambda x: 1 if any(lang['iso_639_1'] == 'en' for lang in x) else 0)\\ndel df['parsed_spoken_languages']\\n\\n# (Feature: num_keywords - Number of keywords associated with the movie)\\n# Input samples: 'Keywords': [\\\"[{'id': 825, 'name': 'support group'}, {'id': 851, 'name': 'dual identity'}, {'id': 1541, 'name': 'nihilism'}, {'id': 3927, 'name': 'rage and hate'}, {'id': 4142, 'name': 'insomnia'}, {'id': 4565, 'name': 'dystopia'}, {'id': 14819, 'name': 'violence'}]\\\", \\\"[{'id': 5982, 'name': 'ex husband'}, {'id': 187056, 'name': 'woman director'}]\\\", \\\"[{'id': 548, 'name': 'countryside'}, {'id': 3020, 'name': 'sheep'}, {'id': 10988, 'name': 'based on tv series'}, {'id': 11469, 'name': 'memory loss'}, {'id': 11612, 'name': 'hospital'}, {'id': 12392, 'name': 'best friend'}, {'id': 14828, 'name': 'city'}, {'id': 15162, 'name': 'dog'}, {'id': 18118, 'name': 'disguise'}, {'id': 154846, 'name': 'farmer'}, {'id': 156596, 'name': 'no dialogue'}, {'id': 196705, 'name': 'hospitalization'}, {'id': 197065, 'name': 'claymation'}, {'id': 197361, 'name': 'hairstylist'}, {'id': 219906, 'name': 'sheep farm'}]\\\"]\\ndf['parsed_Keywords'] = df['Keywords'].apply(safe_literal_eval)\\ndf['num_keywords'] = df['parsed_Keywords'].apply(len)\\ndel df['parsed_Keywords']\\n\\n# (Feature: num_cast - Total number of cast members)\\n# (Feature: num_male_cast - Number of male cast members (gender 2))\\n# (Feature: num_female_cast - Number of female cast members (gender 1))\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}]']\\ndf['parsed_cast'] = df['cast'].apply(safe_literal_eval)\\ndf['num_cast'] = df['parsed_cast'].apply(len)\\ndf['num_male_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 2))\\ndf['num_female_cast'] = df['parsed_cast'].apply(lambda x: sum(1 for c in x if c.get('gender') == 1))\\n\\n# (Feature: cast_popularity - Aggregate cast popularity based on their order in cast list, inverse of order for weighted average)\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/eIkFHNlfretLS1spAcIoihKUS62.jpg\\\\'}, {\\\\'cast_id\\\\': 5, \\\\'character\\\\': \\\\'Tyler Durden\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f7\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 287, \\\\'name\\\\': \\\\'Brad Pitt\\\\', \\\\'order\\\\': 1, \\\\'profile_path\\\\': \\\\'/ejYIW1enUcGJ9GS3Bs34mtONwWS.jpg\\\\'}]', ..., '[{\\\\'cast_id\\\\': 8, \\\\'character\\\\': \\\\'himself\\\\', \\\\'credit_id\\\\': \\\\'52fe43e2c3a368484e003bab\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 78029, \\\\'name\\\\': \\\\'Martin Lawrence\\\\', \\\\'order\\\\': 0, \\\\'profile_path\\\\': \\\\'/uBVQuIdS3wGCpYaZFEeKZBuiZ2l.jpg\\\\'}]']\\ndf['cast_avg_order'] = df['parsed_cast'].apply(lambda x: np.mean([c.get('order', 0) for c in x]) if x else 0)\\ndf['cast_min_order'] = df['parsed_cast'].apply(lambda x: np.min([c.get('order', 0) for c in x]) if x else 0)\\ndel df['parsed_cast']\\n\\n# (Feature: num_directors - Number of unique directors)\\n# (Feature: num_producers - Number of unique producers)\\n# (Feature: num_writers - Number of unique writers)\\n# Input samples: 'crew': [\\\"[{'credit_id': '55731b8192514111610027d7', 'department': 'Production', 'gender': 2, 'id': 376, 'job': 'Executive Producer', 'name': 'Arnon Milchan', 'profile_path': '/5crR5twLRcIdvRR06dB1O0EQ8x0.jpg'}]\\\", \\\"[...]\\\", \\\"[...]\\\"]\\ndf['parsed_crew'] = df['crew'].apply(safe_literal_eval)\\ndf['num_crew'] = df['parsed_crew'].apply(len) # Total number of crew members listed\\ndf['num_directors'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') == 'Director')))\\ndf['num_producers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Producer', 'Executive Producer', 'Associate Producer', 'Co-Producer'])))\\ndf['num_writers'] = df['parsed_crew'].apply(lambda x: len(set(c['id'] for c in x if c.get('job') in ['Screenplay', 'Writer', 'Novel', 'Author'])))\\n\\n# (Feature: crew_has_male_director - Binary flag for male director)\\n# (Feature: crew_has_female_director - Binary flag for female director)\\n# Input samples: 'crew': [\\\"[{'credit_id': '52fe4250c3a36847f8014a47', 'department': 'Directing', 'gender': 2, 'id': 7467, 'job': 'Director', 'name': 'David Fincher', 'profile_path': '/dcBHejOsKvzVZVozWJAPzYthb8X.jpg'}]\\\"]\\ndf['crew_has_male_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 2 for c in x) else 0)\\ndf['crew_has_female_director'] = df['parsed_crew'].apply(lambda x: 1 if any(c.get('job') == 'Director' and c.get('gender') == 1 for c in x) else 0)\\ndel df['parsed_crew']\\n\", \"import numpy as np\\nimport ast # For safe_literal_eval\\nimport json # In case any json parsing is still needed, though ast is preferred for python literal strings.\\n\\n# (Helper function for safe literal_eval - ensure it's available for this block)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return None\\n    return None\\n\\n# (Feature: collection_id - Extract id from 'belongs_to_collection')\\n# Input samples: 'belongs_to_collection': [nan, nan, nan, \\\"[{'id': 107467, 'name': '\\u0421\\u0430\\u043c\\u044b\\u0439 \\u043b\\u0443\\u0447\\u0448\\u0438\\u0439 \\u0444\\u0438\\u043b\\u044c\\u043c - \\u041a\\u043e\\u043b\\u043b\\u0435\\u043a\\u0446\\u0438\\u044f', 'poster_path': None, 'backdrop_path': None}]\\\", nan]\\ndf['parsed_collection'] = df['belongs_to_collection'].apply(safe_literal_eval)\\ndf['collection_id'] = df['parsed_collection'].apply(lambda x: x[0]['id'] if x and isinstance(x, list) and len(x) > 0 and 'id' in x[0] else -1)\\ndel df['parsed_collection']\\n\\n# (Feature: budget_log - Logarithmic transformation of budget to normalize its distribution, handling zero budgets)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['budget_log'] = df['budget'].apply(lambda x: np.log1p(x) if x > 0 else 0) # Use log1p to handle 0 budget values\\n# (Feature: has_zero_budget - Binary indicator for movies with zero budget)\\n# Input samples: 'budget': [np.int64(63000000), np.int64(12000000), np.int64(0)]\\ndf['has_zero_budget'] = (df['budget'] == 0).astype(int)\\n\\n\\n# (Feature: popularity_log - Logarithmic transformation of popularity for normalization)\\n# Input samples: 'popularity': [63.87, 10.16, 9.96]\\ndf['popularity_log'] = df['popularity'].apply(lambda x: np.log1p(x))\\n\\n# (Feature: has_homepage - Binary indicator if the movie has a homepage)\\n# Input samples: 'homepage': ['http://www.foxmovies.com/movies/fight-club', nan, 'http://www.shaunthesheep.com/']\\ndf['has_homepage'] = df['homepage'].notna().astype(int)\\n\\n# (Feature: has_tagline - Binary indicator if the movie has a tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['has_tagline'] = df['tagline'].notna().astype(int)\\n\\n# (Feature: tagline_word_count - Number of words in the tagline)\\n# Input samples: 'tagline': ['Mischief. Mayhem. Soap.', nan, 'Moving on to Pastures New.']\\ndf['tagline_word_count'] = df['tagline'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: overview_word_count - Number of words in the overview)\\n# Input samples: 'overview': ['A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy.', 'Julia moves in with her fianc\\u221a\\u00a9, David, but his ex-wife and her own haunting past join forces to rock her quiet suburban existence.', \\\"When Shaun decides to take the day off and have some fun, he gets a little more action than he bargained for.\\\" ]\\ndf['overview_word_count'] = df['overview'].apply(lambda x: len(str(x).split()) if isinstance(x, str) else 0)\\n\\n# (Feature: original_title_word_count - Number of words in the original title)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_word_count'] = df['original_title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: title_word_count - Number of words in the title)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_word_count'] = df['title'].apply(lambda x: len(str(x).split()))\\n\\n# (Feature: is_release_weekend - Binary indicator if the movie was released on a Friday, Saturday or Sunday)\\n# Input samples: 'release_dayofweek': [4.0, 3.0, 3.0]\\ndf['is_release_weekend'] = df['release_dayofweek'].isin([4, 5, 6]).astype(int)\\n\\n# (Feature: release_quarter - The quarter of the year in which the movie was released)\\n# Input samples: 'release_month': [10.0, 4.0, 2.0]\\ndf['release_quarter'] = df['release_month'].apply(lambda x: (x - 1) // 3 + 1) # Months 1-3 -> Q1, 4-6 -> Q2, etc.\\n\\n# Dropping the now parsed raw `belongs_to_collection`, `homepage`, `tagline` `overview`\\ndf.drop(columns=['belongs_to_collection', 'homepage', 'tagline', 'overview'], inplace=True, errors='ignore')\", \"import numpy as np\\nimport ast\\n\\n# (Helper function for safe JSON/literal string parsing, ensure it's defined in each block where needed)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list on error for consistent processing\\n    return []\\n\\n# (Feature: has_poster_path - Binary indicator if the movie has a poster image)\\n# Input samples: 'poster_path': ['/adw6Lq9FiC9zjYEpOqfq03ituwp.jpg', '/jKyjJu3N0bcF9TzcyGLb0Nn6Uqq.jpg', '/aOHsNN1p2nuiF9WaMaCNXy0T80J.jpg']\\ndf['has_poster_path'] = df['poster_path'].notna().astype(int)\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling potential zero or very small values)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: is_original_language_en - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: release_dayofmonth - The day of the month the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofmonth'] = df['release_date'].dt.day.astype(int)\\n\\n# (Feature: release_dayofyear - The day of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear.astype(int)\\n\\n# (Feature: release_weekofyear - The week of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: title_char_len - Character length of the 'title' column)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_char_len'] = df['title'].astype(str).apply(len)\\n\\n# (Feature: original_title_char_len - Character length of the 'original_title' column)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_char_len'] = df['original_title'].astype(str).apply(len)\\n\\n# (Feature: title_equals_original_title - Binary indicator if 'title' and 'original_title' are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Unforgettable', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Re-parsing 'genres' as 'temp_genres' for this block to derive more features\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['temp_genres'] = df['genres'].apply(safe_literal_eval)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\ndf['genre_is_Family'] = df['temp_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\ndf['genre_is_Adventure'] = df['temp_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\ndf['genre_is_ScienceFiction'] = df['temp_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['temp_genres']\\n\\n# Re-parsing 'cast' as 'temp_cast' for this block\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['temp_cast'] = df['cast'].apply(safe_literal_eval)\\n# (Feature: num_top_10_cast - Number of cast members with 'order' up to 9)\\ndf['num_top_10_cast'] = df['temp_cast'].apply(lambda x: sum(1 for c in x if c.get('order', 999) < 10))\\n# (Feature: avg_cast_popularity_top_10 - Sum of (1 / (order+1)) for top 10 cast)\\n# This feature gives more weight to actors with lower 'order' (more prominent roles).\\ndf['avg_cast_popularity_top_10'] = df['temp_cast'].apply(lambda x: sum(1 / (c['order'] + 1) for c in x if c.get('order', 999) < 10))\\ndel df['temp_cast']\\n\"]}, \"score\": -2.198841363795638, \"memory_update\": \"import numpy as np\\nimport ast\\n\\n# (Helper function for safe JSON/literal string parsing, ensure it's defined in each block where needed)\\ndef safe_literal_eval(x):\\n    if isinstance(x, str) and x.strip():\\n        try:\\n            # Handle potential outer quotes if data is double-encoded\\n            if x.startswith(\\\"'\\\") and x.endswith(\\\"'\\\"):\\n                x = x[1:-1]\\n            return ast.literal_eval(x)\\n        except (ValueError, SyntaxError):\\n            return [] # Return empty list on error for consistent processing\\n    return []\\n\\n# (Feature: has_poster_path - Binary indicator if the movie has a poster image)\\n# Input samples: 'poster_path': ['/adw6Lq9FiC9zjYEpOqfq03ituwp.jpg', '/jKyjJu3N0bcF9TzcyGLb0Nn6Uqq.jpg', '/aOHsNN1p2nuiF9WaMaCNXy0T80J.jpg']\\ndf['has_poster_path'] = df['poster_path'].notna().astype(int)\\n\\n# (Feature: runtime_log - Logarithmic transformation of runtime, handling potential zero or very small values)\\n# Input samples: 'runtime': [np.int64(139), np.int64(100), np.int64(85)]\\ndf['runtime_log'] = df['runtime'].apply(lambda x: np.log1p(x) if x > 0 else 0)\\n\\n# (Feature: is_original_language_en - Binary indicator if the original language is English)\\n# Input samples: 'original_language': ['en', 'en', 'en']\\ndf['is_original_language_en'] = (df['original_language'] == 'en').astype(int)\\n\\n# (Feature: release_dayofmonth - The day of the month the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofmonth'] = df['release_date'].dt.day.astype(int)\\n\\n# (Feature: release_dayofyear - The day of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_dayofyear'] = df['release_date'].dt.dayofyear.astype(int)\\n\\n# (Feature: release_weekofyear - The week of the year the movie was released)\\n# Input samples: 'release_date': [Timestamp('1999-10-15 00:00:00'), Timestamp('2017-04-20 00:00:00'), Timestamp('2015-02-05 00:00:00')]\\ndf['release_weekofyear'] = df['release_date'].dt.isocalendar().week.astype(int)\\n\\n# (Feature: title_char_len - Character length of the 'title' column)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['title_char_len'] = df['title'].astype(str).apply(len)\\n\\n# (Feature: original_title_char_len - Character length of the 'original_title' column)\\n# Input samples: 'original_title': ['Fight Club', 'Unforgettable', 'Shaun the Sheep Movie']\\ndf['original_title_char_len'] = df['original_title'].astype(str).apply(len)\\n\\n# (Feature: title_equals_original_title - Binary indicator if 'title' and 'original_title' are the same)\\n# Input samples: 'title': ['Fight Club', 'Unforgettable', 'The Best Movie 3-DE'], 'original_title': ['Fight Club', 'Unforgettable', 'Samyy Luchshiy Film 3-DE']\\ndf['title_equals_original_title'] = (df['title'] == df['original_title']).astype(int)\\n\\n# Re-parsing 'genres' as 'temp_genres' for this block to derive more features\\n# Input samples: 'genres': [\\\"[{'id': 18, 'name': 'Drama'}]\\\", \\\"[{'id': 18, 'name': 'Drama'}, {'id': 53, 'name': 'Thriller'}]\\\", \\\"[{'id': 10751, 'name': 'Family'}, {'id': 16, 'name': 'Animation'}, {'id': 35, 'name': 'Comedy'}]\\\"]\\ndf['temp_genres'] = df['genres'].apply(safe_literal_eval)\\n# (Feature: genre_is_Family - Binary indicator for 'Family' genre)\\ndf['genre_is_Family'] = df['temp_genres'].apply(lambda x: 1 if {'id': 10751, 'name': 'Family'} in x else 0)\\n# (Feature: genre_is_Adventure - Binary indicator for 'Adventure' genre)\\ndf['genre_is_Adventure'] = df['temp_genres'].apply(lambda x: 1 if {'id': 12, 'name': 'Adventure'} in x else 0)\\n# (Feature: genre_is_ScienceFiction - Binary indicator for 'Science Fiction' genre)\\ndf['genre_is_ScienceFiction'] = df['temp_genres'].apply(lambda x: 1 if {'id': 878, 'name': 'Science Fiction'} in x else 0)\\ndel df['temp_genres']\\n\\n# Re-parsing 'cast' as 'temp_cast' for this block\\n# Input samples: 'cast': ['[{\\\\'cast_id\\\\': 4, \\\\'character\\\\': \\\\'The Narrator\\\\', \\\\'credit_id\\\\': \\\\'52fe4250c3a36847f80149f3\\\\', \\\\'gender\\\\': 2, \\\\'id\\\\': 819, \\\\'name\\\\': \\\\'Edward Norton\\\\', \\\\'order\\\\': 0}]']\\ndf['temp_cast'] = df['cast'].apply(safe_literal_eval)\\n# (Feature: num_top_10_cast - Number of cast members with 'order' up to 9)\\ndf['num_top_10_cast'] = df['temp_cast'].apply(lambda x: sum(1 for c in x if c.get('order', 999) < 10))\\n# (Feature: avg_cast_popularity_top_10 - Sum of (1 / (order+1)) for top 10 cast)\\n# This feature gives more weight to actors with lower 'order' (more prominent roles).\\ndf['avg_cast_popularity_top_10'] = df['temp_cast'].apply(lambda x: sum(1 / (c['order'] + 1) for c in x if c.get('order', 999) < 10))\\ndel df['temp_cast']\\n\"}]}"